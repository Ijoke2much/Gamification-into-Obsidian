/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Rg=Object.create;var ti=Object.defineProperty;var kg=Object.getOwnPropertyDescriptor;var Gg=Object.getOwnPropertyNames;var Og=Object.getPrototypeOf,Ng=Object.prototype.hasOwnProperty;var Vg=(Q,e,A)=>e in Q?ti(Q,e,{enumerable:!0,configurable:!0,writable:!0,value:A}):Q[e]=A;var _g=(Q,e)=>()=>(e||Q((e={exports:{}}).exports,e),e.exports),Xg=(Q,e)=>{for(var A in e)ti(Q,A,{get:e[A],enumerable:!0})},co=(Q,e,A,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Gg(e))!Ng.call(Q,r)&&r!==A&&ti(Q,r,{get:()=>e[r],enumerable:!(t=kg(e,r))||t.enumerable});return Q};var ho=(Q,e,A)=>(A=Q!=null?Rg(Og(Q)):{},co(e||!Q||!Q.__esModule?ti(A,"default",{value:Q,enumerable:!0}):A,Q)),Jg=Q=>co(ti({},"__esModule",{value:!0}),Q);var EA=(Q,e,A)=>Vg(Q,typeof e!="symbol"?e+"":e,A);var rn=_g((tn,sn)=>{(function(Q,e){typeof tn=="object"&&typeof sn!="undefined"?sn.exports=e():typeof define=="function"&&define.amd?define(e):(Q=typeof globalThis!="undefined"?globalThis:Q||self,Q.html2canvas=e())})(tn,function(){"use strict";var Q=function(s,i){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&(a[h]=n[h])},Q(s,i)};function e(s,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");Q(s,i);function a(){this.constructor=s}s.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}var A=function(){return A=Object.assign||function(i){for(var a,n=1,h=arguments.length;n<h;n++){a=arguments[n];for(var p in a)Object.prototype.hasOwnProperty.call(a,p)&&(i[p]=a[p])}return i},A.apply(this,arguments)};function t(s,i,a,n){function h(p){return p instanceof a?p:new a(function(B){B(p)})}return new(a||(a=Promise))(function(p,B){function C(S){try{U(n.next(S))}catch(I){B(I)}}function w(S){try{U(n.throw(S))}catch(I){B(I)}}function U(S){S.done?p(S.value):h(S.value).then(C,w)}U((n=n.apply(s,i||[])).next())})}function r(s,i){var a={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},n,h,p,B;return B={next:C(0),throw:C(1),return:C(2)},typeof Symbol=="function"&&(B[Symbol.iterator]=function(){return this}),B;function C(U){return function(S){return w([U,S])}}function w(U){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,h&&(p=U[0]&2?h.return:U[0]?h.throw||((p=h.return)&&p.call(h),0):h.next)&&!(p=p.call(h,U[1])).done)return p;switch(h=0,p&&(U=[U[0]&2,p.value]),U[0]){case 0:case 1:p=U;break;case 4:return a.label++,{value:U[1],done:!1};case 5:a.label++,h=U[1],U=[0];continue;case 7:U=a.ops.pop(),a.trys.pop();continue;default:if(p=a.trys,!(p=p.length>0&&p[p.length-1])&&(U[0]===6||U[0]===2)){a=0;continue}if(U[0]===3&&(!p||U[1]>p[0]&&U[1]<p[3])){a.label=U[1];break}if(U[0]===6&&a.label<p[1]){a.label=p[1],p=U;break}if(p&&a.label<p[2]){a.label=p[2],a.ops.push(U);break}p[2]&&a.ops.pop(),a.trys.pop();continue}U=i.call(s,a)}catch(S){U=[6,S],h=0}finally{n=p=0}if(U[0]&5)throw U[1];return{value:U[0]?U[1]:void 0,done:!0}}}function o(s,i,a){if(a||arguments.length===2)for(var n=0,h=i.length,p;n<h;n++)(p||!(n in i))&&(p||(p=Array.prototype.slice.call(i,0,n)),p[n]=i[n]);return s.concat(p||i)}for(var l=function(){function s(i,a,n,h){this.left=i,this.top=a,this.width=n,this.height=h}return s.prototype.add=function(i,a,n,h){return new s(this.left+i,this.top+a,this.width+n,this.height+h)},s.fromClientRect=function(i,a){return new s(a.left+i.windowBounds.left,a.top+i.windowBounds.top,a.width,a.height)},s.fromDOMRectList=function(i,a){var n=Array.from(a).find(function(h){return h.width!==0});return n?new s(n.left+i.windowBounds.left,n.top+i.windowBounds.top,n.width,n.height):s.EMPTY},s.EMPTY=new s(0,0,0,0),s}(),c=function(s,i){return l.fromClientRect(s,i.getBoundingClientRect())},d=function(s){var i=s.body,a=s.documentElement;if(!i||!a)throw new Error("Unable to get document size");var n=Math.max(Math.max(i.scrollWidth,a.scrollWidth),Math.max(i.offsetWidth,a.offsetWidth),Math.max(i.clientWidth,a.clientWidth)),h=Math.max(Math.max(i.scrollHeight,a.scrollHeight),Math.max(i.offsetHeight,a.offsetHeight),Math.max(i.clientHeight,a.clientHeight));return new l(0,0,n,h)},g=function(s){for(var i=[],a=0,n=s.length;a<n;){var h=s.charCodeAt(a++);if(h>=55296&&h<=56319&&a<n){var p=s.charCodeAt(a++);(p&64512)===56320?i.push(((h&1023)<<10)+(p&1023)+65536):(i.push(h),a--)}else i.push(h)}return i},u=function(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];if(String.fromCodePoint)return String.fromCodePoint.apply(String,s);var a=s.length;if(!a)return"";for(var n=[],h=-1,p="";++h<a;){var B=s[h];B<=65535?n.push(B):(B-=65536,n.push((B>>10)+55296,B%1024+56320)),(h+1===a||n.length>16384)&&(p+=String.fromCharCode.apply(String,n),n.length=0)}return p},m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",v=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),F=0;F<m.length;F++)v[m.charCodeAt(F)]=F;for(var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",E=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),H=0;H<y.length;H++)E[y.charCodeAt(H)]=H;for(var x=function(s){var i=s.length*.75,a=s.length,n,h=0,p,B,C,w;s[s.length-1]==="="&&(i--,s[s.length-2]==="="&&i--);var U=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined"&&typeof Uint8Array.prototype.slice!="undefined"?new ArrayBuffer(i):new Array(i),S=Array.isArray(U)?U:new Uint8Array(U);for(n=0;n<a;n+=4)p=E[s.charCodeAt(n)],B=E[s.charCodeAt(n+1)],C=E[s.charCodeAt(n+2)],w=E[s.charCodeAt(n+3)],S[h++]=p<<2|B>>4,S[h++]=(B&15)<<4|C>>2,S[h++]=(C&3)<<6|w&63;return U},M=function(s){for(var i=s.length,a=[],n=0;n<i;n+=2)a.push(s[n+1]<<8|s[n]);return a},T=function(s){for(var i=s.length,a=[],n=0;n<i;n+=4)a.push(s[n+3]<<24|s[n+2]<<16|s[n+1]<<8|s[n]);return a},R=5,N=11,J=2,AA=N-R,FA=65536>>R,wA=1<<R,PA=wA-1,aA=1024>>R,iA=FA+aA,MA=iA,mA=32,WA=MA+mA,ZA=65536>>N,YA=1<<AA,Se=YA-1,De=function(s,i,a){return s.slice?s.slice(i,a):new Uint16Array(Array.prototype.slice.call(s,i,a))},SA=function(s,i,a){return s.slice?s.slice(i,a):new Uint32Array(Array.prototype.slice.call(s,i,a))},Pe=function(s,i){var a=x(s),n=Array.isArray(a)?T(a):new Uint32Array(a),h=Array.isArray(a)?M(a):new Uint16Array(a),p=24,B=De(h,p/2,n[4]/2),C=n[5]===2?De(h,(p+n[4])/2):SA(n,Math.ceil((p+n[4])/4));return new Ke(n[0],n[1],n[2],n[3],B,C)},Ke=function(){function s(i,a,n,h,p,B){this.initialValue=i,this.errorValue=a,this.highStart=n,this.highValueIndex=h,this.index=p,this.data=B}return s.prototype.get=function(i){var a;if(i>=0){if(i<55296||i>56319&&i<=65535)return a=this.index[i>>R],a=(a<<J)+(i&PA),this.data[a];if(i<=65535)return a=this.index[FA+(i-55296>>R)],a=(a<<J)+(i&PA),this.data[a];if(i<this.highStart)return a=WA-ZA+(i>>N),a=this.index[a],a+=i>>R&Se,a=this.index[a],a=(a<<J)+(i&PA),this.data[a];if(i<=1114111)return this.data[this.highValueIndex]}return this.errorValue},s}(),IA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",re=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),gA=0;gA<IA.length;gA++)re[IA.charCodeAt(gA)]=gA;var KA="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",LA=50,zA=1,CA=2,RA=3,Tt=4,BA=5,me=7,HA=8,Bn=9,Re=10,er=11,wn=12,tr=13,Po=14,Dt=15,ir=16,Bi=17,Pt=18,Ko=19,Cn=20,sr=21,Kt=22,rr=23,ht=24,ne=25,Rt=26,kt=27,dt=28,Ro=29,tt=30,ko=31,wi=32,Ci=33,nr=34,ar=35,or=36,Gt=37,lr=38,vi=39,Fi=40,cr=41,vn=42,Go=43,Oo=[9001,65288],Fn="!",tA="\xD7",Qi="\xF7",hr=Pe(KA),Ie=[tt,or],dr=[zA,CA,RA,BA],Qn=[Re,HA],yn=[kt,Rt],No=dr.concat(Qn),En=[lr,vi,Fi,nr,ar],Vo=[Dt,tr],_o=function(s,i){i===void 0&&(i="strict");var a=[],n=[],h=[];return s.forEach(function(p,B){var C=hr.get(p);if(C>LA?(h.push(!0),C-=LA):h.push(!1),["normal","auto","loose"].indexOf(i)!==-1&&[8208,8211,12316,12448].indexOf(p)!==-1)return n.push(B),a.push(ir);if(C===Tt||C===er){if(B===0)return n.push(B),a.push(tt);var w=a[B-1];return No.indexOf(w)===-1?(n.push(n[B-1]),a.push(w)):(n.push(B),a.push(tt))}if(n.push(B),C===ko)return a.push(i==="strict"?sr:Gt);if(C===vn||C===Ro)return a.push(tt);if(C===Go)return p>=131072&&p<=196605||p>=196608&&p<=262141?a.push(Gt):a.push(tt);a.push(C)}),[n,a,h]},gr=function(s,i,a,n){var h=n[a];if(Array.isArray(s)?s.indexOf(h)!==-1:s===h)for(var p=a;p<=n.length;){p++;var B=n[p];if(B===i)return!0;if(B!==Re)break}if(h===Re)for(var p=a;p>0;){p--;var C=n[p];if(Array.isArray(s)?s.indexOf(C)!==-1:s===C)for(var w=a;w<=n.length;){w++;var B=n[w];if(B===i)return!0;if(B!==Re)break}if(C!==Re)break}return!1},Un=function(s,i){for(var a=s;a>=0;){var n=i[a];if(n===Re)a--;else return n}return 0},Xo=function(s,i,a,n,h){if(a[n]===0)return tA;var p=n-1;if(Array.isArray(h)&&h[p]===!0)return tA;var B=p-1,C=p+1,w=i[p],U=B>=0?i[B]:0,S=i[C];if(w===CA&&S===RA)return tA;if(dr.indexOf(w)!==-1)return Fn;if(dr.indexOf(S)!==-1||Qn.indexOf(S)!==-1)return tA;if(Un(p,i)===HA)return Qi;if(hr.get(s[p])===er||(w===wi||w===Ci)&&hr.get(s[C])===er||w===me||S===me||w===Bn||[Re,tr,Dt].indexOf(w)===-1&&S===Bn||[Bi,Pt,Ko,ht,dt].indexOf(S)!==-1||Un(p,i)===Kt||gr(rr,Kt,p,i)||gr([Bi,Pt],sr,p,i)||gr(wn,wn,p,i))return tA;if(w===Re)return Qi;if(w===rr||S===rr)return tA;if(S===ir||w===ir)return Qi;if([tr,Dt,sr].indexOf(S)!==-1||w===Po||U===or&&Vo.indexOf(w)!==-1||w===dt&&S===or||S===Cn||Ie.indexOf(S)!==-1&&w===ne||Ie.indexOf(w)!==-1&&S===ne||w===kt&&[Gt,wi,Ci].indexOf(S)!==-1||[Gt,wi,Ci].indexOf(w)!==-1&&S===Rt||Ie.indexOf(w)!==-1&&yn.indexOf(S)!==-1||yn.indexOf(w)!==-1&&Ie.indexOf(S)!==-1||[kt,Rt].indexOf(w)!==-1&&(S===ne||[Kt,Dt].indexOf(S)!==-1&&i[C+1]===ne)||[Kt,Dt].indexOf(w)!==-1&&S===ne||w===ne&&[ne,dt,ht].indexOf(S)!==-1)return tA;if([ne,dt,ht,Bi,Pt].indexOf(S)!==-1)for(var I=p;I>=0;){var b=i[I];if(b===ne)return tA;if([dt,ht].indexOf(b)!==-1)I--;else break}if([kt,Rt].indexOf(S)!==-1)for(var I=[Bi,Pt].indexOf(w)!==-1?B:p;I>=0;){var b=i[I];if(b===ne)return tA;if([dt,ht].indexOf(b)!==-1)I--;else break}if(lr===w&&[lr,vi,nr,ar].indexOf(S)!==-1||[vi,nr].indexOf(w)!==-1&&[vi,Fi].indexOf(S)!==-1||[Fi,ar].indexOf(w)!==-1&&S===Fi||En.indexOf(w)!==-1&&[Cn,Rt].indexOf(S)!==-1||En.indexOf(S)!==-1&&w===kt||Ie.indexOf(w)!==-1&&Ie.indexOf(S)!==-1||w===ht&&Ie.indexOf(S)!==-1||Ie.concat(ne).indexOf(w)!==-1&&S===Kt&&Oo.indexOf(s[C])===-1||Ie.concat(ne).indexOf(S)!==-1&&w===Pt)return tA;if(w===cr&&S===cr){for(var G=a[p],L=1;G>0&&(G--,i[G]===cr);)L++;if(L%2!==0)return tA}return w===wi&&S===Ci?tA:Qi},Jo=function(s,i){i||(i={lineBreak:"normal",wordBreak:"normal"});var a=_o(s,i.lineBreak),n=a[0],h=a[1],p=a[2];(i.wordBreak==="break-all"||i.wordBreak==="break-word")&&(h=h.map(function(C){return[ne,tt,vn].indexOf(C)!==-1?Gt:C}));var B=i.wordBreak==="keep-all"?p.map(function(C,w){return C&&s[w]>=19968&&s[w]<=40959}):void 0;return[n,h,B]},Wo=function(){function s(i,a,n,h){this.codePoints=i,this.required=a===Fn,this.start=n,this.end=h}return s.prototype.slice=function(){return u.apply(void 0,this.codePoints.slice(this.start,this.end))},s}(),Yo=function(s,i){var a=g(s),n=Jo(a,i),h=n[0],p=n[1],B=n[2],C=a.length,w=0,U=0;return{next:function(){if(U>=C)return{done:!0,value:null};for(var S=tA;U<C&&(S=Xo(a,p,h,++U,B))===tA;);if(S!==tA||U===C){var I=new Wo(a,S,w,U);return w=U,{value:I,done:!1}}return{done:!0,value:null}}}},$o=1,qo=2,Ot=4,Sn=8,yi=10,In=47,Nt=92,Zo=9,zo=32,Ei=34,Vt=61,jo=35,Al=36,el=37,Ui=39,Si=40,_t=41,tl=95,jA=45,il=33,sl=60,rl=62,nl=64,al=91,ol=93,ll=61,cl=123,Ii=63,hl=125,Hn=124,dl=126,gl=128,bn=65533,ur=42,it=43,ul=44,pl=58,fl=59,Xt=46,ml=0,Bl=8,wl=11,Cl=14,vl=31,Fl=127,Fe=-1,xn=48,Mn=97,Ln=101,Ql=102,yl=117,El=122,Tn=65,Dn=69,Pn=70,Ul=85,Sl=90,_A=function(s){return s>=xn&&s<=57},Il=function(s){return s>=55296&&s<=57343},gt=function(s){return _A(s)||s>=Tn&&s<=Pn||s>=Mn&&s<=Ql},Hl=function(s){return s>=Mn&&s<=El},bl=function(s){return s>=Tn&&s<=Sl},xl=function(s){return Hl(s)||bl(s)},Ml=function(s){return s>=gl},Hi=function(s){return s===yi||s===Zo||s===zo},bi=function(s){return xl(s)||Ml(s)||s===tl},Kn=function(s){return bi(s)||_A(s)||s===jA},Ll=function(s){return s>=ml&&s<=Bl||s===wl||s>=Cl&&s<=vl||s===Fl},ke=function(s,i){return s!==Nt?!1:i!==yi},xi=function(s,i,a){return s===jA?bi(i)||ke(i,a):bi(s)?!0:!!(s===Nt&&ke(s,i))},pr=function(s,i,a){return s===it||s===jA?_A(i)?!0:i===Xt&&_A(a):_A(s===Xt?i:s)},Tl=function(s){var i=0,a=1;(s[i]===it||s[i]===jA)&&(s[i]===jA&&(a=-1),i++);for(var n=[];_A(s[i]);)n.push(s[i++]);var h=n.length?parseInt(u.apply(void 0,n),10):0;s[i]===Xt&&i++;for(var p=[];_A(s[i]);)p.push(s[i++]);var B=p.length,C=B?parseInt(u.apply(void 0,p),10):0;(s[i]===Dn||s[i]===Ln)&&i++;var w=1;(s[i]===it||s[i]===jA)&&(s[i]===jA&&(w=-1),i++);for(var U=[];_A(s[i]);)U.push(s[i++]);var S=U.length?parseInt(u.apply(void 0,U),10):0;return a*(h+C*Math.pow(10,-B))*Math.pow(10,w*S)},Dl={type:2},Pl={type:3},Kl={type:4},Rl={type:13},kl={type:8},Gl={type:21},Ol={type:9},Nl={type:10},Vl={type:11},_l={type:12},Xl={type:14},Mi={type:23},Jl={type:1},Wl={type:25},Yl={type:24},$l={type:26},ql={type:27},Zl={type:28},zl={type:29},jl={type:31},fr={type:32},Rn=function(){function s(){this._value=[]}return s.prototype.write=function(i){this._value=this._value.concat(g(i))},s.prototype.read=function(){for(var i=[],a=this.consumeToken();a!==fr;)i.push(a),a=this.consumeToken();return i},s.prototype.consumeToken=function(){var i=this.consumeCodePoint();switch(i){case Ei:return this.consumeStringToken(Ei);case jo:var a=this.peekCodePoint(0),n=this.peekCodePoint(1),h=this.peekCodePoint(2);if(Kn(a)||ke(n,h)){var p=xi(a,n,h)?qo:$o,B=this.consumeName();return{type:5,value:B,flags:p}}break;case Al:if(this.peekCodePoint(0)===Vt)return this.consumeCodePoint(),Rl;break;case Ui:return this.consumeStringToken(Ui);case Si:return Dl;case _t:return Pl;case ur:if(this.peekCodePoint(0)===Vt)return this.consumeCodePoint(),Xl;break;case it:if(pr(i,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(i),this.consumeNumericToken();break;case ul:return Kl;case jA:var C=i,w=this.peekCodePoint(0),U=this.peekCodePoint(1);if(pr(C,w,U))return this.reconsumeCodePoint(i),this.consumeNumericToken();if(xi(C,w,U))return this.reconsumeCodePoint(i),this.consumeIdentLikeToken();if(w===jA&&U===rl)return this.consumeCodePoint(),this.consumeCodePoint(),Yl;break;case Xt:if(pr(i,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(i),this.consumeNumericToken();break;case In:if(this.peekCodePoint(0)===ur)for(this.consumeCodePoint();;){var S=this.consumeCodePoint();if(S===ur&&(S=this.consumeCodePoint(),S===In))return this.consumeToken();if(S===Fe)return this.consumeToken()}break;case pl:return $l;case fl:return ql;case sl:if(this.peekCodePoint(0)===il&&this.peekCodePoint(1)===jA&&this.peekCodePoint(2)===jA)return this.consumeCodePoint(),this.consumeCodePoint(),Wl;break;case nl:var I=this.peekCodePoint(0),b=this.peekCodePoint(1),G=this.peekCodePoint(2);if(xi(I,b,G)){var B=this.consumeName();return{type:7,value:B}}break;case al:return Zl;case Nt:if(ke(i,this.peekCodePoint(0)))return this.reconsumeCodePoint(i),this.consumeIdentLikeToken();break;case ol:return zl;case ll:if(this.peekCodePoint(0)===Vt)return this.consumeCodePoint(),kl;break;case cl:return Vl;case hl:return _l;case yl:case Ul:var L=this.peekCodePoint(0),P=this.peekCodePoint(1);return L===it&&(gt(P)||P===Ii)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(i),this.consumeIdentLikeToken();case Hn:if(this.peekCodePoint(0)===Vt)return this.consumeCodePoint(),Ol;if(this.peekCodePoint(0)===Hn)return this.consumeCodePoint(),Gl;break;case dl:if(this.peekCodePoint(0)===Vt)return this.consumeCodePoint(),Nl;break;case Fe:return fr}return Hi(i)?(this.consumeWhiteSpace(),jl):_A(i)?(this.reconsumeCodePoint(i),this.consumeNumericToken()):bi(i)?(this.reconsumeCodePoint(i),this.consumeIdentLikeToken()):{type:6,value:u(i)}},s.prototype.consumeCodePoint=function(){var i=this._value.shift();return typeof i=="undefined"?-1:i},s.prototype.reconsumeCodePoint=function(i){this._value.unshift(i)},s.prototype.peekCodePoint=function(i){return i>=this._value.length?-1:this._value[i]},s.prototype.consumeUnicodeRangeToken=function(){for(var i=[],a=this.consumeCodePoint();gt(a)&&i.length<6;)i.push(a),a=this.consumeCodePoint();for(var n=!1;a===Ii&&i.length<6;)i.push(a),a=this.consumeCodePoint(),n=!0;if(n){var h=parseInt(u.apply(void 0,i.map(function(w){return w===Ii?xn:w})),16),p=parseInt(u.apply(void 0,i.map(function(w){return w===Ii?Pn:w})),16);return{type:30,start:h,end:p}}var B=parseInt(u.apply(void 0,i),16);if(this.peekCodePoint(0)===jA&&gt(this.peekCodePoint(1))){this.consumeCodePoint(),a=this.consumeCodePoint();for(var C=[];gt(a)&&C.length<6;)C.push(a),a=this.consumeCodePoint();var p=parseInt(u.apply(void 0,C),16);return{type:30,start:B,end:p}}else return{type:30,start:B,end:B}},s.prototype.consumeIdentLikeToken=function(){var i=this.consumeName();return i.toLowerCase()==="url"&&this.peekCodePoint(0)===Si?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Si?(this.consumeCodePoint(),{type:19,value:i}):{type:20,value:i}},s.prototype.consumeUrlToken=function(){var i=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Fe)return{type:22,value:""};var a=this.peekCodePoint(0);if(a===Ui||a===Ei){var n=this.consumeStringToken(this.consumeCodePoint());return n.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Fe||this.peekCodePoint(0)===_t)?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),Mi)}for(;;){var h=this.consumeCodePoint();if(h===Fe||h===_t)return{type:22,value:u.apply(void 0,i)};if(Hi(h))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Fe||this.peekCodePoint(0)===_t?(this.consumeCodePoint(),{type:22,value:u.apply(void 0,i)}):(this.consumeBadUrlRemnants(),Mi);if(h===Ei||h===Ui||h===Si||Ll(h))return this.consumeBadUrlRemnants(),Mi;if(h===Nt)if(ke(h,this.peekCodePoint(0)))i.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Mi;else i.push(h)}},s.prototype.consumeWhiteSpace=function(){for(;Hi(this.peekCodePoint(0));)this.consumeCodePoint()},s.prototype.consumeBadUrlRemnants=function(){for(;;){var i=this.consumeCodePoint();if(i===_t||i===Fe)return;ke(i,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},s.prototype.consumeStringSlice=function(i){for(var a=5e4,n="";i>0;){var h=Math.min(a,i);n+=u.apply(void 0,this._value.splice(0,h)),i-=h}return this._value.shift(),n},s.prototype.consumeStringToken=function(i){var a="",n=0;do{var h=this._value[n];if(h===Fe||h===void 0||h===i)return a+=this.consumeStringSlice(n),{type:0,value:a};if(h===yi)return this._value.splice(0,n),Jl;if(h===Nt){var p=this._value[n+1];p!==Fe&&p!==void 0&&(p===yi?(a+=this.consumeStringSlice(n),n=-1,this._value.shift()):ke(h,p)&&(a+=this.consumeStringSlice(n),a+=u(this.consumeEscapedCodePoint()),n=-1))}n++}while(!0)},s.prototype.consumeNumber=function(){var i=[],a=Ot,n=this.peekCodePoint(0);for((n===it||n===jA)&&i.push(this.consumeCodePoint());_A(this.peekCodePoint(0));)i.push(this.consumeCodePoint());n=this.peekCodePoint(0);var h=this.peekCodePoint(1);if(n===Xt&&_A(h))for(i.push(this.consumeCodePoint(),this.consumeCodePoint()),a=Sn;_A(this.peekCodePoint(0));)i.push(this.consumeCodePoint());n=this.peekCodePoint(0),h=this.peekCodePoint(1);var p=this.peekCodePoint(2);if((n===Dn||n===Ln)&&((h===it||h===jA)&&_A(p)||_A(h)))for(i.push(this.consumeCodePoint(),this.consumeCodePoint()),a=Sn;_A(this.peekCodePoint(0));)i.push(this.consumeCodePoint());return[Tl(i),a]},s.prototype.consumeNumericToken=function(){var i=this.consumeNumber(),a=i[0],n=i[1],h=this.peekCodePoint(0),p=this.peekCodePoint(1),B=this.peekCodePoint(2);if(xi(h,p,B)){var C=this.consumeName();return{type:15,number:a,flags:n,unit:C}}return h===el?(this.consumeCodePoint(),{type:16,number:a,flags:n}):{type:17,number:a,flags:n}},s.prototype.consumeEscapedCodePoint=function(){var i=this.consumeCodePoint();if(gt(i)){for(var a=u(i);gt(this.peekCodePoint(0))&&a.length<6;)a+=u(this.consumeCodePoint());Hi(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(a,16);return n===0||Il(n)||n>1114111?bn:n}return i===Fe?bn:i},s.prototype.consumeName=function(){for(var i="";;){var a=this.consumeCodePoint();if(Kn(a))i+=u(a);else if(ke(a,this.peekCodePoint(0)))i+=u(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(a),i}},s}(),kn=function(){function s(i){this._tokens=i}return s.create=function(i){var a=new Rn;return a.write(i),new s(a.read())},s.parseValue=function(i){return s.create(i).parseComponentValue()},s.parseValues=function(i){return s.create(i).parseComponentValues()},s.prototype.parseComponentValue=function(){for(var i=this.consumeToken();i.type===31;)i=this.consumeToken();if(i.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(i);var a=this.consumeComponentValue();do i=this.consumeToken();while(i.type===31);if(i.type===32)return a;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},s.prototype.parseComponentValues=function(){for(var i=[];;){var a=this.consumeComponentValue();if(a.type===32)return i;i.push(a),i.push()}},s.prototype.consumeComponentValue=function(){var i=this.consumeToken();switch(i.type){case 11:case 28:case 2:return this.consumeSimpleBlock(i.type);case 19:return this.consumeFunction(i)}return i},s.prototype.consumeSimpleBlock=function(i){for(var a={type:i,values:[]},n=this.consumeToken();;){if(n.type===32||ec(n,i))return a;this.reconsumeToken(n),a.values.push(this.consumeComponentValue()),n=this.consumeToken()}},s.prototype.consumeFunction=function(i){for(var a={name:i.value,values:[],type:18};;){var n=this.consumeToken();if(n.type===32||n.type===3)return a;this.reconsumeToken(n),a.values.push(this.consumeComponentValue())}},s.prototype.consumeToken=function(){var i=this._tokens.shift();return typeof i=="undefined"?fr:i},s.prototype.reconsumeToken=function(i){this._tokens.unshift(i)},s}(),Jt=function(s){return s.type===15},ut=function(s){return s.type===17},hA=function(s){return s.type===20},Ac=function(s){return s.type===0},mr=function(s,i){return hA(s)&&s.value===i},Gn=function(s){return s.type!==31},pt=function(s){return s.type!==31&&s.type!==4},Qe=function(s){var i=[],a=[];return s.forEach(function(n){if(n.type===4){if(a.length===0)throw new Error("Error parsing function args, zero tokens for arg");i.push(a),a=[];return}n.type!==31&&a.push(n)}),a.length&&i.push(a),i},ec=function(s,i){return i===11&&s.type===12||i===28&&s.type===29?!0:i===2&&s.type===3},Ge=function(s){return s.type===17||s.type===15},QA=function(s){return s.type===16||Ge(s)},On=function(s){return s.length>1?[s[0],s[1]]:[s[0]]},kA={type:17,number:0,flags:Ot},Br={type:16,number:50,flags:Ot},Oe={type:16,number:100,flags:Ot},Wt=function(s,i,a){var n=s[0],h=s[1];return[uA(n,i),uA(typeof h!="undefined"?h:n,a)]},uA=function(s,i){if(s.type===16)return s.number/100*i;if(Jt(s))switch(s.unit){case"rem":case"em":return 16*s.number;case"px":default:return s.number}return s.number},Nn="deg",Vn="grad",_n="rad",Xn="turn",Li={name:"angle",parse:function(s,i){if(i.type===15)switch(i.unit){case Nn:return Math.PI*i.number/180;case Vn:return Math.PI/200*i.number;case _n:return i.number;case Xn:return Math.PI*2*i.number}throw new Error("Unsupported angle type")}},Jn=function(s){return s.type===15&&(s.unit===Nn||s.unit===Vn||s.unit===_n||s.unit===Xn)},Wn=function(s){var i=s.filter(hA).map(function(a){return a.value}).join(" ");switch(i){case"to bottom right":case"to right bottom":case"left top":case"top left":return[kA,kA];case"to top":case"bottom":return ce(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[kA,Oe];case"to right":case"left":return ce(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Oe,Oe];case"to bottom":case"top":return ce(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Oe,kA];case"to left":case"right":return ce(270)}return 0},ce=function(s){return Math.PI*s/180},Ne={name:"color",parse:function(s,i){if(i.type===18){var a=tc[i.name];if(typeof a=="undefined")throw new Error('Attempting to parse an unsupported color function "'+i.name+'"');return a(s,i.values)}if(i.type===5){if(i.value.length===3){var n=i.value.substring(0,1),h=i.value.substring(1,2),p=i.value.substring(2,3);return _e(parseInt(n+n,16),parseInt(h+h,16),parseInt(p+p,16),1)}if(i.value.length===4){var n=i.value.substring(0,1),h=i.value.substring(1,2),p=i.value.substring(2,3),B=i.value.substring(3,4);return _e(parseInt(n+n,16),parseInt(h+h,16),parseInt(p+p,16),parseInt(B+B,16)/255)}if(i.value.length===6){var n=i.value.substring(0,2),h=i.value.substring(2,4),p=i.value.substring(4,6);return _e(parseInt(n,16),parseInt(h,16),parseInt(p,16),1)}if(i.value.length===8){var n=i.value.substring(0,2),h=i.value.substring(2,4),p=i.value.substring(4,6),B=i.value.substring(6,8);return _e(parseInt(n,16),parseInt(h,16),parseInt(p,16),parseInt(B,16)/255)}}if(i.type===20){var C=He[i.value.toUpperCase()];if(typeof C!="undefined")return C}return He.TRANSPARENT}},Ve=function(s){return(255&s)===0},TA=function(s){var i=255&s,a=255&s>>8,n=255&s>>16,h=255&s>>24;return i<255?"rgba("+h+","+n+","+a+","+i/255+")":"rgb("+h+","+n+","+a+")"},_e=function(s,i,a,n){return(s<<24|i<<16|a<<8|Math.round(n*255)<<0)>>>0},Yn=function(s,i){if(s.type===17)return s.number;if(s.type===16){var a=i===3?1:255;return i===3?s.number/100*a:Math.round(s.number/100*a)}return 0},$n=function(s,i){var a=i.filter(pt);if(a.length===3){var n=a.map(Yn),h=n[0],p=n[1],B=n[2];return _e(h,p,B,1)}if(a.length===4){var C=a.map(Yn),h=C[0],p=C[1],B=C[2],w=C[3];return _e(h,p,B,w)}return 0};function wr(s,i,a){return a<0&&(a+=1),a>=1&&(a-=1),a<1/6?(i-s)*a*6+s:a<1/2?i:a<2/3?(i-s)*6*(2/3-a)+s:s}var qn=function(s,i){var a=i.filter(pt),n=a[0],h=a[1],p=a[2],B=a[3],C=(n.type===17?ce(n.number):Li.parse(s,n))/(Math.PI*2),w=QA(h)?h.number/100:0,U=QA(p)?p.number/100:0,S=typeof B!="undefined"&&QA(B)?uA(B,1):1;if(w===0)return _e(U*255,U*255,U*255,1);var I=U<=.5?U*(w+1):U+w-U*w,b=U*2-I,G=wr(b,I,C+1/3),L=wr(b,I,C),P=wr(b,I,C-1/3);return _e(G*255,L*255,P*255,S)},tc={hsl:qn,hsla:qn,rgb:$n,rgba:$n},Yt=function(s,i){return Ne.parse(s,kn.create(i).parseComponentValue())},He={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},ic={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(s,i){return i.map(function(a){if(hA(a))switch(a.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},sc={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Ti=function(s,i){var a=Ne.parse(s,i[0]),n=i[1];return n&&QA(n)?{color:a,stop:n}:{color:a,stop:null}},Zn=function(s,i){var a=s[0],n=s[s.length-1];a.stop===null&&(a.stop=kA),n.stop===null&&(n.stop=Oe);for(var h=[],p=0,B=0;B<s.length;B++){var C=s[B].stop;if(C!==null){var w=uA(C,i);w>p?h.push(w):h.push(p),p=w}else h.push(null)}for(var U=null,B=0;B<h.length;B++){var S=h[B];if(S===null)U===null&&(U=B);else if(U!==null){for(var I=B-U,b=h[U-1],G=(S-b)/(I+1),L=1;L<=I;L++)h[U+L-1]=G*L;U=null}}return s.map(function(P,q){var _=P.color;return{color:_,stop:Math.max(Math.min(1,h[q]/i),0)}})},rc=function(s,i,a){var n=i/2,h=a/2,p=uA(s[0],i)-n,B=h-uA(s[1],a);return(Math.atan2(B,p)+Math.PI*2)%(Math.PI*2)},nc=function(s,i,a){var n=typeof s=="number"?s:rc(s,i,a),h=Math.abs(i*Math.sin(n))+Math.abs(a*Math.cos(n)),p=i/2,B=a/2,C=h/2,w=Math.sin(n-Math.PI/2)*C,U=Math.cos(n-Math.PI/2)*C;return[h,p-U,p+U,B-w,B+w]},Be=function(s,i){return Math.sqrt(s*s+i*i)},zn=function(s,i,a,n,h){var p=[[0,0],[0,i],[s,0],[s,i]];return p.reduce(function(B,C){var w=C[0],U=C[1],S=Be(a-w,n-U);return(h?S<B.optimumDistance:S>B.optimumDistance)?{optimumCorner:C,optimumDistance:S}:B},{optimumDistance:h?1/0:-1/0,optimumCorner:null}).optimumCorner},ac=function(s,i,a,n,h){var p=0,B=0;switch(s.size){case 0:s.shape===0?p=B=Math.min(Math.abs(i),Math.abs(i-n),Math.abs(a),Math.abs(a-h)):s.shape===1&&(p=Math.min(Math.abs(i),Math.abs(i-n)),B=Math.min(Math.abs(a),Math.abs(a-h)));break;case 2:if(s.shape===0)p=B=Math.min(Be(i,a),Be(i,a-h),Be(i-n,a),Be(i-n,a-h));else if(s.shape===1){var C=Math.min(Math.abs(a),Math.abs(a-h))/Math.min(Math.abs(i),Math.abs(i-n)),w=zn(n,h,i,a,!0),U=w[0],S=w[1];p=Be(U-i,(S-a)/C),B=C*p}break;case 1:s.shape===0?p=B=Math.max(Math.abs(i),Math.abs(i-n),Math.abs(a),Math.abs(a-h)):s.shape===1&&(p=Math.max(Math.abs(i),Math.abs(i-n)),B=Math.max(Math.abs(a),Math.abs(a-h)));break;case 3:if(s.shape===0)p=B=Math.max(Be(i,a),Be(i,a-h),Be(i-n,a),Be(i-n,a-h));else if(s.shape===1){var C=Math.max(Math.abs(a),Math.abs(a-h))/Math.max(Math.abs(i),Math.abs(i-n)),I=zn(n,h,i,a,!1),U=I[0],S=I[1];p=Be(U-i,(S-a)/C),B=C*p}break}return Array.isArray(s.size)&&(p=uA(s.size[0],n),B=s.size.length===2?uA(s.size[1],h):p),[p,B]},oc=function(s,i){var a=ce(180),n=[];return Qe(i).forEach(function(h,p){if(p===0){var B=h[0];if(B.type===20&&B.value==="to"){a=Wn(h);return}else if(Jn(B)){a=Li.parse(s,B);return}}var C=Ti(s,h);n.push(C)}),{angle:a,stops:n,type:1}},Di=function(s,i){var a=ce(180),n=[];return Qe(i).forEach(function(h,p){if(p===0){var B=h[0];if(B.type===20&&["top","left","right","bottom"].indexOf(B.value)!==-1){a=Wn(h);return}else if(Jn(B)){a=(Li.parse(s,B)+ce(270))%ce(360);return}}var C=Ti(s,h);n.push(C)}),{angle:a,stops:n,type:1}},lc=function(s,i){var a=ce(180),n=[],h=1,p=0,B=3,C=[];return Qe(i).forEach(function(w,U){var S=w[0];if(U===0){if(hA(S)&&S.value==="linear"){h=1;return}else if(hA(S)&&S.value==="radial"){h=2;return}}if(S.type===18){if(S.name==="from"){var I=Ne.parse(s,S.values[0]);n.push({stop:kA,color:I})}else if(S.name==="to"){var I=Ne.parse(s,S.values[0]);n.push({stop:Oe,color:I})}else if(S.name==="color-stop"){var b=S.values.filter(pt);if(b.length===2){var I=Ne.parse(s,b[1]),G=b[0];ut(G)&&n.push({stop:{type:16,number:G.number*100,flags:G.flags},color:I})}}}}),h===1?{angle:(a+ce(180))%ce(360),stops:n,type:h}:{size:B,shape:p,stops:n,position:C,type:h}},jn="closest-side",Aa="farthest-side",ea="closest-corner",ta="farthest-corner",ia="circle",sa="ellipse",ra="cover",na="contain",cc=function(s,i){var a=0,n=3,h=[],p=[];return Qe(i).forEach(function(B,C){var w=!0;if(C===0){var U=!1;w=B.reduce(function(I,b){if(U)if(hA(b))switch(b.value){case"center":return p.push(Br),I;case"top":case"left":return p.push(kA),I;case"right":case"bottom":return p.push(Oe),I}else(QA(b)||Ge(b))&&p.push(b);else if(hA(b))switch(b.value){case ia:return a=0,!1;case sa:return a=1,!1;case"at":return U=!0,!1;case jn:return n=0,!1;case ra:case Aa:return n=1,!1;case na:case ea:return n=2,!1;case ta:return n=3,!1}else if(Ge(b)||QA(b))return Array.isArray(n)||(n=[]),n.push(b),!1;return I},w)}if(w){var S=Ti(s,B);h.push(S)}}),{size:n,shape:a,stops:h,position:p,type:2}},Pi=function(s,i){var a=0,n=3,h=[],p=[];return Qe(i).forEach(function(B,C){var w=!0;if(C===0?w=B.reduce(function(S,I){if(hA(I))switch(I.value){case"center":return p.push(Br),!1;case"top":case"left":return p.push(kA),!1;case"right":case"bottom":return p.push(Oe),!1}else if(QA(I)||Ge(I))return p.push(I),!1;return S},w):C===1&&(w=B.reduce(function(S,I){if(hA(I))switch(I.value){case ia:return a=0,!1;case sa:return a=1,!1;case na:case jn:return n=0,!1;case Aa:return n=1,!1;case ea:return n=2,!1;case ra:case ta:return n=3,!1}else if(Ge(I)||QA(I))return Array.isArray(n)||(n=[]),n.push(I),!1;return S},w)),w){var U=Ti(s,B);h.push(U)}}),{size:n,shape:a,stops:h,position:p,type:2}},hc=function(s){return s.type===1},dc=function(s){return s.type===2},Cr={name:"image",parse:function(s,i){if(i.type===22){var a={url:i.value,type:0};return s.cache.addImage(i.value),a}if(i.type===18){var n=aa[i.name];if(typeof n=="undefined")throw new Error('Attempting to parse an unsupported image function "'+i.name+'"');return n(s,i.values)}throw new Error("Unsupported image type "+i.type)}};function gc(s){return!(s.type===20&&s.value==="none")&&(s.type!==18||!!aa[s.name])}var aa={"linear-gradient":oc,"-moz-linear-gradient":Di,"-ms-linear-gradient":Di,"-o-linear-gradient":Di,"-webkit-linear-gradient":Di,"radial-gradient":cc,"-moz-radial-gradient":Pi,"-ms-radial-gradient":Pi,"-o-radial-gradient":Pi,"-webkit-radial-gradient":Pi,"-webkit-gradient":lc},uc={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(s,i){if(i.length===0)return[];var a=i[0];return a.type===20&&a.value==="none"?[]:i.filter(function(n){return pt(n)&&gc(n)}).map(function(n){return Cr.parse(s,n)})}},pc={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(s,i){return i.map(function(a){if(hA(a))switch(a.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},fc={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(s,i){return Qe(i).map(function(a){return a.filter(QA)}).map(On)}},mc={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(s,i){return Qe(i).map(function(a){return a.filter(hA).map(function(n){return n.value}).join(" ")}).map(Bc)}},Bc=function(s){switch(s){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},ft;(function(s){s.AUTO="auto",s.CONTAIN="contain",s.COVER="cover"})(ft||(ft={}));var wc={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(s,i){return Qe(i).map(function(a){return a.filter(Cc)})}},Cc=function(s){return hA(s)||QA(s)},Ki=function(s){return{name:"border-"+s+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},vc=Ki("top"),Fc=Ki("right"),Qc=Ki("bottom"),yc=Ki("left"),Ri=function(s){return{name:"border-radius-"+s,initialValue:"0 0",prefix:!1,type:1,parse:function(i,a){return On(a.filter(QA))}}},Ec=Ri("top-left"),Uc=Ri("top-right"),Sc=Ri("bottom-right"),Ic=Ri("bottom-left"),ki=function(s){return{name:"border-"+s+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(i,a){switch(a){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Hc=ki("top"),bc=ki("right"),xc=ki("bottom"),Mc=ki("left"),Gi=function(s){return{name:"border-"+s+"-width",initialValue:"0",type:0,prefix:!1,parse:function(i,a){return Jt(a)?a.number:0}}},Lc=Gi("top"),Tc=Gi("right"),Dc=Gi("bottom"),Pc=Gi("left"),Kc={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Rc={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(s,i){switch(i){case"rtl":return 1;case"ltr":default:return 0}}},kc={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(s,i){return i.filter(hA).reduce(function(a,n){return a|Gc(n.value)},0)}},Gc=function(s){switch(s){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Oc={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(s,i){switch(i){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Nc={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(s,i){return i.type===20&&i.value==="normal"?0:i.type===17||i.type===15?i.number:0}},Oi;(function(s){s.NORMAL="normal",s.STRICT="strict"})(Oi||(Oi={}));var Vc={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(s,i){switch(i){case"strict":return Oi.STRICT;case"normal":default:return Oi.NORMAL}}},_c={name:"line-height",initialValue:"normal",prefix:!1,type:4},oa=function(s,i){return hA(s)&&s.value==="normal"?1.2*i:s.type===17?i*s.number:QA(s)?uA(s,i):i},Xc={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(s,i){return i.type===20&&i.value==="none"?null:Cr.parse(s,i)}},Jc={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(s,i){switch(i){case"inside":return 0;case"outside":default:return 1}}},vr={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(s,i){switch(i){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Ni=function(s){return{name:"margin-"+s,initialValue:"0",prefix:!1,type:4}},Wc=Ni("top"),Yc=Ni("right"),$c=Ni("bottom"),qc=Ni("left"),Zc={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(s,i){return i.filter(hA).map(function(a){switch(a.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},zc={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(s,i){switch(i){case"break-word":return"break-word";case"normal":default:return"normal"}}},Vi=function(s){return{name:"padding-"+s,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},jc=Vi("top"),Ah=Vi("right"),eh=Vi("bottom"),th=Vi("left"),ih={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(s,i){switch(i){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},sh={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(s,i){switch(i){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},rh={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(s,i){return i.length===1&&mr(i[0],"none")?[]:Qe(i).map(function(a){for(var n={color:He.TRANSPARENT,offsetX:kA,offsetY:kA,blur:kA},h=0,p=0;p<a.length;p++){var B=a[p];Ge(B)?(h===0?n.offsetX=B:h===1?n.offsetY=B:n.blur=B,h++):n.color=Ne.parse(s,B)}return n})}},nh={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(s,i){switch(i){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},ah={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(s,i){if(i.type===20&&i.value==="none")return null;if(i.type===18){var a=ch[i.name];if(typeof a=="undefined")throw new Error('Attempting to parse an unsupported transform function "'+i.name+'"');return a(i.values)}return null}},oh=function(s){var i=s.filter(function(a){return a.type===17}).map(function(a){return a.number});return i.length===6?i:null},lh=function(s){var i=s.filter(function(w){return w.type===17}).map(function(w){return w.number}),a=i[0],n=i[1];i[2],i[3];var h=i[4],p=i[5];i[6],i[7],i[8],i[9],i[10],i[11];var B=i[12],C=i[13];return i[14],i[15],i.length===16?[a,n,h,p,B,C]:null},ch={matrix:oh,matrix3d:lh},la={type:16,number:50,flags:Ot},hh=[la,la],dh={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(s,i){var a=i.filter(QA);return a.length!==2?hh:[a[0],a[1]]}},gh={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(s,i){switch(i){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},$t;(function(s){s.NORMAL="normal",s.BREAK_ALL="break-all",s.KEEP_ALL="keep-all"})($t||($t={}));for(var uh={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(s,i){switch(i){case"break-all":return $t.BREAK_ALL;case"keep-all":return $t.KEEP_ALL;case"normal":default:return $t.NORMAL}}},ph={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(s,i){if(i.type===20)return{auto:!0,order:0};if(ut(i))return{auto:!1,order:i.number};throw new Error("Invalid z-index number parsed")}},ca={name:"time",parse:function(s,i){if(i.type===15)switch(i.unit.toLowerCase()){case"s":return 1e3*i.number;case"ms":return i.number}throw new Error("Unsupported time type")}},fh={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(s,i){return ut(i)?i.number:1}},mh={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Bh={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(s,i){return i.filter(hA).map(function(a){switch(a.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(a){return a!==0})}},wh={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(s,i){var a=[],n=[];return i.forEach(function(h){switch(h.type){case 20:case 0:a.push(h.value);break;case 17:a.push(h.number.toString());break;case 4:n.push(a.join(" ")),a.length=0;break}}),a.length&&n.push(a.join(" ")),n.map(function(h){return h.indexOf(" ")===-1?h:"'"+h+"'"})}},Ch={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},vh={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(s,i){if(ut(i))return i.number;if(hA(i))switch(i.value){case"bold":return 700;case"normal":default:return 400}return 400}},Fh={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(s,i){return i.filter(hA).map(function(a){return a.value})}},Qh={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(s,i){switch(i){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},bA=function(s,i){return(s&i)!==0},yh={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(s,i){if(i.length===0)return[];var a=i[0];return a.type===20&&a.value==="none"?[]:i}},Eh={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(s,i){if(i.length===0)return null;var a=i[0];if(a.type===20&&a.value==="none")return null;for(var n=[],h=i.filter(Gn),p=0;p<h.length;p++){var B=h[p],C=h[p+1];if(B.type===20){var w=C&&ut(C)?C.number:1;n.push({counter:B.value,increment:w})}}return n}},Uh={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(s,i){if(i.length===0)return[];for(var a=[],n=i.filter(Gn),h=0;h<n.length;h++){var p=n[h],B=n[h+1];if(hA(p)&&p.value!=="none"){var C=B&&ut(B)?B.number:0;a.push({counter:p.value,reset:C})}}return a}},Sh={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(s,i){return i.filter(Jt).map(function(a){return ca.parse(s,a)})}},Ih={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(s,i){if(i.length===0)return null;var a=i[0];if(a.type===20&&a.value==="none")return null;var n=[],h=i.filter(Ac);if(h.length%2!==0)return null;for(var p=0;p<h.length;p+=2){var B=h[p].value,C=h[p+1].value;n.push({open:B,close:C})}return n}},ha=function(s,i,a){if(!s)return"";var n=s[Math.min(i,s.length-1)];return n?a?n.open:n.close:""},Hh={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(s,i){return i.length===1&&mr(i[0],"none")?[]:Qe(i).map(function(a){for(var n={color:255,offsetX:kA,offsetY:kA,blur:kA,spread:kA,inset:!1},h=0,p=0;p<a.length;p++){var B=a[p];mr(B,"inset")?n.inset=!0:Ge(B)?(h===0?n.offsetX=B:h===1?n.offsetY=B:h===2?n.blur=B:n.spread=B,h++):n.color=Ne.parse(s,B)}return n})}},bh={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(s,i){var a=[0,1,2],n=[];return i.filter(hA).forEach(function(h){switch(h.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2);break}}),a.forEach(function(h){n.indexOf(h)===-1&&n.push(h)}),n}},xh={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Mh={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(s,i){return Jt(i)?i.number:0}},Lh=function(){function s(i,a){var n,h;this.animationDuration=O(i,Sh,a.animationDuration),this.backgroundClip=O(i,ic,a.backgroundClip),this.backgroundColor=O(i,sc,a.backgroundColor),this.backgroundImage=O(i,uc,a.backgroundImage),this.backgroundOrigin=O(i,pc,a.backgroundOrigin),this.backgroundPosition=O(i,fc,a.backgroundPosition),this.backgroundRepeat=O(i,mc,a.backgroundRepeat),this.backgroundSize=O(i,wc,a.backgroundSize),this.borderTopColor=O(i,vc,a.borderTopColor),this.borderRightColor=O(i,Fc,a.borderRightColor),this.borderBottomColor=O(i,Qc,a.borderBottomColor),this.borderLeftColor=O(i,yc,a.borderLeftColor),this.borderTopLeftRadius=O(i,Ec,a.borderTopLeftRadius),this.borderTopRightRadius=O(i,Uc,a.borderTopRightRadius),this.borderBottomRightRadius=O(i,Sc,a.borderBottomRightRadius),this.borderBottomLeftRadius=O(i,Ic,a.borderBottomLeftRadius),this.borderTopStyle=O(i,Hc,a.borderTopStyle),this.borderRightStyle=O(i,bc,a.borderRightStyle),this.borderBottomStyle=O(i,xc,a.borderBottomStyle),this.borderLeftStyle=O(i,Mc,a.borderLeftStyle),this.borderTopWidth=O(i,Lc,a.borderTopWidth),this.borderRightWidth=O(i,Tc,a.borderRightWidth),this.borderBottomWidth=O(i,Dc,a.borderBottomWidth),this.borderLeftWidth=O(i,Pc,a.borderLeftWidth),this.boxShadow=O(i,Hh,a.boxShadow),this.color=O(i,Kc,a.color),this.direction=O(i,Rc,a.direction),this.display=O(i,kc,a.display),this.float=O(i,Oc,a.cssFloat),this.fontFamily=O(i,wh,a.fontFamily),this.fontSize=O(i,Ch,a.fontSize),this.fontStyle=O(i,Qh,a.fontStyle),this.fontVariant=O(i,Fh,a.fontVariant),this.fontWeight=O(i,vh,a.fontWeight),this.letterSpacing=O(i,Nc,a.letterSpacing),this.lineBreak=O(i,Vc,a.lineBreak),this.lineHeight=O(i,_c,a.lineHeight),this.listStyleImage=O(i,Xc,a.listStyleImage),this.listStylePosition=O(i,Jc,a.listStylePosition),this.listStyleType=O(i,vr,a.listStyleType),this.marginTop=O(i,Wc,a.marginTop),this.marginRight=O(i,Yc,a.marginRight),this.marginBottom=O(i,$c,a.marginBottom),this.marginLeft=O(i,qc,a.marginLeft),this.opacity=O(i,fh,a.opacity);var p=O(i,Zc,a.overflow);this.overflowX=p[0],this.overflowY=p[p.length>1?1:0],this.overflowWrap=O(i,zc,a.overflowWrap),this.paddingTop=O(i,jc,a.paddingTop),this.paddingRight=O(i,Ah,a.paddingRight),this.paddingBottom=O(i,eh,a.paddingBottom),this.paddingLeft=O(i,th,a.paddingLeft),this.paintOrder=O(i,bh,a.paintOrder),this.position=O(i,sh,a.position),this.textAlign=O(i,ih,a.textAlign),this.textDecorationColor=O(i,mh,(n=a.textDecorationColor)!==null&&n!==void 0?n:a.color),this.textDecorationLine=O(i,Bh,(h=a.textDecorationLine)!==null&&h!==void 0?h:a.textDecoration),this.textShadow=O(i,rh,a.textShadow),this.textTransform=O(i,nh,a.textTransform),this.transform=O(i,ah,a.transform),this.transformOrigin=O(i,dh,a.transformOrigin),this.visibility=O(i,gh,a.visibility),this.webkitTextStrokeColor=O(i,xh,a.webkitTextStrokeColor),this.webkitTextStrokeWidth=O(i,Mh,a.webkitTextStrokeWidth),this.wordBreak=O(i,uh,a.wordBreak),this.zIndex=O(i,ph,a.zIndex)}return s.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},s.prototype.isTransparent=function(){return Ve(this.backgroundColor)},s.prototype.isTransformed=function(){return this.transform!==null},s.prototype.isPositioned=function(){return this.position!==0},s.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},s.prototype.isFloating=function(){return this.float!==0},s.prototype.isInlineLevel=function(){return bA(this.display,4)||bA(this.display,33554432)||bA(this.display,268435456)||bA(this.display,536870912)||bA(this.display,67108864)||bA(this.display,134217728)},s}(),Th=function(){function s(i,a){this.content=O(i,yh,a.content),this.quotes=O(i,Ih,a.quotes)}return s}(),da=function(){function s(i,a){this.counterIncrement=O(i,Eh,a.counterIncrement),this.counterReset=O(i,Uh,a.counterReset)}return s}(),O=function(s,i,a){var n=new Rn,h=a!==null&&typeof a!="undefined"?a.toString():i.initialValue;n.write(h);var p=new kn(n.read());switch(i.type){case 2:var B=p.parseComponentValue();return i.parse(s,hA(B)?B.value:i.initialValue);case 0:return i.parse(s,p.parseComponentValue());case 1:return i.parse(s,p.parseComponentValues());case 4:return p.parseComponentValue();case 3:switch(i.format){case"angle":return Li.parse(s,p.parseComponentValue());case"color":return Ne.parse(s,p.parseComponentValue());case"image":return Cr.parse(s,p.parseComponentValue());case"length":var C=p.parseComponentValue();return Ge(C)?C:kA;case"length-percentage":var w=p.parseComponentValue();return QA(w)?w:kA;case"time":return ca.parse(s,p.parseComponentValue())}break}},Dh="data-html2canvas-debug",Ph=function(s){var i=s.getAttribute(Dh);switch(i){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Fr=function(s,i){var a=Ph(s);return a===1||i===a},ye=function(){function s(i,a){if(this.context=i,this.textNodes=[],this.elements=[],this.flags=0,Fr(a,3))debugger;this.styles=new Lh(i,window.getComputedStyle(a,null)),Pr(a)&&(this.styles.animationDuration.some(function(n){return n>0})&&(a.style.animationDuration="0s"),this.styles.transform!==null&&(a.style.transform="none")),this.bounds=c(this.context,a),Fr(a,4)&&(this.flags|=16)}return s}(),Kh="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",ga="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qt=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),_i=0;_i<ga.length;_i++)qt[ga.charCodeAt(_i)]=_i;for(var Rh=function(s){var i=s.length*.75,a=s.length,n,h=0,p,B,C,w;s[s.length-1]==="="&&(i--,s[s.length-2]==="="&&i--);var U=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined"&&typeof Uint8Array.prototype.slice!="undefined"?new ArrayBuffer(i):new Array(i),S=Array.isArray(U)?U:new Uint8Array(U);for(n=0;n<a;n+=4)p=qt[s.charCodeAt(n)],B=qt[s.charCodeAt(n+1)],C=qt[s.charCodeAt(n+2)],w=qt[s.charCodeAt(n+3)],S[h++]=p<<2|B>>4,S[h++]=(B&15)<<4|C>>2,S[h++]=(C&3)<<6|w&63;return U},kh=function(s){for(var i=s.length,a=[],n=0;n<i;n+=2)a.push(s[n+1]<<8|s[n]);return a},Gh=function(s){for(var i=s.length,a=[],n=0;n<i;n+=4)a.push(s[n+3]<<24|s[n+2]<<16|s[n+1]<<8|s[n]);return a},st=5,Qr=11,yr=2,Oh=Qr-st,ua=65536>>st,Nh=1<<st,Er=Nh-1,Vh=1024>>st,_h=ua+Vh,Xh=_h,Jh=32,Wh=Xh+Jh,Yh=65536>>Qr,$h=1<<Oh,qh=$h-1,pa=function(s,i,a){return s.slice?s.slice(i,a):new Uint16Array(Array.prototype.slice.call(s,i,a))},Zh=function(s,i,a){return s.slice?s.slice(i,a):new Uint32Array(Array.prototype.slice.call(s,i,a))},zh=function(s,i){var a=Rh(s),n=Array.isArray(a)?Gh(a):new Uint32Array(a),h=Array.isArray(a)?kh(a):new Uint16Array(a),p=24,B=pa(h,p/2,n[4]/2),C=n[5]===2?pa(h,(p+n[4])/2):Zh(n,Math.ceil((p+n[4])/4));return new jh(n[0],n[1],n[2],n[3],B,C)},jh=function(){function s(i,a,n,h,p,B){this.initialValue=i,this.errorValue=a,this.highStart=n,this.highValueIndex=h,this.index=p,this.data=B}return s.prototype.get=function(i){var a;if(i>=0){if(i<55296||i>56319&&i<=65535)return a=this.index[i>>st],a=(a<<yr)+(i&Er),this.data[a];if(i<=65535)return a=this.index[ua+(i-55296>>st)],a=(a<<yr)+(i&Er),this.data[a];if(i<this.highStart)return a=Wh-Yh+(i>>Qr),a=this.index[a],a+=i>>st&qh,a=this.index[a],a=(a<<yr)+(i&Er),this.data[a];if(i<=1114111)return this.data[this.highValueIndex]}return this.errorValue},s}(),fa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ad=typeof Uint8Array=="undefined"?[]:new Uint8Array(256),Xi=0;Xi<fa.length;Xi++)Ad[fa.charCodeAt(Xi)]=Xi;var ed=1,Ur=2,Sr=3,ma=4,Ba=5,td=7,wa=8,Ir=9,Hr=10,Ca=11,va=12,Fa=13,Qa=14,br=15,id=function(s){for(var i=[],a=0,n=s.length;a<n;){var h=s.charCodeAt(a++);if(h>=55296&&h<=56319&&a<n){var p=s.charCodeAt(a++);(p&64512)===56320?i.push(((h&1023)<<10)+(p&1023)+65536):(i.push(h),a--)}else i.push(h)}return i},sd=function(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];if(String.fromCodePoint)return String.fromCodePoint.apply(String,s);var a=s.length;if(!a)return"";for(var n=[],h=-1,p="";++h<a;){var B=s[h];B<=65535?n.push(B):(B-=65536,n.push((B>>10)+55296,B%1024+56320)),(h+1===a||n.length>16384)&&(p+=String.fromCharCode.apply(String,n),n.length=0)}return p},rd=zh(Kh),he="\xD7",xr="\xF7",nd=function(s){return rd.get(s)},ad=function(s,i,a){var n=a-2,h=i[n],p=i[a-1],B=i[a];if(p===Ur&&B===Sr)return he;if(p===Ur||p===Sr||p===ma||B===Ur||B===Sr||B===ma)return xr;if(p===wa&&[wa,Ir,Ca,va].indexOf(B)!==-1||(p===Ca||p===Ir)&&(B===Ir||B===Hr)||(p===va||p===Hr)&&B===Hr||B===Fa||B===Ba||B===td||p===ed)return he;if(p===Fa&&B===Qa){for(;h===Ba;)h=i[--n];if(h===Qa)return he}if(p===br&&B===br){for(var C=0;h===br;)C++,h=i[--n];if(C%2===0)return he}return xr},od=function(s){var i=id(s),a=i.length,n=0,h=0,p=i.map(nd);return{next:function(){if(n>=a)return{done:!0,value:null};for(var B=he;n<a&&(B=ad(i,p,++n))===he;);if(B!==he||n===a){var C=sd.apply(null,i.slice(h,n));return h=n,{value:C,done:!1}}return{done:!0,value:null}}}},ld=function(s){for(var i=od(s),a=[],n;!(n=i.next()).done;)n.value&&a.push(n.value.slice());return a},cd=function(s){var i=123;if(s.createRange){var a=s.createRange();if(a.getBoundingClientRect){var n=s.createElement("boundtest");n.style.height=i+"px",n.style.display="block",s.body.appendChild(n),a.selectNode(n);var h=a.getBoundingClientRect(),p=Math.round(h.height);if(s.body.removeChild(n),p===i)return!0}}return!1},hd=function(s){var i=s.createElement("boundtest");i.style.width="50px",i.style.display="block",i.style.fontSize="12px",i.style.letterSpacing="0px",i.style.wordSpacing="0px",s.body.appendChild(i);var a=s.createRange();i.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var n=i.firstChild,h=g(n.data).map(function(w){return u(w)}),p=0,B={},C=h.every(function(w,U){a.setStart(n,p),a.setEnd(n,p+w.length);var S=a.getBoundingClientRect();p+=w.length;var I=S.x>B.x||S.y>B.y;return B=S,U===0?!0:I});return s.body.removeChild(i),C},dd=function(){return typeof new Image().crossOrigin!="undefined"},gd=function(){return typeof new XMLHttpRequest().responseType=="string"},ud=function(s){var i=new Image,a=s.createElement("canvas"),n=a.getContext("2d");if(!n)return!1;i.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(i,0,0),a.toDataURL()}catch(h){return!1}return!0},ya=function(s){return s[0]===0&&s[1]===255&&s[2]===0&&s[3]===255},pd=function(s){var i=s.createElement("canvas"),a=100;i.width=a,i.height=a;var n=i.getContext("2d");if(!n)return Promise.reject(!1);n.fillStyle="rgb(0, 255, 0)",n.fillRect(0,0,a,a);var h=new Image,p=i.toDataURL();h.src=p;var B=Mr(a,a,0,0,h);return n.fillStyle="red",n.fillRect(0,0,a,a),Ea(B).then(function(C){n.drawImage(C,0,0);var w=n.getImageData(0,0,a,a).data;n.fillStyle="red",n.fillRect(0,0,a,a);var U=s.createElement("div");return U.style.backgroundImage="url("+p+")",U.style.height=a+"px",ya(w)?Ea(Mr(a,a,0,0,U)):Promise.reject(!1)}).then(function(C){return n.drawImage(C,0,0),ya(n.getImageData(0,0,a,a).data)}).catch(function(){return!1})},Mr=function(s,i,a,n,h){var p="http://www.w3.org/2000/svg",B=document.createElementNS(p,"svg"),C=document.createElementNS(p,"foreignObject");return B.setAttributeNS(null,"width",s.toString()),B.setAttributeNS(null,"height",i.toString()),C.setAttributeNS(null,"width","100%"),C.setAttributeNS(null,"height","100%"),C.setAttributeNS(null,"x",a.toString()),C.setAttributeNS(null,"y",n.toString()),C.setAttributeNS(null,"externalResourcesRequired","true"),B.appendChild(C),C.appendChild(h),B},Ea=function(s){return new Promise(function(i,a){var n=new Image;n.onload=function(){return i(n)},n.onerror=a,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(s))})},GA={get SUPPORT_RANGE_BOUNDS(){var s=cd(document);return Object.defineProperty(GA,"SUPPORT_RANGE_BOUNDS",{value:s}),s},get SUPPORT_WORD_BREAKING(){var s=GA.SUPPORT_RANGE_BOUNDS&&hd(document);return Object.defineProperty(GA,"SUPPORT_WORD_BREAKING",{value:s}),s},get SUPPORT_SVG_DRAWING(){var s=ud(document);return Object.defineProperty(GA,"SUPPORT_SVG_DRAWING",{value:s}),s},get SUPPORT_FOREIGNOBJECT_DRAWING(){var s=typeof Array.from=="function"&&typeof window.fetch=="function"?pd(document):Promise.resolve(!1);return Object.defineProperty(GA,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:s}),s},get SUPPORT_CORS_IMAGES(){var s=dd();return Object.defineProperty(GA,"SUPPORT_CORS_IMAGES",{value:s}),s},get SUPPORT_RESPONSE_TYPE(){var s=gd();return Object.defineProperty(GA,"SUPPORT_RESPONSE_TYPE",{value:s}),s},get SUPPORT_CORS_XHR(){var s="withCredentials"in new XMLHttpRequest;return Object.defineProperty(GA,"SUPPORT_CORS_XHR",{value:s}),s},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var s=!!(typeof Intl!="undefined"&&Intl.Segmenter);return Object.defineProperty(GA,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:s}),s}},Zt=function(){function s(i,a){this.text=i,this.bounds=a}return s}(),fd=function(s,i,a,n){var h=wd(i,a),p=[],B=0;return h.forEach(function(C){if(a.textDecorationLine.length||C.trim().length>0)if(GA.SUPPORT_RANGE_BOUNDS){var w=Ua(n,B,C.length).getClientRects();if(w.length>1){var U=Lr(C),S=0;U.forEach(function(b){p.push(new Zt(b,l.fromDOMRectList(s,Ua(n,S+B,b.length).getClientRects()))),S+=b.length})}else p.push(new Zt(C,l.fromDOMRectList(s,w)))}else{var I=n.splitText(C.length);p.push(new Zt(C,md(s,n))),n=I}else GA.SUPPORT_RANGE_BOUNDS||(n=n.splitText(C.length));B+=C.length}),p},md=function(s,i){var a=i.ownerDocument;if(a){var n=a.createElement("html2canvaswrapper");n.appendChild(i.cloneNode(!0));var h=i.parentNode;if(h){h.replaceChild(n,i);var p=c(s,n);return n.firstChild&&h.replaceChild(n.firstChild,n),p}}return l.EMPTY},Ua=function(s,i,a){var n=s.ownerDocument;if(!n)throw new Error("Node has no owner document");var h=n.createRange();return h.setStart(s,i),h.setEnd(s,i+a),h},Lr=function(s){if(GA.SUPPORT_NATIVE_TEXT_SEGMENTATION){var i=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(i.segment(s)).map(function(a){return a.segment})}return ld(s)},Bd=function(s,i){if(GA.SUPPORT_NATIVE_TEXT_SEGMENTATION){var a=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(a.segment(s)).map(function(n){return n.segment})}return vd(s,i)},wd=function(s,i){return i.letterSpacing!==0?Lr(s):Bd(s,i)},Cd=[32,160,4961,65792,65793,4153,4241],vd=function(s,i){for(var a=Yo(s,{lineBreak:i.lineBreak,wordBreak:i.overflowWrap==="break-word"?"break-word":i.wordBreak}),n=[],h,p=function(){if(h.value){var B=h.value.slice(),C=g(B),w="";C.forEach(function(U){Cd.indexOf(U)===-1?w+=u(U):(w.length&&n.push(w),n.push(u(U)),w="")}),w.length&&n.push(w)}};!(h=a.next()).done;)p();return n},Fd=function(){function s(i,a,n){this.text=Qd(a.data,n.textTransform),this.textBounds=fd(i,this.text,n,a)}return s}(),Qd=function(s,i){switch(i){case 1:return s.toLowerCase();case 3:return s.replace(yd,Ed);case 2:return s.toUpperCase();default:return s}},yd=/(^|\s|:|-|\(|\))([a-z])/g,Ed=function(s,i,a){return s.length>0?i+a.toUpperCase():s},Sa=function(s){e(i,s);function i(a,n){var h=s.call(this,a,n)||this;return h.src=n.currentSrc||n.src,h.intrinsicWidth=n.naturalWidth,h.intrinsicHeight=n.naturalHeight,h.context.cache.addImage(h.src),h}return i}(ye),Ia=function(s){e(i,s);function i(a,n){var h=s.call(this,a,n)||this;return h.canvas=n,h.intrinsicWidth=n.width,h.intrinsicHeight=n.height,h}return i}(ye),Ha=function(s){e(i,s);function i(a,n){var h=s.call(this,a,n)||this,p=new XMLSerializer,B=c(a,n);return n.setAttribute("width",B.width+"px"),n.setAttribute("height",B.height+"px"),h.svg="data:image/svg+xml,"+encodeURIComponent(p.serializeToString(n)),h.intrinsicWidth=n.width.baseVal.value,h.intrinsicHeight=n.height.baseVal.value,h.context.cache.addImage(h.svg),h}return i}(ye),ba=function(s){e(i,s);function i(a,n){var h=s.call(this,a,n)||this;return h.value=n.value,h}return i}(ye),Tr=function(s){e(i,s);function i(a,n){var h=s.call(this,a,n)||this;return h.start=n.start,h.reversed=typeof n.reversed=="boolean"&&n.reversed===!0,h}return i}(ye),Ud=[{type:15,flags:0,unit:"px",number:3}],Sd=[{type:16,flags:0,number:50}],Id=function(s){return s.width>s.height?new l(s.left+(s.width-s.height)/2,s.top,s.height,s.height):s.width<s.height?new l(s.left,s.top+(s.height-s.width)/2,s.width,s.width):s},Hd=function(s){var i=s.type===bd?new Array(s.value.length+1).join("\u2022"):s.value;return i.length===0?s.placeholder||"":i},Ji="checkbox",Wi="radio",bd="password",xa=707406591,Dr=function(s){e(i,s);function i(a,n){var h=s.call(this,a,n)||this;switch(h.type=n.type.toLowerCase(),h.checked=n.checked,h.value=Hd(n),(h.type===Ji||h.type===Wi)&&(h.styles.backgroundColor=3739148031,h.styles.borderTopColor=h.styles.borderRightColor=h.styles.borderBottomColor=h.styles.borderLeftColor=2779096575,h.styles.borderTopWidth=h.styles.borderRightWidth=h.styles.borderBottomWidth=h.styles.borderLeftWidth=1,h.styles.borderTopStyle=h.styles.borderRightStyle=h.styles.borderBottomStyle=h.styles.borderLeftStyle=1,h.styles.backgroundClip=[0],h.styles.backgroundOrigin=[0],h.bounds=Id(h.bounds)),h.type){case Ji:h.styles.borderTopRightRadius=h.styles.borderTopLeftRadius=h.styles.borderBottomRightRadius=h.styles.borderBottomLeftRadius=Ud;break;case Wi:h.styles.borderTopRightRadius=h.styles.borderTopLeftRadius=h.styles.borderBottomRightRadius=h.styles.borderBottomLeftRadius=Sd;break}return h}return i}(ye),Ma=function(s){e(i,s);function i(a,n){var h=s.call(this,a,n)||this,p=n.options[n.selectedIndex||0];return h.value=p&&p.text||"",h}return i}(ye),La=function(s){e(i,s);function i(a,n){var h=s.call(this,a,n)||this;return h.value=n.value,h}return i}(ye),Ta=function(s){e(i,s);function i(a,n){var h=s.call(this,a,n)||this;h.src=n.src,h.width=parseInt(n.width,10)||0,h.height=parseInt(n.height,10)||0,h.backgroundColor=h.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){h.tree=Pa(a,n.contentWindow.document.documentElement);var p=n.contentWindow.document.documentElement?Yt(a,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):He.TRANSPARENT,B=n.contentWindow.document.body?Yt(a,getComputedStyle(n.contentWindow.document.body).backgroundColor):He.TRANSPARENT;h.backgroundColor=Ve(p)?Ve(B)?h.styles.backgroundColor:B:p}}catch(C){}return h}return i}(ye),xd=["OL","UL","MENU"],Yi=function(s,i,a,n){for(var h=i.firstChild,p=void 0;h;h=p)if(p=h.nextSibling,Ka(h)&&h.data.trim().length>0)a.textNodes.push(new Fd(s,h,a.styles));else if(mt(h))if(Va(h)&&h.assignedNodes)h.assignedNodes().forEach(function(C){return Yi(s,C,a,n)});else{var B=Da(s,h);B.styles.isVisible()&&(Md(h,B,n)?B.flags|=4:Ld(B.styles)&&(B.flags|=2),xd.indexOf(h.tagName)!==-1&&(B.flags|=8),a.elements.push(B),h.slot,h.shadowRoot?Yi(s,h.shadowRoot,B,n):!qi(h)&&!Ra(h)&&!Zi(h)&&Yi(s,h,B,n))}},Da=function(s,i){return Rr(i)?new Sa(s,i):ka(i)?new Ia(s,i):Ra(i)?new Ha(s,i):Td(i)?new ba(s,i):Dd(i)?new Tr(s,i):Pd(i)?new Dr(s,i):Zi(i)?new Ma(s,i):qi(i)?new La(s,i):Oa(i)?new Ta(s,i):new ye(s,i)},Pa=function(s,i){var a=Da(s,i);return a.flags|=4,Yi(s,i,a,a),a},Md=function(s,i,a){return i.styles.isPositionedWithZIndex()||i.styles.opacity<1||i.styles.isTransformed()||Kr(s)&&a.styles.isTransparent()},Ld=function(s){return s.isPositioned()||s.isFloating()},Ka=function(s){return s.nodeType===Node.TEXT_NODE},mt=function(s){return s.nodeType===Node.ELEMENT_NODE},Pr=function(s){return mt(s)&&typeof s.style!="undefined"&&!$i(s)},$i=function(s){return typeof s.className=="object"},Td=function(s){return s.tagName==="LI"},Dd=function(s){return s.tagName==="OL"},Pd=function(s){return s.tagName==="INPUT"},Kd=function(s){return s.tagName==="HTML"},Ra=function(s){return s.tagName==="svg"},Kr=function(s){return s.tagName==="BODY"},ka=function(s){return s.tagName==="CANVAS"},Ga=function(s){return s.tagName==="VIDEO"},Rr=function(s){return s.tagName==="IMG"},Oa=function(s){return s.tagName==="IFRAME"},Na=function(s){return s.tagName==="STYLE"},Rd=function(s){return s.tagName==="SCRIPT"},qi=function(s){return s.tagName==="TEXTAREA"},Zi=function(s){return s.tagName==="SELECT"},Va=function(s){return s.tagName==="SLOT"},_a=function(s){return s.tagName.indexOf("-")>0},kd=function(){function s(){this.counters={}}return s.prototype.getCounterValue=function(i){var a=this.counters[i];return a&&a.length?a[a.length-1]:1},s.prototype.getCounterValues=function(i){var a=this.counters[i];return a||[]},s.prototype.pop=function(i){var a=this;i.forEach(function(n){return a.counters[n].pop()})},s.prototype.parse=function(i){var a=this,n=i.counterIncrement,h=i.counterReset,p=!0;n!==null&&n.forEach(function(C){var w=a.counters[C.counter];w&&C.increment!==0&&(p=!1,w.length||w.push(1),w[Math.max(0,w.length-1)]+=C.increment)});var B=[];return p&&h.forEach(function(C){var w=a.counters[C.counter];B.push(C.counter),w||(w=a.counters[C.counter]=[]),w.push(C.reset)}),B},s}(),Xa={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Ja={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054F","\u054E","\u054D","\u054C","\u054B","\u054A","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053F","\u053E","\u053D","\u053C","\u053B","\u053A","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},Gd={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05D9\u05F3","\u05D8\u05F3","\u05D7\u05F3","\u05D6\u05F3","\u05D5\u05F3","\u05D4\u05F3","\u05D3\u05F3","\u05D2\u05F3","\u05D1\u05F3","\u05D0\u05F3","\u05EA","\u05E9","\u05E8","\u05E7","\u05E6","\u05E4","\u05E2","\u05E1","\u05E0","\u05DE","\u05DC","\u05DB","\u05D9\u05D8","\u05D9\u05D7","\u05D9\u05D6","\u05D8\u05D6","\u05D8\u05D5","\u05D9","\u05D8","\u05D7","\u05D6","\u05D5","\u05D4","\u05D3","\u05D2","\u05D1","\u05D0"]},Od={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10F5","\u10F0","\u10EF","\u10F4","\u10EE","\u10ED","\u10EC","\u10EB","\u10EA","\u10E9","\u10E8","\u10E7","\u10E6","\u10E5","\u10E4","\u10F3","\u10E2","\u10E1","\u10E0","\u10DF","\u10DE","\u10DD","\u10F2","\u10DC","\u10DB","\u10DA","\u10D9","\u10D8","\u10D7","\u10F1","\u10D6","\u10D5","\u10D4","\u10D3","\u10D2","\u10D1","\u10D0"]},Bt=function(s,i,a,n,h,p){return s<i||s>a?jt(s,h,p.length>0):n.integers.reduce(function(B,C,w){for(;s>=C;)s-=C,B+=n.values[w];return B},"")+p},Wa=function(s,i,a,n){var h="";do a||s--,h=n(s)+h,s/=i;while(s*i>=i);return h},vA=function(s,i,a,n,h){var p=a-i+1;return(s<0?"-":"")+(Wa(Math.abs(s),p,n,function(B){return u(Math.floor(B%p)+i)})+h)},rt=function(s,i,a){a===void 0&&(a=". ");var n=i.length;return Wa(Math.abs(s),n,!1,function(h){return i[Math.floor(h%n)]})+a},wt=1,Xe=2,Je=4,zt=8,be=function(s,i,a,n,h,p){if(s<-9999||s>9999)return jt(s,4,h.length>0);var B=Math.abs(s),C=h;if(B===0)return i[0]+C;for(var w=0;B>0&&w<=4;w++){var U=B%10;U===0&&bA(p,wt)&&C!==""?C=i[U]+C:U>1||U===1&&w===0||U===1&&w===1&&bA(p,Xe)||U===1&&w===1&&bA(p,Je)&&s>100||U===1&&w>1&&bA(p,zt)?C=i[U]+(w>0?a[w-1]:"")+C:U===1&&w>0&&(C=a[w-1]+C),B=Math.floor(B/10)}return(s<0?n:"")+C},Ya="\u5341\u767E\u5343\u842C",$a="\u62FE\u4F70\u4EDF\u842C",qa="\u30DE\u30A4\u30CA\u30B9",kr="\uB9C8\uC774\uB108\uC2A4",jt=function(s,i,a){var n=a?". ":"",h=a?"\u3001":"",p=a?", ":"",B=a?" ":"";switch(i){case 0:return"\u2022"+B;case 1:return"\u25E6"+B;case 2:return"\u25FE"+B;case 5:var C=vA(s,48,57,!0,n);return C.length<4?"0"+C:C;case 4:return rt(s,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",h);case 6:return Bt(s,1,3999,Xa,3,n).toLowerCase();case 7:return Bt(s,1,3999,Xa,3,n);case 8:return vA(s,945,969,!1,n);case 9:return vA(s,97,122,!1,n);case 10:return vA(s,65,90,!1,n);case 11:return vA(s,1632,1641,!0,n);case 12:case 49:return Bt(s,1,9999,Ja,3,n);case 35:return Bt(s,1,9999,Ja,3,n).toLowerCase();case 13:return vA(s,2534,2543,!0,n);case 14:case 30:return vA(s,6112,6121,!0,n);case 15:return rt(s,"\u5B50\u4E11\u5BC5\u536F\u8FB0\u5DF3\u5348\u672A\u7533\u9149\u620C\u4EA5",h);case 16:return rt(s,"\u7532\u4E59\u4E19\u4E01\u620A\u5DF1\u5E9A\u8F9B\u58EC\u7678",h);case 17:case 48:return be(s,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",Ya,"\u8CA0",h,Xe|Je|zt);case 47:return be(s,"\u96F6\u58F9\u8CB3\u53C3\u8086\u4F0D\u9678\u67D2\u634C\u7396",$a,"\u8CA0",h,wt|Xe|Je|zt);case 42:return be(s,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",Ya,"\u8D1F",h,Xe|Je|zt);case 41:return be(s,"\u96F6\u58F9\u8D30\u53C1\u8086\u4F0D\u9646\u67D2\u634C\u7396",$a,"\u8D1F",h,wt|Xe|Je|zt);case 26:return be(s,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u4E07",qa,h,0);case 25:return be(s,"\u96F6\u58F1\u5F10\u53C2\u56DB\u4F0D\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343\u4E07",qa,h,wt|Xe|Je);case 31:return be(s,"\uC601\uC77C\uC774\uC0BC\uC0AC\uC624\uC721\uCE60\uD314\uAD6C","\uC2ED\uBC31\uCC9C\uB9CC",kr,p,wt|Xe|Je);case 33:return be(s,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u842C",kr,p,0);case 32:return be(s,"\u96F6\u58F9\u8CB3\u53C3\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343",kr,p,wt|Xe|Je);case 18:return vA(s,2406,2415,!0,n);case 20:return Bt(s,1,19999,Od,3,n);case 21:return vA(s,2790,2799,!0,n);case 22:return vA(s,2662,2671,!0,n);case 22:return Bt(s,1,10999,Gd,3,n);case 23:return rt(s,"\u3042\u3044\u3046\u3048\u304A\u304B\u304D\u304F\u3051\u3053\u3055\u3057\u3059\u305B\u305D\u305F\u3061\u3064\u3066\u3068\u306A\u306B\u306C\u306D\u306E\u306F\u3072\u3075\u3078\u307B\u307E\u307F\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308A\u308B\u308C\u308D\u308F\u3090\u3091\u3092\u3093");case 24:return rt(s,"\u3044\u308D\u306F\u306B\u307B\u3078\u3068\u3061\u308A\u306C\u308B\u3092\u308F\u304B\u3088\u305F\u308C\u305D\u3064\u306D\u306A\u3089\u3080\u3046\u3090\u306E\u304A\u304F\u3084\u307E\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304D\u3086\u3081\u307F\u3057\u3091\u3072\u3082\u305B\u3059");case 27:return vA(s,3302,3311,!0,n);case 28:return rt(s,"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F0\u30F1\u30F2\u30F3",h);case 29:return rt(s,"\u30A4\u30ED\u30CF\u30CB\u30DB\u30D8\u30C8\u30C1\u30EA\u30CC\u30EB\u30F2\u30EF\u30AB\u30E8\u30BF\u30EC\u30BD\u30C4\u30CD\u30CA\u30E9\u30E0\u30A6\u30F0\u30CE\u30AA\u30AF\u30E4\u30DE\u30B1\u30D5\u30B3\u30A8\u30C6\u30A2\u30B5\u30AD\u30E6\u30E1\u30DF\u30B7\u30F1\u30D2\u30E2\u30BB\u30B9",h);case 34:return vA(s,3792,3801,!0,n);case 37:return vA(s,6160,6169,!0,n);case 38:return vA(s,4160,4169,!0,n);case 39:return vA(s,2918,2927,!0,n);case 40:return vA(s,1776,1785,!0,n);case 43:return vA(s,3046,3055,!0,n);case 44:return vA(s,3174,3183,!0,n);case 45:return vA(s,3664,3673,!0,n);case 46:return vA(s,3872,3881,!0,n);case 3:default:return vA(s,48,57,!0,n)}},Za="data-html2canvas-ignore",za=function(){function s(i,a,n){if(this.context=i,this.options=n,this.scrolledElements=[],this.referenceElement=a,this.counters=new kd,this.quoteDepth=0,!a.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(a.ownerDocument.documentElement,!1)}return s.prototype.toIFrame=function(i,a){var n=this,h=Nd(i,a);if(!h.contentWindow)return Promise.reject("Unable to find iframe window");var p=i.defaultView.pageXOffset,B=i.defaultView.pageYOffset,C=h.contentWindow,w=C.document,U=Xd(h).then(function(){return t(n,void 0,void 0,function(){var S,I;return r(this,function(b){switch(b.label){case 0:return this.scrolledElements.forEach($d),C&&(C.scrollTo(a.left,a.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(C.scrollY!==a.top||C.scrollX!==a.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(C.scrollX-a.left,C.scrollY-a.top,0,0))),S=this.options.onclone,I=this.clonedReferenceElement,typeof I=="undefined"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:w.fonts&&w.fonts.ready?[4,w.fonts.ready]:[3,2];case 1:b.sent(),b.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,_d(w)]:[3,4];case 3:b.sent(),b.label=4;case 4:return typeof S=="function"?[2,Promise.resolve().then(function(){return S(w,I)}).then(function(){return h})]:[2,h]}})})});return w.open(),w.write(Wd(document.doctype)+"<html></html>"),Yd(this.referenceElement.ownerDocument,p,B),w.replaceChild(w.adoptNode(this.documentElement),w.documentElement),w.close(),U},s.prototype.createElementClone=function(i){if(Fr(i,2))debugger;if(ka(i))return this.createCanvasClone(i);if(Ga(i))return this.createVideoClone(i);if(Na(i))return this.createStyleClone(i);var a=i.cloneNode(!1);return Rr(a)&&(Rr(i)&&i.currentSrc&&i.currentSrc!==i.src&&(a.src=i.currentSrc,a.srcset=""),a.loading==="lazy"&&(a.loading="eager")),_a(a)?this.createCustomElementClone(a):a},s.prototype.createCustomElementClone=function(i){var a=document.createElement("html2canvascustomelement");return Gr(i.style,a),a},s.prototype.createStyleClone=function(i){try{var a=i.sheet;if(a&&a.cssRules){var n=[].slice.call(a.cssRules,0).reduce(function(p,B){return B&&typeof B.cssText=="string"?p+B.cssText:p},""),h=i.cloneNode(!1);return h.textContent=n,h}}catch(p){if(this.context.logger.error("Unable to access cssRules property",p),p.name!=="SecurityError")throw p}return i.cloneNode(!1)},s.prototype.createCanvasClone=function(i){var a;if(this.options.inlineImages&&i.ownerDocument){var n=i.ownerDocument.createElement("img");try{return n.src=i.toDataURL(),n}catch(U){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",i)}}var h=i.cloneNode(!1);try{h.width=i.width,h.height=i.height;var p=i.getContext("2d"),B=h.getContext("2d");if(B)if(!this.options.allowTaint&&p)B.putImageData(p.getImageData(0,0,i.width,i.height),0,0);else{var C=(a=i.getContext("webgl2"))!==null&&a!==void 0?a:i.getContext("webgl");if(C){var w=C.getContextAttributes();(w==null?void 0:w.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",i)}B.drawImage(i,0,0)}return h}catch(U){this.context.logger.info("Unable to clone canvas as it is tainted",i)}return h},s.prototype.createVideoClone=function(i){var a=i.ownerDocument.createElement("canvas");a.width=i.offsetWidth,a.height=i.offsetHeight;var n=a.getContext("2d");try{return n&&(n.drawImage(i,0,0,a.width,a.height),this.options.allowTaint||n.getImageData(0,0,a.width,a.height)),a}catch(p){this.context.logger.info("Unable to clone video as it is tainted",i)}var h=i.ownerDocument.createElement("canvas");return h.width=i.offsetWidth,h.height=i.offsetHeight,h},s.prototype.appendChildNode=function(i,a,n){(!mt(a)||!Rd(a)&&!a.hasAttribute(Za)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(a)))&&(!this.options.copyStyles||!mt(a)||!Na(a))&&i.appendChild(this.cloneNode(a,n))},s.prototype.cloneChildNodes=function(i,a,n){for(var h=this,p=i.shadowRoot?i.shadowRoot.firstChild:i.firstChild;p;p=p.nextSibling)if(mt(p)&&Va(p)&&typeof p.assignedNodes=="function"){var B=p.assignedNodes();B.length&&B.forEach(function(C){return h.appendChildNode(a,C,n)})}else this.appendChildNode(a,p,n)},s.prototype.cloneNode=function(i,a){if(Ka(i))return document.createTextNode(i.data);if(!i.ownerDocument)return i.cloneNode(!1);var n=i.ownerDocument.defaultView;if(n&&mt(i)&&(Pr(i)||$i(i))){var h=this.createElementClone(i);h.style.transitionProperty="none";var p=n.getComputedStyle(i),B=n.getComputedStyle(i,":before"),C=n.getComputedStyle(i,":after");this.referenceElement===i&&Pr(h)&&(this.clonedReferenceElement=h),Kr(h)&&zd(h);var w=this.counters.parse(new da(this.context,p)),U=this.resolvePseudoContent(i,h,B,Ai.BEFORE);_a(i)&&(a=!0),Ga(i)||this.cloneChildNodes(i,h,a),U&&h.insertBefore(U,h.firstChild);var S=this.resolvePseudoContent(i,h,C,Ai.AFTER);return S&&h.appendChild(S),this.counters.pop(w),(p&&(this.options.copyStyles||$i(i))&&!Oa(i)||a)&&Gr(p,h),(i.scrollTop!==0||i.scrollLeft!==0)&&this.scrolledElements.push([h,i.scrollLeft,i.scrollTop]),(qi(i)||Zi(i))&&(qi(h)||Zi(h))&&(h.value=i.value),h}return i.cloneNode(!1)},s.prototype.resolvePseudoContent=function(i,a,n,h){var p=this;if(n){var B=n.content,C=a.ownerDocument;if(!(!C||!B||B==="none"||B==="-moz-alt-content"||n.display==="none")){this.counters.parse(new da(this.context,n));var w=new Th(this.context,n),U=C.createElement("html2canvaspseudoelement");Gr(n,U),w.content.forEach(function(I){if(I.type===0)U.appendChild(C.createTextNode(I.value));else if(I.type===22){var b=C.createElement("img");b.src=I.value,b.style.opacity="1",U.appendChild(b)}else if(I.type===18){if(I.name==="attr"){var G=I.values.filter(hA);G.length&&U.appendChild(C.createTextNode(i.getAttribute(G[0].value)||""))}else if(I.name==="counter"){var L=I.values.filter(pt),P=L[0],q=L[1];if(P&&hA(P)){var _=p.counters.getCounterValue(P.value),V=q&&hA(q)?vr.parse(p.context,q.value):3;U.appendChild(C.createTextNode(jt(_,V,!1)))}}else if(I.name==="counters"){var oA=I.values.filter(pt),P=oA[0],Z=oA[1],q=oA[2];if(P&&hA(P)){var W=p.counters.getCounterValues(P.value),k=q&&hA(q)?vr.parse(p.context,q.value):3,sA=Z&&Z.type===0?Z.value:"",rA=W.map(function(Ae){return jt(Ae,k,!1)}).join(sA);U.appendChild(C.createTextNode(rA))}}}else if(I.type===20)switch(I.value){case"open-quote":U.appendChild(C.createTextNode(ha(w.quotes,p.quoteDepth++,!0)));break;case"close-quote":U.appendChild(C.createTextNode(ha(w.quotes,--p.quoteDepth,!1)));break;default:U.appendChild(C.createTextNode(I.value))}}),U.className=Or+" "+Nr;var S=h===Ai.BEFORE?" "+Or:" "+Nr;return $i(a)?a.className.baseValue+=S:a.className+=S,U}}},s.destroy=function(i){return i.parentNode?(i.parentNode.removeChild(i),!0):!1},s}(),Ai;(function(s){s[s.BEFORE=0]="BEFORE",s[s.AFTER=1]="AFTER"})(Ai||(Ai={}));var Nd=function(s,i){var a=s.createElement("iframe");return a.className="html2canvas-container",a.style.visibility="hidden",a.style.position="fixed",a.style.left="-10000px",a.style.top="0px",a.style.border="0",a.width=i.width.toString(),a.height=i.height.toString(),a.scrolling="no",a.setAttribute(Za,"true"),s.body.appendChild(a),a},Vd=function(s){return new Promise(function(i){if(s.complete){i();return}if(!s.src){i();return}s.onload=i,s.onerror=i})},_d=function(s){return Promise.all([].slice.call(s.images,0).map(Vd))},Xd=function(s){return new Promise(function(i,a){var n=s.contentWindow;if(!n)return a("No window assigned for iframe");var h=n.document;n.onload=s.onload=function(){n.onload=s.onload=null;var p=setInterval(function(){h.body.childNodes.length>0&&h.readyState==="complete"&&(clearInterval(p),i(s))},50)}})},Jd=["all","d","content"],Gr=function(s,i){for(var a=s.length-1;a>=0;a--){var n=s.item(a);Jd.indexOf(n)===-1&&i.style.setProperty(n,s.getPropertyValue(n))}return i},Wd=function(s){var i="";return s&&(i+="<!DOCTYPE ",s.name&&(i+=s.name),s.internalSubset&&(i+=s.internalSubset),s.publicId&&(i+='"'+s.publicId+'"'),s.systemId&&(i+='"'+s.systemId+'"'),i+=">"),i},Yd=function(s,i,a){s&&s.defaultView&&(i!==s.defaultView.pageXOffset||a!==s.defaultView.pageYOffset)&&s.defaultView.scrollTo(i,a)},$d=function(s){var i=s[0],a=s[1],n=s[2];i.scrollLeft=a,i.scrollTop=n},qd=":before",Zd=":after",Or="___html2canvas___pseudoelement_before",Nr="___html2canvas___pseudoelement_after",ja=`{
    content: "" !important;
    display: none !important;
}`,zd=function(s){jd(s,"."+Or+qd+ja+`
         .`+Nr+Zd+ja)},jd=function(s,i){var a=s.ownerDocument;if(a){var n=a.createElement("style");n.textContent=i,s.appendChild(n)}},Ao=function(){function s(){}return s.getOrigin=function(i){var a=s._link;return a?(a.href=i,a.href=a.href,a.protocol+a.hostname+a.port):"about:blank"},s.isSameOrigin=function(i){return s.getOrigin(i)===s._origin},s.setContext=function(i){s._link=i.document.createElement("a"),s._origin=s.getOrigin(i.location.href)},s._origin="about:blank",s}(),Ag=function(){function s(i,a){this.context=i,this._options=a,this._cache={}}return s.prototype.addImage=function(i){var a=Promise.resolve();return this.has(i)||(_r(i)||sg(i))&&(this._cache[i]=this.loadImage(i)).catch(function(){}),a},s.prototype.match=function(i){return this._cache[i]},s.prototype.loadImage=function(i){return t(this,void 0,void 0,function(){var a,n,h,p,B=this;return r(this,function(C){switch(C.label){case 0:return a=Ao.isSameOrigin(i),n=!Vr(i)&&this._options.useCORS===!0&&GA.SUPPORT_CORS_IMAGES&&!a,h=!Vr(i)&&!a&&!_r(i)&&typeof this._options.proxy=="string"&&GA.SUPPORT_CORS_XHR&&!n,!a&&this._options.allowTaint===!1&&!Vr(i)&&!_r(i)&&!h&&!n?[2]:(p=i,h?[4,this.proxy(p)]:[3,2]);case 1:p=C.sent(),C.label=2;case 2:return this.context.logger.debug("Added image "+i.substring(0,256)),[4,new Promise(function(w,U){var S=new Image;S.onload=function(){return w(S)},S.onerror=U,(rg(p)||n)&&(S.crossOrigin="anonymous"),S.src=p,S.complete===!0&&setTimeout(function(){return w(S)},500),B._options.imageTimeout>0&&setTimeout(function(){return U("Timed out ("+B._options.imageTimeout+"ms) loading image")},B._options.imageTimeout)})];case 3:return[2,C.sent()]}})})},s.prototype.has=function(i){return typeof this._cache[i]!="undefined"},s.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},s.prototype.proxy=function(i){var a=this,n=this._options.proxy;if(!n)throw new Error("No proxy defined");var h=i.substring(0,256);return new Promise(function(p,B){var C=GA.SUPPORT_RESPONSE_TYPE?"blob":"text",w=new XMLHttpRequest;w.onload=function(){if(w.status===200)if(C==="text")p(w.response);else{var I=new FileReader;I.addEventListener("load",function(){return p(I.result)},!1),I.addEventListener("error",function(b){return B(b)},!1),I.readAsDataURL(w.response)}else B("Failed to proxy resource "+h+" with status code "+w.status)},w.onerror=B;var U=n.indexOf("?")>-1?"&":"?";if(w.open("GET",""+n+U+"url="+encodeURIComponent(i)+"&responseType="+C),C!=="text"&&w instanceof XMLHttpRequest&&(w.responseType=C),a._options.imageTimeout){var S=a._options.imageTimeout;w.timeout=S,w.ontimeout=function(){return B("Timed out ("+S+"ms) proxying "+h)}}w.send()})},s}(),eg=/^data:image\/svg\+xml/i,tg=/^data:image\/.*;base64,/i,ig=/^data:image\/.*/i,sg=function(s){return GA.SUPPORT_SVG_DRAWING||!ng(s)},Vr=function(s){return ig.test(s)},rg=function(s){return tg.test(s)},_r=function(s){return s.substr(0,4)==="blob"},ng=function(s){return s.substr(-3).toLowerCase()==="svg"||eg.test(s)},K=function(){function s(i,a){this.type=0,this.x=i,this.y=a}return s.prototype.add=function(i,a){return new s(this.x+i,this.y+a)},s}(),Ct=function(s,i,a){return new K(s.x+(i.x-s.x)*a,s.y+(i.y-s.y)*a)},zi=function(){function s(i,a,n,h){this.type=1,this.start=i,this.startControl=a,this.endControl=n,this.end=h}return s.prototype.subdivide=function(i,a){var n=Ct(this.start,this.startControl,i),h=Ct(this.startControl,this.endControl,i),p=Ct(this.endControl,this.end,i),B=Ct(n,h,i),C=Ct(h,p,i),w=Ct(B,C,i);return a?new s(this.start,n,B,w):new s(w,C,p,this.end)},s.prototype.add=function(i,a){return new s(this.start.add(i,a),this.startControl.add(i,a),this.endControl.add(i,a),this.end.add(i,a))},s.prototype.reverse=function(){return new s(this.end,this.endControl,this.startControl,this.start)},s}(),de=function(s){return s.type===1},ag=function(){function s(i){var a=i.styles,n=i.bounds,h=Wt(a.borderTopLeftRadius,n.width,n.height),p=h[0],B=h[1],C=Wt(a.borderTopRightRadius,n.width,n.height),w=C[0],U=C[1],S=Wt(a.borderBottomRightRadius,n.width,n.height),I=S[0],b=S[1],G=Wt(a.borderBottomLeftRadius,n.width,n.height),L=G[0],P=G[1],q=[];q.push((p+w)/n.width),q.push((L+I)/n.width),q.push((B+P)/n.height),q.push((U+b)/n.height);var _=Math.max.apply(Math,q);_>1&&(p/=_,B/=_,w/=_,U/=_,I/=_,b/=_,L/=_,P/=_);var V=n.width-w,oA=n.height-b,Z=n.width-I,W=n.height-P,k=a.borderTopWidth,sA=a.borderRightWidth,rA=a.borderBottomWidth,Y=a.borderLeftWidth,yA=uA(a.paddingTop,i.bounds.width),Ae=uA(a.paddingRight,i.bounds.width),ae=uA(a.paddingBottom,i.bounds.width),dA=uA(a.paddingLeft,i.bounds.width);this.topLeftBorderDoubleOuterBox=p>0||B>0?fA(n.left+Y/3,n.top+k/3,p-Y/3,B-k/3,lA.TOP_LEFT):new K(n.left+Y/3,n.top+k/3),this.topRightBorderDoubleOuterBox=p>0||B>0?fA(n.left+V,n.top+k/3,w-sA/3,U-k/3,lA.TOP_RIGHT):new K(n.left+n.width-sA/3,n.top+k/3),this.bottomRightBorderDoubleOuterBox=I>0||b>0?fA(n.left+Z,n.top+oA,I-sA/3,b-rA/3,lA.BOTTOM_RIGHT):new K(n.left+n.width-sA/3,n.top+n.height-rA/3),this.bottomLeftBorderDoubleOuterBox=L>0||P>0?fA(n.left+Y/3,n.top+W,L-Y/3,P-rA/3,lA.BOTTOM_LEFT):new K(n.left+Y/3,n.top+n.height-rA/3),this.topLeftBorderDoubleInnerBox=p>0||B>0?fA(n.left+Y*2/3,n.top+k*2/3,p-Y*2/3,B-k*2/3,lA.TOP_LEFT):new K(n.left+Y*2/3,n.top+k*2/3),this.topRightBorderDoubleInnerBox=p>0||B>0?fA(n.left+V,n.top+k*2/3,w-sA*2/3,U-k*2/3,lA.TOP_RIGHT):new K(n.left+n.width-sA*2/3,n.top+k*2/3),this.bottomRightBorderDoubleInnerBox=I>0||b>0?fA(n.left+Z,n.top+oA,I-sA*2/3,b-rA*2/3,lA.BOTTOM_RIGHT):new K(n.left+n.width-sA*2/3,n.top+n.height-rA*2/3),this.bottomLeftBorderDoubleInnerBox=L>0||P>0?fA(n.left+Y*2/3,n.top+W,L-Y*2/3,P-rA*2/3,lA.BOTTOM_LEFT):new K(n.left+Y*2/3,n.top+n.height-rA*2/3),this.topLeftBorderStroke=p>0||B>0?fA(n.left+Y/2,n.top+k/2,p-Y/2,B-k/2,lA.TOP_LEFT):new K(n.left+Y/2,n.top+k/2),this.topRightBorderStroke=p>0||B>0?fA(n.left+V,n.top+k/2,w-sA/2,U-k/2,lA.TOP_RIGHT):new K(n.left+n.width-sA/2,n.top+k/2),this.bottomRightBorderStroke=I>0||b>0?fA(n.left+Z,n.top+oA,I-sA/2,b-rA/2,lA.BOTTOM_RIGHT):new K(n.left+n.width-sA/2,n.top+n.height-rA/2),this.bottomLeftBorderStroke=L>0||P>0?fA(n.left+Y/2,n.top+W,L-Y/2,P-rA/2,lA.BOTTOM_LEFT):new K(n.left+Y/2,n.top+n.height-rA/2),this.topLeftBorderBox=p>0||B>0?fA(n.left,n.top,p,B,lA.TOP_LEFT):new K(n.left,n.top),this.topRightBorderBox=w>0||U>0?fA(n.left+V,n.top,w,U,lA.TOP_RIGHT):new K(n.left+n.width,n.top),this.bottomRightBorderBox=I>0||b>0?fA(n.left+Z,n.top+oA,I,b,lA.BOTTOM_RIGHT):new K(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=L>0||P>0?fA(n.left,n.top+W,L,P,lA.BOTTOM_LEFT):new K(n.left,n.top+n.height),this.topLeftPaddingBox=p>0||B>0?fA(n.left+Y,n.top+k,Math.max(0,p-Y),Math.max(0,B-k),lA.TOP_LEFT):new K(n.left+Y,n.top+k),this.topRightPaddingBox=w>0||U>0?fA(n.left+Math.min(V,n.width-sA),n.top+k,V>n.width+sA?0:Math.max(0,w-sA),Math.max(0,U-k),lA.TOP_RIGHT):new K(n.left+n.width-sA,n.top+k),this.bottomRightPaddingBox=I>0||b>0?fA(n.left+Math.min(Z,n.width-Y),n.top+Math.min(oA,n.height-rA),Math.max(0,I-sA),Math.max(0,b-rA),lA.BOTTOM_RIGHT):new K(n.left+n.width-sA,n.top+n.height-rA),this.bottomLeftPaddingBox=L>0||P>0?fA(n.left+Y,n.top+Math.min(W,n.height-rA),Math.max(0,L-Y),Math.max(0,P-rA),lA.BOTTOM_LEFT):new K(n.left+Y,n.top+n.height-rA),this.topLeftContentBox=p>0||B>0?fA(n.left+Y+dA,n.top+k+yA,Math.max(0,p-(Y+dA)),Math.max(0,B-(k+yA)),lA.TOP_LEFT):new K(n.left+Y+dA,n.top+k+yA),this.topRightContentBox=w>0||U>0?fA(n.left+Math.min(V,n.width+Y+dA),n.top+k+yA,V>n.width+Y+dA?0:w-Y+dA,U-(k+yA),lA.TOP_RIGHT):new K(n.left+n.width-(sA+Ae),n.top+k+yA),this.bottomRightContentBox=I>0||b>0?fA(n.left+Math.min(Z,n.width-(Y+dA)),n.top+Math.min(oA,n.height+k+yA),Math.max(0,I-(sA+Ae)),b-(rA+ae),lA.BOTTOM_RIGHT):new K(n.left+n.width-(sA+Ae),n.top+n.height-(rA+ae)),this.bottomLeftContentBox=L>0||P>0?fA(n.left+Y+dA,n.top+W,Math.max(0,L-(Y+dA)),P-(rA+ae),lA.BOTTOM_LEFT):new K(n.left+Y+dA,n.top+n.height-(rA+ae))}return s}(),lA;(function(s){s[s.TOP_LEFT=0]="TOP_LEFT",s[s.TOP_RIGHT=1]="TOP_RIGHT",s[s.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",s[s.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(lA||(lA={}));var fA=function(s,i,a,n,h){var p=4*((Math.sqrt(2)-1)/3),B=a*p,C=n*p,w=s+a,U=i+n;switch(h){case lA.TOP_LEFT:return new zi(new K(s,U),new K(s,U-C),new K(w-B,i),new K(w,i));case lA.TOP_RIGHT:return new zi(new K(s,i),new K(s+B,i),new K(w,U-C),new K(w,U));case lA.BOTTOM_RIGHT:return new zi(new K(w,i),new K(w,i+C),new K(s+B,U),new K(s,U));case lA.BOTTOM_LEFT:default:return new zi(new K(w,U),new K(w-B,U),new K(s,i+C),new K(s,i))}},ji=function(s){return[s.topLeftBorderBox,s.topRightBorderBox,s.bottomRightBorderBox,s.bottomLeftBorderBox]},og=function(s){return[s.topLeftContentBox,s.topRightContentBox,s.bottomRightContentBox,s.bottomLeftContentBox]},As=function(s){return[s.topLeftPaddingBox,s.topRightPaddingBox,s.bottomRightPaddingBox,s.bottomLeftPaddingBox]},lg=function(){function s(i,a,n){this.offsetX=i,this.offsetY=a,this.matrix=n,this.type=0,this.target=6}return s}(),es=function(){function s(i,a){this.path=i,this.target=a,this.type=1}return s}(),cg=function(){function s(i){this.opacity=i,this.type=2,this.target=6}return s}(),hg=function(s){return s.type===0},eo=function(s){return s.type===1},dg=function(s){return s.type===2},to=function(s,i){return s.length===i.length?s.some(function(a,n){return a===i[n]}):!1},gg=function(s,i,a,n,h){return s.map(function(p,B){switch(B){case 0:return p.add(i,a);case 1:return p.add(i+n,a);case 2:return p.add(i+n,a+h);case 3:return p.add(i,a+h)}return p})},io=function(){function s(i){this.element=i,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return s}(),so=function(){function s(i,a){if(this.container=i,this.parent=a,this.effects=[],this.curves=new ag(this.container),this.container.styles.opacity<1&&this.effects.push(new cg(this.container.styles.opacity)),this.container.styles.transform!==null){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,h=this.container.bounds.top+this.container.styles.transformOrigin[1].number,p=this.container.styles.transform;this.effects.push(new lg(n,h,p))}if(this.container.styles.overflowX!==0){var B=ji(this.curves),C=As(this.curves);to(B,C)?this.effects.push(new es(B,6)):(this.effects.push(new es(B,2)),this.effects.push(new es(C,4)))}}return s.prototype.getEffects=function(i){for(var a=[2,3].indexOf(this.container.styles.position)===-1,n=this.parent,h=this.effects.slice(0);n;){var p=n.effects.filter(function(w){return!eo(w)});if(a||n.container.styles.position!==0||!n.parent){if(h.unshift.apply(h,p),a=[2,3].indexOf(n.container.styles.position)===-1,n.container.styles.overflowX!==0){var B=ji(n.curves),C=As(n.curves);to(B,C)||h.unshift(new es(C,6))}}else h.unshift.apply(h,p);n=n.parent}return h.filter(function(w){return bA(w.target,i)})},s}(),Xr=function(s,i,a,n){s.container.elements.forEach(function(h){var p=bA(h.flags,4),B=bA(h.flags,2),C=new so(h,s);bA(h.styles.display,2048)&&n.push(C);var w=bA(h.flags,8)?[]:n;if(p||B){var U=p||h.styles.isPositioned()?a:i,S=new io(C);if(h.styles.isPositioned()||h.styles.opacity<1||h.styles.isTransformed()){var I=h.styles.zIndex.order;if(I<0){var b=0;U.negativeZIndex.some(function(L,P){return I>L.element.container.styles.zIndex.order?(b=P,!1):b>0}),U.negativeZIndex.splice(b,0,S)}else if(I>0){var G=0;U.positiveZIndex.some(function(L,P){return I>=L.element.container.styles.zIndex.order?(G=P+1,!1):G>0}),U.positiveZIndex.splice(G,0,S)}else U.zeroOrAutoZIndexOrTransformedOrOpacity.push(S)}else h.styles.isFloating()?U.nonPositionedFloats.push(S):U.nonPositionedInlineLevel.push(S);Xr(C,S,p?S:a,w)}else h.styles.isInlineLevel()?i.inlineLevel.push(C):i.nonInlineLevel.push(C),Xr(C,i,a,w);bA(h.flags,8)&&ro(h,w)})},ro=function(s,i){for(var a=s instanceof Tr?s.start:1,n=s instanceof Tr?s.reversed:!1,h=0;h<i.length;h++){var p=i[h];p.container instanceof ba&&typeof p.container.value=="number"&&p.container.value!==0&&(a=p.container.value),p.listValue=jt(a,p.container.styles.listStyleType,!0),a+=n?-1:1}},ug=function(s){var i=new so(s,null),a=new io(i),n=[];return Xr(i,a,a,n),ro(i.container,n),a},no=function(s,i){switch(i){case 0:return ge(s.topLeftBorderBox,s.topLeftPaddingBox,s.topRightBorderBox,s.topRightPaddingBox);case 1:return ge(s.topRightBorderBox,s.topRightPaddingBox,s.bottomRightBorderBox,s.bottomRightPaddingBox);case 2:return ge(s.bottomRightBorderBox,s.bottomRightPaddingBox,s.bottomLeftBorderBox,s.bottomLeftPaddingBox);case 3:default:return ge(s.bottomLeftBorderBox,s.bottomLeftPaddingBox,s.topLeftBorderBox,s.topLeftPaddingBox)}},pg=function(s,i){switch(i){case 0:return ge(s.topLeftBorderBox,s.topLeftBorderDoubleOuterBox,s.topRightBorderBox,s.topRightBorderDoubleOuterBox);case 1:return ge(s.topRightBorderBox,s.topRightBorderDoubleOuterBox,s.bottomRightBorderBox,s.bottomRightBorderDoubleOuterBox);case 2:return ge(s.bottomRightBorderBox,s.bottomRightBorderDoubleOuterBox,s.bottomLeftBorderBox,s.bottomLeftBorderDoubleOuterBox);case 3:default:return ge(s.bottomLeftBorderBox,s.bottomLeftBorderDoubleOuterBox,s.topLeftBorderBox,s.topLeftBorderDoubleOuterBox)}},fg=function(s,i){switch(i){case 0:return ge(s.topLeftBorderDoubleInnerBox,s.topLeftPaddingBox,s.topRightBorderDoubleInnerBox,s.topRightPaddingBox);case 1:return ge(s.topRightBorderDoubleInnerBox,s.topRightPaddingBox,s.bottomRightBorderDoubleInnerBox,s.bottomRightPaddingBox);case 2:return ge(s.bottomRightBorderDoubleInnerBox,s.bottomRightPaddingBox,s.bottomLeftBorderDoubleInnerBox,s.bottomLeftPaddingBox);case 3:default:return ge(s.bottomLeftBorderDoubleInnerBox,s.bottomLeftPaddingBox,s.topLeftBorderDoubleInnerBox,s.topLeftPaddingBox)}},mg=function(s,i){switch(i){case 0:return ts(s.topLeftBorderStroke,s.topRightBorderStroke);case 1:return ts(s.topRightBorderStroke,s.bottomRightBorderStroke);case 2:return ts(s.bottomRightBorderStroke,s.bottomLeftBorderStroke);case 3:default:return ts(s.bottomLeftBorderStroke,s.topLeftBorderStroke)}},ts=function(s,i){var a=[];return de(s)?a.push(s.subdivide(.5,!1)):a.push(s),de(i)?a.push(i.subdivide(.5,!0)):a.push(i),a},ge=function(s,i,a,n){var h=[];return de(s)?h.push(s.subdivide(.5,!1)):h.push(s),de(a)?h.push(a.subdivide(.5,!0)):h.push(a),de(n)?h.push(n.subdivide(.5,!0).reverse()):h.push(n),de(i)?h.push(i.subdivide(.5,!1).reverse()):h.push(i),h},ao=function(s){var i=s.bounds,a=s.styles;return i.add(a.borderLeftWidth,a.borderTopWidth,-(a.borderRightWidth+a.borderLeftWidth),-(a.borderTopWidth+a.borderBottomWidth))},is=function(s){var i=s.styles,a=s.bounds,n=uA(i.paddingLeft,a.width),h=uA(i.paddingRight,a.width),p=uA(i.paddingTop,a.width),B=uA(i.paddingBottom,a.width);return a.add(n+i.borderLeftWidth,p+i.borderTopWidth,-(i.borderRightWidth+i.borderLeftWidth+n+h),-(i.borderTopWidth+i.borderBottomWidth+p+B))},Bg=function(s,i){return s===0?i.bounds:s===2?is(i):ao(i)},wg=function(s,i){return s===0?i.bounds:s===2?is(i):ao(i)},Jr=function(s,i,a){var n=Bg(Ft(s.styles.backgroundOrigin,i),s),h=wg(Ft(s.styles.backgroundClip,i),s),p=Cg(Ft(s.styles.backgroundSize,i),a,n),B=p[0],C=p[1],w=Wt(Ft(s.styles.backgroundPosition,i),n.width-B,n.height-C),U=vg(Ft(s.styles.backgroundRepeat,i),w,p,n,h),S=Math.round(n.left+w[0]),I=Math.round(n.top+w[1]);return[U,S,I,B,C]},vt=function(s){return hA(s)&&s.value===ft.AUTO},ss=function(s){return typeof s=="number"},Cg=function(s,i,a){var n=i[0],h=i[1],p=i[2],B=s[0],C=s[1];if(!B)return[0,0];if(QA(B)&&C&&QA(C))return[uA(B,a.width),uA(C,a.height)];var w=ss(p);if(hA(B)&&(B.value===ft.CONTAIN||B.value===ft.COVER)){if(ss(p)){var U=a.width/a.height;return U<p!=(B.value===ft.COVER)?[a.width,a.width/p]:[a.height*p,a.height]}return[a.width,a.height]}var S=ss(n),I=ss(h),b=S||I;if(vt(B)&&(!C||vt(C))){if(S&&I)return[n,h];if(!w&&!b)return[a.width,a.height];if(b&&w){var G=S?n:h*p,L=I?h:n/p;return[G,L]}var P=S?n:a.width,q=I?h:a.height;return[P,q]}if(w){var _=0,V=0;return QA(B)?_=uA(B,a.width):QA(C)&&(V=uA(C,a.height)),vt(B)?_=V*p:(!C||vt(C))&&(V=_/p),[_,V]}var oA=null,Z=null;if(QA(B)?oA=uA(B,a.width):C&&QA(C)&&(Z=uA(C,a.height)),oA!==null&&(!C||vt(C))&&(Z=S&&I?oA/n*h:a.height),Z!==null&&vt(B)&&(oA=S&&I?Z/h*n:a.width),oA!==null&&Z!==null)return[oA,Z];throw new Error("Unable to calculate background-size for element")},Ft=function(s,i){var a=s[i];return typeof a=="undefined"?s[0]:a},vg=function(s,i,a,n,h){var p=i[0],B=i[1],C=a[0],w=a[1];switch(s){case 2:return[new K(Math.round(n.left),Math.round(n.top+B)),new K(Math.round(n.left+n.width),Math.round(n.top+B)),new K(Math.round(n.left+n.width),Math.round(w+n.top+B)),new K(Math.round(n.left),Math.round(w+n.top+B))];case 3:return[new K(Math.round(n.left+p),Math.round(n.top)),new K(Math.round(n.left+p+C),Math.round(n.top)),new K(Math.round(n.left+p+C),Math.round(n.height+n.top)),new K(Math.round(n.left+p),Math.round(n.height+n.top))];case 1:return[new K(Math.round(n.left+p),Math.round(n.top+B)),new K(Math.round(n.left+p+C),Math.round(n.top+B)),new K(Math.round(n.left+p+C),Math.round(n.top+B+w)),new K(Math.round(n.left+p),Math.round(n.top+B+w))];default:return[new K(Math.round(h.left),Math.round(h.top)),new K(Math.round(h.left+h.width),Math.round(h.top)),new K(Math.round(h.left+h.width),Math.round(h.height+h.top)),new K(Math.round(h.left),Math.round(h.height+h.top))]}},Fg="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",oo="Hidden Text",Qg=function(){function s(i){this._data={},this._document=i}return s.prototype.parseMetrics=function(i,a){var n=this._document.createElement("div"),h=this._document.createElement("img"),p=this._document.createElement("span"),B=this._document.body;n.style.visibility="hidden",n.style.fontFamily=i,n.style.fontSize=a,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",B.appendChild(n),h.src=Fg,h.width=1,h.height=1,h.style.margin="0",h.style.padding="0",h.style.verticalAlign="baseline",p.style.fontFamily=i,p.style.fontSize=a,p.style.margin="0",p.style.padding="0",p.appendChild(this._document.createTextNode(oo)),n.appendChild(p),n.appendChild(h);var C=h.offsetTop-p.offsetTop+2;n.removeChild(p),n.appendChild(this._document.createTextNode(oo)),n.style.lineHeight="normal",h.style.verticalAlign="super";var w=h.offsetTop-n.offsetTop+2;return B.removeChild(n),{baseline:C,middle:w}},s.prototype.getMetrics=function(i,a){var n=i+" "+a;return typeof this._data[n]=="undefined"&&(this._data[n]=this.parseMetrics(i,a)),this._data[n]},s}(),lo=function(){function s(i,a){this.context=i,this.options=a}return s}(),yg=1e4,Eg=function(s){e(i,s);function i(a,n){var h=s.call(this,a,n)||this;return h._activeEffects=[],h.canvas=n.canvas?n.canvas:document.createElement("canvas"),h.ctx=h.canvas.getContext("2d"),n.canvas||(h.canvas.width=Math.floor(n.width*n.scale),h.canvas.height=Math.floor(n.height*n.scale),h.canvas.style.width=n.width+"px",h.canvas.style.height=n.height+"px"),h.fontMetrics=new Qg(document),h.ctx.scale(h.options.scale,h.options.scale),h.ctx.translate(-n.x,-n.y),h.ctx.textBaseline="bottom",h._activeEffects=[],h.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),h}return i.prototype.applyEffects=function(a){for(var n=this;this._activeEffects.length;)this.popEffect();a.forEach(function(h){return n.applyEffect(h)})},i.prototype.applyEffect=function(a){this.ctx.save(),dg(a)&&(this.ctx.globalAlpha=a.opacity),hg(a)&&(this.ctx.translate(a.offsetX,a.offsetY),this.ctx.transform(a.matrix[0],a.matrix[1],a.matrix[2],a.matrix[3],a.matrix[4],a.matrix[5]),this.ctx.translate(-a.offsetX,-a.offsetY)),eo(a)&&(this.path(a.path),this.ctx.clip()),this._activeEffects.push(a)},i.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},i.prototype.renderStack=function(a){return t(this,void 0,void 0,function(){var n;return r(this,function(h){switch(h.label){case 0:return n=a.element.container.styles,n.isVisible()?[4,this.renderStackContent(a)]:[3,2];case 1:h.sent(),h.label=2;case 2:return[2]}})})},i.prototype.renderNode=function(a){return t(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:if(bA(a.container.flags,16))debugger;return a.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(a)]:[3,3];case 1:return n.sent(),[4,this.renderNodeContent(a)];case 2:n.sent(),n.label=3;case 3:return[2]}})})},i.prototype.renderTextWithLetterSpacing=function(a,n,h){var p=this;if(n===0)this.ctx.fillText(a.text,a.bounds.left,a.bounds.top+h);else{var B=Lr(a.text);B.reduce(function(C,w){return p.ctx.fillText(w,C,a.bounds.top+h),C+p.ctx.measureText(w).width},a.bounds.left)}},i.prototype.createFontStyle=function(a){var n=a.fontVariant.filter(function(B){return B==="normal"||B==="small-caps"}).join(""),h=bg(a.fontFamily).join(", "),p=Jt(a.fontSize)?""+a.fontSize.number+a.fontSize.unit:a.fontSize.number+"px";return[[a.fontStyle,n,a.fontWeight,p,h].join(" "),h,p]},i.prototype.renderTextNode=function(a,n){return t(this,void 0,void 0,function(){var h,p,B,C,w,U,S,I,b=this;return r(this,function(G){return h=this.createFontStyle(n),p=h[0],B=h[1],C=h[2],this.ctx.font=p,this.ctx.direction=n.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",w=this.fontMetrics.getMetrics(B,C),U=w.baseline,S=w.middle,I=n.paintOrder,a.textBounds.forEach(function(L){I.forEach(function(P){switch(P){case 0:b.ctx.fillStyle=TA(n.color),b.renderTextWithLetterSpacing(L,n.letterSpacing,U);var q=n.textShadow;q.length&&L.text.trim().length&&(q.slice(0).reverse().forEach(function(_){b.ctx.shadowColor=TA(_.color),b.ctx.shadowOffsetX=_.offsetX.number*b.options.scale,b.ctx.shadowOffsetY=_.offsetY.number*b.options.scale,b.ctx.shadowBlur=_.blur.number,b.renderTextWithLetterSpacing(L,n.letterSpacing,U)}),b.ctx.shadowColor="",b.ctx.shadowOffsetX=0,b.ctx.shadowOffsetY=0,b.ctx.shadowBlur=0),n.textDecorationLine.length&&(b.ctx.fillStyle=TA(n.textDecorationColor||n.color),n.textDecorationLine.forEach(function(_){switch(_){case 1:b.ctx.fillRect(L.bounds.left,Math.round(L.bounds.top+U),L.bounds.width,1);break;case 2:b.ctx.fillRect(L.bounds.left,Math.round(L.bounds.top),L.bounds.width,1);break;case 3:b.ctx.fillRect(L.bounds.left,Math.ceil(L.bounds.top+S),L.bounds.width,1);break}}));break;case 1:n.webkitTextStrokeWidth&&L.text.trim().length&&(b.ctx.strokeStyle=TA(n.webkitTextStrokeColor),b.ctx.lineWidth=n.webkitTextStrokeWidth,b.ctx.lineJoin=window.chrome?"miter":"round",b.ctx.strokeText(L.text,L.bounds.left,L.bounds.top+U)),b.ctx.strokeStyle="",b.ctx.lineWidth=0,b.ctx.lineJoin="miter";break}})}),[2]})})},i.prototype.renderReplacedElement=function(a,n,h){if(h&&a.intrinsicWidth>0&&a.intrinsicHeight>0){var p=is(a),B=As(n);this.path(B),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(h,0,0,a.intrinsicWidth,a.intrinsicHeight,p.left,p.top,p.width,p.height),this.ctx.restore()}},i.prototype.renderNodeContent=function(a){return t(this,void 0,void 0,function(){var n,h,p,B,C,w,V,V,U,S,I,b,Z,G,L,W,P,q,_,V,oA,Z,W;return r(this,function(k){switch(k.label){case 0:this.applyEffects(a.getEffects(4)),n=a.container,h=a.curves,p=n.styles,B=0,C=n.textNodes,k.label=1;case 1:return B<C.length?(w=C[B],[4,this.renderTextNode(w,p)]):[3,4];case 2:k.sent(),k.label=3;case 3:return B++,[3,1];case 4:if(!(n instanceof Sa))return[3,8];k.label=5;case 5:return k.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return V=k.sent(),this.renderReplacedElement(n,h,V),[3,8];case 7:return k.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof Ia&&this.renderReplacedElement(n,h,n.canvas),!(n instanceof Ha))return[3,12];k.label=9;case 9:return k.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return V=k.sent(),this.renderReplacedElement(n,h,V),[3,12];case 11:return k.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof Ta&&n.tree?(U=new i(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}),[4,U.render(n.tree)]):[3,14];case 13:S=k.sent(),n.width&&n.height&&this.ctx.drawImage(S,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),k.label=14;case 14:if(n instanceof Dr&&(I=Math.min(n.bounds.width,n.bounds.height),n.type===Ji?n.checked&&(this.ctx.save(),this.path([new K(n.bounds.left+I*.39363,n.bounds.top+I*.79),new K(n.bounds.left+I*.16,n.bounds.top+I*.5549),new K(n.bounds.left+I*.27347,n.bounds.top+I*.44071),new K(n.bounds.left+I*.39694,n.bounds.top+I*.5649),new K(n.bounds.left+I*.72983,n.bounds.top+I*.23),new K(n.bounds.left+I*.84,n.bounds.top+I*.34085),new K(n.bounds.left+I*.39363,n.bounds.top+I*.79)]),this.ctx.fillStyle=TA(xa),this.ctx.fill(),this.ctx.restore()):n.type===Wi&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+I/2,n.bounds.top+I/2,I/4,0,Math.PI*2,!0),this.ctx.fillStyle=TA(xa),this.ctx.fill(),this.ctx.restore())),Ug(n)&&n.value.length){switch(b=this.createFontStyle(p),Z=b[0],G=b[1],L=this.fontMetrics.getMetrics(Z,G).baseline,this.ctx.font=Z,this.ctx.fillStyle=TA(p.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Ig(n.styles.textAlign),W=is(n),P=0,n.styles.textAlign){case 1:P+=W.width/2;break;case 2:P+=W.width;break}q=W.add(P,0,0,-W.height/2+1),this.ctx.save(),this.path([new K(W.left,W.top),new K(W.left+W.width,W.top),new K(W.left+W.width,W.top+W.height),new K(W.left,W.top+W.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Zt(n.value,q),p.letterSpacing,L),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!bA(n.styles.display,2048))return[3,20];if(n.styles.listStyleImage===null)return[3,19];if(_=n.styles.listStyleImage,_.type!==0)return[3,18];V=void 0,oA=_.url,k.label=15;case 15:return k.trys.push([15,17,,18]),[4,this.context.cache.match(oA)];case 16:return V=k.sent(),this.ctx.drawImage(V,n.bounds.left-(V.width+10),n.bounds.top),[3,18];case 17:return k.sent(),this.context.logger.error("Error loading list-style-image "+oA),[3,18];case 18:return[3,20];case 19:a.listValue&&n.styles.listStyleType!==-1&&(Z=this.createFontStyle(p)[0],this.ctx.font=Z,this.ctx.fillStyle=TA(p.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",W=new l(n.bounds.left,n.bounds.top+uA(n.styles.paddingTop,n.bounds.width),n.bounds.width,oa(p.lineHeight,p.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Zt(a.listValue,W),p.letterSpacing,oa(p.lineHeight,p.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),k.label=20;case 20:return[2]}})})},i.prototype.renderStackContent=function(a){return t(this,void 0,void 0,function(){var n,h,_,p,B,_,C,w,_,U,S,_,I,b,_,G,L,_,P,q,_;return r(this,function(V){switch(V.label){case 0:if(bA(a.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(a.element)];case 1:V.sent(),n=0,h=a.negativeZIndex,V.label=2;case 2:return n<h.length?(_=h[n],[4,this.renderStack(_)]):[3,5];case 3:V.sent(),V.label=4;case 4:return n++,[3,2];case 5:return[4,this.renderNodeContent(a.element)];case 6:V.sent(),p=0,B=a.nonInlineLevel,V.label=7;case 7:return p<B.length?(_=B[p],[4,this.renderNode(_)]):[3,10];case 8:V.sent(),V.label=9;case 9:return p++,[3,7];case 10:C=0,w=a.nonPositionedFloats,V.label=11;case 11:return C<w.length?(_=w[C],[4,this.renderStack(_)]):[3,14];case 12:V.sent(),V.label=13;case 13:return C++,[3,11];case 14:U=0,S=a.nonPositionedInlineLevel,V.label=15;case 15:return U<S.length?(_=S[U],[4,this.renderStack(_)]):[3,18];case 16:V.sent(),V.label=17;case 17:return U++,[3,15];case 18:I=0,b=a.inlineLevel,V.label=19;case 19:return I<b.length?(_=b[I],[4,this.renderNode(_)]):[3,22];case 20:V.sent(),V.label=21;case 21:return I++,[3,19];case 22:G=0,L=a.zeroOrAutoZIndexOrTransformedOrOpacity,V.label=23;case 23:return G<L.length?(_=L[G],[4,this.renderStack(_)]):[3,26];case 24:V.sent(),V.label=25;case 25:return G++,[3,23];case 26:P=0,q=a.positiveZIndex,V.label=27;case 27:return P<q.length?(_=q[P],[4,this.renderStack(_)]):[3,30];case 28:V.sent(),V.label=29;case 29:return P++,[3,27];case 30:return[2]}})})},i.prototype.mask=function(a){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(a.slice(0).reverse()),this.ctx.closePath()},i.prototype.path=function(a){this.ctx.beginPath(),this.formatPath(a),this.ctx.closePath()},i.prototype.formatPath=function(a){var n=this;a.forEach(function(h,p){var B=de(h)?h.start:h;p===0?n.ctx.moveTo(B.x,B.y):n.ctx.lineTo(B.x,B.y),de(h)&&n.ctx.bezierCurveTo(h.startControl.x,h.startControl.y,h.endControl.x,h.endControl.y,h.end.x,h.end.y)})},i.prototype.renderRepeat=function(a,n,h,p){this.path(a),this.ctx.fillStyle=n,this.ctx.translate(h,p),this.ctx.fill(),this.ctx.translate(-h,-p)},i.prototype.resizeImage=function(a,n,h){var p;if(a.width===n&&a.height===h)return a;var B=(p=this.canvas.ownerDocument)!==null&&p!==void 0?p:document,C=B.createElement("canvas");C.width=Math.max(1,n),C.height=Math.max(1,h);var w=C.getContext("2d");return w.drawImage(a,0,0,a.width,a.height,0,0,n,h),C},i.prototype.renderBackgroundImage=function(a){return t(this,void 0,void 0,function(){var n,h,p,B,C,w;return r(this,function(U){switch(U.label){case 0:n=a.styles.backgroundImage.length-1,h=function(S){var I,b,G,yA,ee,te,dA,OA,rA,L,yA,ee,te,dA,OA,P,q,_,V,oA,Z,W,k,sA,rA,Y,yA,Ae,ae,dA,OA,We,ee,te,nt,Ee,Ye,at,ot,xe,lt,Me;return r(this,function(Qt){switch(Qt.label){case 0:if(S.type!==0)return[3,5];I=void 0,b=S.url,Qt.label=1;case 1:return Qt.trys.push([1,3,,4]),[4,p.context.cache.match(b)];case 2:return I=Qt.sent(),[3,4];case 3:return Qt.sent(),p.context.logger.error("Error loading background-image "+b),[3,4];case 4:return I&&(G=Jr(a,n,[I.width,I.height,I.width/I.height]),yA=G[0],ee=G[1],te=G[2],dA=G[3],OA=G[4],rA=p.ctx.createPattern(p.resizeImage(I,dA,OA),"repeat"),p.renderRepeat(yA,rA,ee,te)),[3,6];case 5:hc(S)?(L=Jr(a,n,[null,null,null]),yA=L[0],ee=L[1],te=L[2],dA=L[3],OA=L[4],P=nc(S.angle,dA,OA),q=P[0],_=P[1],V=P[2],oA=P[3],Z=P[4],W=document.createElement("canvas"),W.width=dA,W.height=OA,k=W.getContext("2d"),sA=k.createLinearGradient(_,oA,V,Z),Zn(S.stops,q).forEach(function(ei){return sA.addColorStop(ei.stop,TA(ei.color))}),k.fillStyle=sA,k.fillRect(0,0,dA,OA),dA>0&&OA>0&&(rA=p.ctx.createPattern(W,"repeat"),p.renderRepeat(yA,rA,ee,te))):dc(S)&&(Y=Jr(a,n,[null,null,null]),yA=Y[0],Ae=Y[1],ae=Y[2],dA=Y[3],OA=Y[4],We=S.position.length===0?[Br]:S.position,ee=uA(We[0],dA),te=uA(We[We.length-1],OA),nt=ac(S,ee,te,dA,OA),Ee=nt[0],Ye=nt[1],Ee>0&&Ye>0&&(at=p.ctx.createRadialGradient(Ae+ee,ae+te,0,Ae+ee,ae+te,Ee),Zn(S.stops,Ee*2).forEach(function(ei){return at.addColorStop(ei.stop,TA(ei.color))}),p.path(yA),p.ctx.fillStyle=at,Ee!==Ye?(ot=a.bounds.left+.5*a.bounds.width,xe=a.bounds.top+.5*a.bounds.height,lt=Ye/Ee,Me=1/lt,p.ctx.save(),p.ctx.translate(ot,xe),p.ctx.transform(1,0,0,lt,0,0),p.ctx.translate(-ot,-xe),p.ctx.fillRect(Ae,Me*(ae-xe)+xe,dA,OA*Me),p.ctx.restore()):p.ctx.fill())),Qt.label=6;case 6:return n--,[2]}})},p=this,B=0,C=a.styles.backgroundImage.slice(0).reverse(),U.label=1;case 1:return B<C.length?(w=C[B],[5,h(w)]):[3,4];case 2:U.sent(),U.label=3;case 3:return B++,[3,1];case 4:return[2]}})})},i.prototype.renderSolidBorder=function(a,n,h){return t(this,void 0,void 0,function(){return r(this,function(p){return this.path(no(h,n)),this.ctx.fillStyle=TA(a),this.ctx.fill(),[2]})})},i.prototype.renderDoubleBorder=function(a,n,h,p){return t(this,void 0,void 0,function(){var B,C;return r(this,function(w){switch(w.label){case 0:return n<3?[4,this.renderSolidBorder(a,h,p)]:[3,2];case 1:return w.sent(),[2];case 2:return B=pg(p,h),this.path(B),this.ctx.fillStyle=TA(a),this.ctx.fill(),C=fg(p,h),this.path(C),this.ctx.fill(),[2]}})})},i.prototype.renderNodeBackgroundAndBorders=function(a){return t(this,void 0,void 0,function(){var n,h,p,B,C,w,U,S,I=this;return r(this,function(b){switch(b.label){case 0:return this.applyEffects(a.getEffects(2)),n=a.container.styles,h=!Ve(n.backgroundColor)||n.backgroundImage.length,p=[{style:n.borderTopStyle,color:n.borderTopColor,width:n.borderTopWidth},{style:n.borderRightStyle,color:n.borderRightColor,width:n.borderRightWidth},{style:n.borderBottomStyle,color:n.borderBottomColor,width:n.borderBottomWidth},{style:n.borderLeftStyle,color:n.borderLeftColor,width:n.borderLeftWidth}],B=Sg(Ft(n.backgroundClip,0),a.curves),h||n.boxShadow.length?(this.ctx.save(),this.path(B),this.ctx.clip(),Ve(n.backgroundColor)||(this.ctx.fillStyle=TA(n.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(a.container)]):[3,2];case 1:b.sent(),this.ctx.restore(),n.boxShadow.slice(0).reverse().forEach(function(G){I.ctx.save();var L=ji(a.curves),P=G.inset?0:yg,q=gg(L,-P+(G.inset?1:-1)*G.spread.number,(G.inset?1:-1)*G.spread.number,G.spread.number*(G.inset?-2:2),G.spread.number*(G.inset?-2:2));G.inset?(I.path(L),I.ctx.clip(),I.mask(q)):(I.mask(L),I.ctx.clip(),I.path(q)),I.ctx.shadowOffsetX=G.offsetX.number+P,I.ctx.shadowOffsetY=G.offsetY.number,I.ctx.shadowColor=TA(G.color),I.ctx.shadowBlur=G.blur.number,I.ctx.fillStyle=G.inset?TA(G.color):"rgba(0,0,0,1)",I.ctx.fill(),I.ctx.restore()}),b.label=2;case 2:C=0,w=0,U=p,b.label=3;case 3:return w<U.length?(S=U[w],S.style!==0&&!Ve(S.color)&&S.width>0?S.style!==2?[3,5]:[4,this.renderDashedDottedBorder(S.color,S.width,C,a.curves,2)]:[3,11]):[3,13];case 4:return b.sent(),[3,11];case 5:return S.style!==3?[3,7]:[4,this.renderDashedDottedBorder(S.color,S.width,C,a.curves,3)];case 6:return b.sent(),[3,11];case 7:return S.style!==4?[3,9]:[4,this.renderDoubleBorder(S.color,S.width,C,a.curves)];case 8:return b.sent(),[3,11];case 9:return[4,this.renderSolidBorder(S.color,C,a.curves)];case 10:b.sent(),b.label=11;case 11:C++,b.label=12;case 12:return w++,[3,3];case 13:return[2]}})})},i.prototype.renderDashedDottedBorder=function(a,n,h,p,B){return t(this,void 0,void 0,function(){var C,w,U,S,I,b,G,L,P,q,_,V,oA,Z,W,k,W,k;return r(this,function(sA){return this.ctx.save(),C=mg(p,h),w=no(p,h),B===2&&(this.path(w),this.ctx.clip()),de(w[0])?(U=w[0].start.x,S=w[0].start.y):(U=w[0].x,S=w[0].y),de(w[1])?(I=w[1].end.x,b=w[1].end.y):(I=w[1].x,b=w[1].y),h===0||h===2?G=Math.abs(U-I):G=Math.abs(S-b),this.ctx.beginPath(),B===3?this.formatPath(C):this.formatPath(w.slice(0,2)),L=n<3?n*3:n*2,P=n<3?n*2:n,B===3&&(L=n,P=n),q=!0,G<=L*2?q=!1:G<=L*2+P?(_=G/(2*L+P),L*=_,P*=_):(V=Math.floor((G+P)/(L+P)),oA=(G-V*L)/(V-1),Z=(G-(V+1)*L)/V,P=Z<=0||Math.abs(P-oA)<Math.abs(P-Z)?oA:Z),q&&(B===3?this.ctx.setLineDash([0,L+P]):this.ctx.setLineDash([L,P])),B===3?(this.ctx.lineCap="round",this.ctx.lineWidth=n):this.ctx.lineWidth=n*2+1.1,this.ctx.strokeStyle=TA(a),this.ctx.stroke(),this.ctx.setLineDash([]),B===2&&(de(w[0])&&(W=w[3],k=w[0],this.ctx.beginPath(),this.formatPath([new K(W.end.x,W.end.y),new K(k.start.x,k.start.y)]),this.ctx.stroke()),de(w[1])&&(W=w[1],k=w[2],this.ctx.beginPath(),this.formatPath([new K(W.end.x,W.end.y),new K(k.start.x,k.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},i.prototype.render=function(a){return t(this,void 0,void 0,function(){var n;return r(this,function(h){switch(h.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=TA(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),n=ug(a),[4,this.renderStack(n)];case 1:return h.sent(),this.applyEffects([]),[2,this.canvas]}})})},i}(lo),Ug=function(s){return s instanceof La||s instanceof Ma?!0:s instanceof Dr&&s.type!==Wi&&s.type!==Ji},Sg=function(s,i){switch(s){case 0:return ji(i);case 2:return og(i);case 1:default:return As(i)}},Ig=function(s){switch(s){case 1:return"center";case 2:return"right";case 0:default:return"left"}},Hg=["-apple-system","system-ui"],bg=function(s){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?s.filter(function(i){return Hg.indexOf(i)===-1}):s},xg=function(s){e(i,s);function i(a,n){var h=s.call(this,a,n)||this;return h.canvas=n.canvas?n.canvas:document.createElement("canvas"),h.ctx=h.canvas.getContext("2d"),h.options=n,h.canvas.width=Math.floor(n.width*n.scale),h.canvas.height=Math.floor(n.height*n.scale),h.canvas.style.width=n.width+"px",h.canvas.style.height=n.height+"px",h.ctx.scale(h.options.scale,h.options.scale),h.ctx.translate(-n.x,-n.y),h.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),h}return i.prototype.render=function(a){return t(this,void 0,void 0,function(){var n,h;return r(this,function(p){switch(p.label){case 0:return n=Mr(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,a),[4,Mg(n)];case 1:return h=p.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=TA(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(h,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},i}(lo),Mg=function(s){return new Promise(function(i,a){var n=new Image;n.onload=function(){i(n)},n.onerror=a,n.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(s))})},Lg=function(){function s(i){var a=i.id,n=i.enabled;this.id=a,this.enabled=n,this.start=Date.now()}return s.prototype.debug=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];this.enabled&&(typeof window!="undefined"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,o([this.id,this.getTime()+"ms"],i)):this.info.apply(this,i))},s.prototype.getTime=function(){return Date.now()-this.start},s.prototype.info=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];this.enabled&&typeof window!="undefined"&&window.console&&typeof console.info=="function"&&console.info.apply(console,o([this.id,this.getTime()+"ms"],i))},s.prototype.warn=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];this.enabled&&(typeof window!="undefined"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,o([this.id,this.getTime()+"ms"],i)):this.info.apply(this,i))},s.prototype.error=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];this.enabled&&(typeof window!="undefined"&&window.console&&typeof console.error=="function"?console.error.apply(console,o([this.id,this.getTime()+"ms"],i)):this.info.apply(this,i))},s.instances={},s}(),Tg=function(){function s(i,a){var n;this.windowBounds=a,this.instanceName="#"+s.instanceCount++,this.logger=new Lg({id:this.instanceName,enabled:i.logging}),this.cache=(n=i.cache)!==null&&n!==void 0?n:new Ag(this,i)}return s.instanceCount=1,s}(),Dg=function(s,i){return i===void 0&&(i={}),Pg(s,i)};typeof window!="undefined"&&Ao.setContext(window);var Pg=function(s,i){return t(void 0,void 0,void 0,function(){var a,n,h,p,B,C,w,U,S,I,b,G,L,P,q,_,V,oA,Z,W,sA,k,sA,rA,Y,yA,Ae,ae,dA,OA,We,ee,te,nt,Ee,Ye,at,ot,xe,lt;return r(this,function(Me){switch(Me.label){case 0:if(!s||typeof s!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(a=s.ownerDocument,!a)throw new Error("Element is not attached to a Document");if(n=a.defaultView,!n)throw new Error("Document is not attached to a Window");return h={allowTaint:(rA=i.allowTaint)!==null&&rA!==void 0?rA:!1,imageTimeout:(Y=i.imageTimeout)!==null&&Y!==void 0?Y:15e3,proxy:i.proxy,useCORS:(yA=i.useCORS)!==null&&yA!==void 0?yA:!1},p=A({logging:(Ae=i.logging)!==null&&Ae!==void 0?Ae:!0,cache:i.cache},h),B={windowWidth:(ae=i.windowWidth)!==null&&ae!==void 0?ae:n.innerWidth,windowHeight:(dA=i.windowHeight)!==null&&dA!==void 0?dA:n.innerHeight,scrollX:(OA=i.scrollX)!==null&&OA!==void 0?OA:n.pageXOffset,scrollY:(We=i.scrollY)!==null&&We!==void 0?We:n.pageYOffset},C=new l(B.scrollX,B.scrollY,B.windowWidth,B.windowHeight),w=new Tg(p,C),U=(ee=i.foreignObjectRendering)!==null&&ee!==void 0?ee:!1,S={allowTaint:(te=i.allowTaint)!==null&&te!==void 0?te:!1,onclone:i.onclone,ignoreElements:i.ignoreElements,inlineImages:U,copyStyles:U},w.logger.debug("Starting document clone with size "+C.width+"x"+C.height+" scrolled to "+-C.left+","+-C.top),I=new za(w,s,S),b=I.clonedReferenceElement,b?[4,I.toIFrame(a,C)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return G=Me.sent(),L=Kr(b)||Kd(b)?d(b.ownerDocument):c(w,b),P=L.width,q=L.height,_=L.left,V=L.top,oA=Kg(w,b,i.backgroundColor),Z={canvas:i.canvas,backgroundColor:oA,scale:(Ee=(nt=i.scale)!==null&&nt!==void 0?nt:n.devicePixelRatio)!==null&&Ee!==void 0?Ee:1,x:((Ye=i.x)!==null&&Ye!==void 0?Ye:0)+_,y:((at=i.y)!==null&&at!==void 0?at:0)+V,width:(ot=i.width)!==null&&ot!==void 0?ot:Math.ceil(P),height:(xe=i.height)!==null&&xe!==void 0?xe:Math.ceil(q)},U?(w.logger.debug("Document cloned, using foreign object rendering"),sA=new xg(w,Z),[4,sA.render(b)]):[3,3];case 2:return W=Me.sent(),[3,5];case 3:return w.logger.debug("Document cloned, element located at "+_+","+V+" with size "+P+"x"+q+" using computed rendering"),w.logger.debug("Starting DOM parsing"),k=Pa(w,b),oA===k.styles.backgroundColor&&(k.styles.backgroundColor=He.TRANSPARENT),w.logger.debug("Starting renderer for element at "+Z.x+","+Z.y+" with size "+Z.width+"x"+Z.height),sA=new Eg(w,Z),[4,sA.render(k)];case 4:W=Me.sent(),Me.label=5;case 5:return(!((lt=i.removeContainer)!==null&&lt!==void 0)||lt)&&(za.destroy(G)||w.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),w.logger.debug("Finished rendering"),[2,W]}})})},Kg=function(s,i,a){var n=i.ownerDocument,h=n.documentElement?Yt(s,getComputedStyle(n.documentElement).backgroundColor):He.TRANSPARENT,p=n.body?Yt(s,getComputedStyle(n.body).backgroundColor):He.TRANSPARENT,B=typeof a=="string"?Yt(s,a):a===null?He.TRANSPARENT:4294967295;return i===n.documentElement?Ve(h)?Ve(p)?B:p:h:B};return Dg})});var Bu={};Xg(Bu,{default:()=>Ar});module.exports=Jg(Bu);var To=require("obsidian");var X=require("obsidian");var rs=class{constructor(e){this.vault=e}async parseCanvasFile(e){try{let A=await this.vault.read(e),t=JSON.parse(A),r=[];if(t&&t.nodes)for(let o of t.nodes)o.type==="file"&&o.file&&r.push(o.file);return r}catch(A){return console.error("\u89E3\u6790 Canvas \u6587\u4EF6\u5931\u8D25:",A),[]}}};var Bo=require("obsidian");var cA={AGAIN:1,HARD:2,GOOD:3,EASY:4},Wr={request_retention:.9,maximum_interval:36500,newCardsPerDay:20,reviewsPerDay:100,w:[.4872,1.4003,3.7145,13.8206,5.1618,1.2298,.8975,.031,1.6474,.1367,1.0461,2.1072,.0793,.3246,1.587,.2272,2.8755]};var fo=require("obsidian");var go={"Ollama (Local)":"Ollama (local)",Model:"Model",Save:"Save",Cancel:"Cancel",Edit:"Edit",Delete:"Delete","Custom Model":"Custom model","Checking...":"Checking...","Select the AI service provider":"Select the AI service provider.","API Key":"API key","Please enter your API Key.":"Please enter your API key.","API Key is valid!":"API Key is valid!","API Key and model available.":"API Key and model available.","Invalid API Key or server error. Please verify your API Key.":"Invalid API Key or server error. Please verify your API Key.","Select a model or enter a custom one.":"Select a model or enter a custom one.","Provider URL":"Provider URL","Leave it blank, unless you are using a proxy.":"Leave it blank, unless you are using a proxy.","Please enter an API Key first":"Please enter an API Key first.","Custom model unavailable. Please check the model ID and your access permissions.":"Custom model unavailable. Please check the model ID and your access permissions.","OpenAI service":"OpenAI service","No models available. Please check your API Key.":"No models available. Please check your API Key.","Anthropic service":"Anthropic service","Model ID can only contain letters, numbers, underscores, dots and hyphens.":"Model ID can only contain letters, numbers, underscores, dots and hyphens.","Unable to create model selection dropdown menu.":"Unable to create model selection dropdown menu.","Gemini service":"Gemini service","Deepseek service":"Deepseek service","Ollama service":"Ollama service","Ollama server URL (default: http://localhost:11434)":"Ollama server URL (default: http://localhost:11434)",Check:"Check","Server URL":"Server URL","Successfully connected to Ollama service":"Successfully connected to Ollama service.","No models found. Please download models using ollama":"No models found. Please download models using ollama.","Could not connect to Ollama service":"Could not connect to Ollama service","Failed to connect to Ollama service. Please check the server URL.":"Failed to connect to Ollama service. Please check the server URL.","Currently selected model (Test connection to see all available models)":"Currently selected model (Test connection to see all available models)","Select a Ollama model.":"Select a Ollama model.","No models available. Please load an available model first.":"No models available. Please load an available model first.","No models available":"No models available","Prompt settings":"Custom prompt","Add Prompt":"Add prompt","Input Prompt Name":"Input prompt name","Input Prompt Content\nAvailable parameters:\n{{highlight}} - Current highlighted text\n{{comment}} - Existing comment":`Input prompt content
Available parameters:
{{highlight}} - Current highlighted text
{{comment}} - Existing comment`,"Prompt added":"Prompt added","Prompt updated":"Prompt updated","Shift + Enter Wrap, Enter Save":"Shift + Enter Wrap, Enter Save","Delete comment":"Delete","Add Comment":"Add comment","Export as Image":"Export as image","Select Prompt":"Select prompt","Please add Prompt in the settings first":"Please add prompt in the settings first","AI comments have been added":"AI comments have been added","AI comments failed:":"AI comments failed:",Chat:"Chat","Failed to process dropped highlight:":"Failed to process dropped highlight:","highlighted notes":" highlighted notes","Input message...":"Input message...","Unable to access the Ollama model, please check the service.":"Unable to access the Ollama model, please check the service.","Unable to get Gemini model list, please check API Key and network connection.":"Unable to get Gemini model list, please check API key and network connection.",Download:"Download","Export successful!":"Export successful!","Export failed, please try again.":"Export failed, please try again.","Loading...":"Loading...","Search...":"Search...","No matching content found.":"No matching content found.","The current document has no highlighted content.":"The current document has no highlighted content.","No corresponding file found.":"No corresponding file found.","Export failed: Failed to load necessary components.":"Export failed: Failed to load necessary components.","All Highlight":"All highlight","Export as notes":"Export as notes","Add File Comment":"Add file comment","File Comment":"File comment","Successfully exported highlights to: ":"Successfully exported highlights to: ","Failed to export highlights: ":"Failed to export highlights: ","Default Template":"Default template","Modern minimalist knowledge card style":"Modern minimalist knowledge card style","Academic Template":"Academic template","Formal style suitable for academic citations":"Formal style suitable for academic citations","Social Template":"Social template","Modern style suitable for social media sharing":"Modern style suitable for social media sharing","Open AI chat window":"Open AI chat window","Open HiNote window":"Open HiNote window",General:"Highlight","Export Path":"Export path","Set the path for exported highlight notes. Leave empty to use vault root. The path should be relative to your vault root.":"Set the path for exported highlight notes. Leave empty to use vault root. The path should be relative to your vault root.",Exclusions:"Exclusions","Comma separated list of paths, tags, note titles or file extensions that will be excluded from highlighting. e.g. folder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md":"Comma separated list of paths, tags, note titles or file extensions that will be excluded from highlighting. e.g. folder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md","Custom text extraction":"Custom text extraction","Use Custom Pattern":"Use custom pattern","Enable to use a custom regular expression for extracting text.":"Enable to use a custom regular expression for extracting text.","Custom Pattern":"Custom pattern","Enter a custom regular expression for extracting text. Use capture groups () to specify the text to extract. The first non-empty capture group will be used as the extracted text.":"Enter a custom regular expression for extracting text. Use capture groups () to specify the text to extract. The first non-empty capture group will be used as the extracted text.","Default Color":"Default color","Set the default color for decorators when no color is specified. Leave empty to use system default.":"Set the default color for decorators when no color is specified. Leave empty to use system default.","Export template":"Export template","Clean orphaned data":"Clean orphaned data","Remove highlights and comments that no longer exist in your documents. This is useful if you have deleted highlights but their comments are still stored in the data file.":"Remove highlights and comments that no longer exist in your documents. This is useful if you have deleted highlights but their comments are still stored in the data file.","Flashcard learning":"Flashcard learning","New cards per day":"New cards per day","Maximum number of new cards to learn each day":"Maximum number of new cards to learn each day.","Reviews per day":"Reviews per day","Maximum number of cards to review each day":"Maximum number of cards to review each day.","Target retention":"Target retention","Target memory retention rate (0.8 = 80%)":"Target memory retention rate (0.8 = 80%).","Maximum interval":"Maximum interval","Maximum interval in days between reviews":"Maximum interval in days between reviews.","Reset daily stats":"Reset daily stats","Reset today's learning statistics":"Reset today's learning statistics.",Reset:"Reset","Daily statistics have been reset":"Daily statistics have been reset","No statistics to reset for today":"No statistics to reset for today",Advanced:"Advanced","These settings control the FSRS algorithm parameters. Only change them if you understand the algorithm.":"These settings control the FSRS algorithm parameters. Only change them if you understand the algorithm.","Reset algorithm parameters":"Reset algorithm parameters","Reset the FSRS algorithm parameters to default values":"Reset the FSRS algorithm parameters to default values.","Reset to Default":"Reset to default","FSRS parameters have been reset to default values":"FSRS parameters have been reset to default values.",days:"days","Activate HiCard":"Activate HiCard","Enter your license key to activate HiCard feature.":"Enter your license key to activate HiCard feature.","Enter license key":"Enter license key",Activate:"Activate","Please enter a license key":"Please enter a license key","HiCard activated successfully!":"HiCard activated successfully!","Invalid license key":"Invalid license key","Use global settings":"Use global settings","New cards per day:":"New cards per day:","Reviews per day:":"Reviews per day:","Create Group":"Create group",Create:"Create",Again:"Again",Hard:"Hard",Good:"Good",Easy:"Easy",Card:"Card",of:"of",Settings:"Settings","Are you sure you want to delete this group?":"Are you sure you want to delete this group?",Yes:"Yes",No:"No","You've completed All cards for today!":"You've completed All cards for today!","No cards available.":"No cards available.","Return to First Card":"Return to First Card","Edit Group":"Edit group","Create New Group":"Create new group","Please fill in all fields":"Please fill in all fields","Saving...":"Saving...","Creating...":"Creating...","Group updated successfully":"Group updated successfully","Failed to update group":"Failed to update group","Group created successfully":"Group created successfully","Failed to create or update group":"Failed to create or update group",Retention:"Retention","Limits:":"Limits:","Learning completed!":"Learning completed!","Group deleted":"Group deleted","search-prefix-all":"match all file highlights","search-prefix-hicard":"match flashcards only","search-prefix-comment":"match with comments only","search-prefix-path":"match path of the file","Open (DoubleClick)":"Open (double-click)"};var uo={"Ollama (Local)":"Ollama (\u672C\u5730)",Model:"\u6A21\u578B",Save:"\u4FDD\u5B58",Cancel:"\u53D6\u6D88",Edit:"\u7F16\u8F91",Delete:"\u5220\u9664","Custom Model":"\u81EA\u5B9A\u4E49\u6A21\u578B","Checking...":"\u68C0\u67E5\u4E2D...","Select the AI service provider":"\u9009\u62E9 AI \u670D\u52A1\u63D0\u4F9B\u5546\u3002","API Key":"API \u5BC6\u94A5","Please enter your API Key.":"\u8BF7\u8F93\u5165\u60A8\u7684 API \u5BC6\u94A5\u3002","API Key is valid!":"API \u5BC6\u94A5\u6709\u6548\uFF01","API Key and model available.":"API \u5BC6\u94A5\u548C\u6A21\u578B\u53EF\u7528\uFF01","Invalid API Key or server error. Please verify your API Key.":"API\u5BC6\u94A5\u65E0\u6548\u6216\u670D\u52A1\u5668\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u5BC6\u94A5\u3002","Select a model or enter a custom one.":"\u9009\u62E9\u6A21\u578B\u6216\u8F93\u5165\u81EA\u5B9A\u4E49\u6A21\u578B\u3002","Provider URL":"\u670D\u52A1\u5730\u5740","Leave it blank, unless you are using a proxy.":"\u7559\u7A7A\uFF0C\u9664\u975E\u60A8\u4F7F\u7528\u4EE3\u7406\u3002","Please enter an API Key first":"\u8BF7\u5148\u8F93\u5165 API \u5BC6\u94A5\u3002","Custom model unavailable. Please check the model ID and your access permissions.":"\u81EA\u5B9A\u4E49\u6A21\u578B\u4E0D\u53EF\u7528\u3002\u8BF7\u68C0\u67E5\u6A21\u578B ID \u548C\u60A8\u7684\u8BBF\u95EE\u6743\u9650\u3002","OpenAI service":"OpenAI \u670D\u52A1","No models available. Please check your API Key.":"\u6CA1\u6709\u53EF\u7528\u7684\u6A21\u578B\u3002\u8BF7\u68C0\u67E5\u60A8\u7684 API \u5BC6\u94A5\u3002","Anthropic service":"Anthropic \u670D\u52A1","Model ID can only contain letters, numbers, underscores, dots and hyphens.":"\u6A21\u578B ID \u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u3001\u6570\u5B57\u3001\u4E0B\u5212\u7EBF\u3001\u70B9\u548C\u8FDE\u5B57\u7B26","Unable to create model selection dropdown menu.":"\u65E0\u6CD5\u521B\u5EFA\u6A21\u578B\u9009\u62E9\u4E0B\u62C9\u83DC\u5355\u3002","Gemini service":"Gemini \u670D\u52A1","Deepseek service":"Deepseek \u670D\u52A1","Ollama service":"Ollama \u670D\u52A1","Ollama server URL (default: http://localhost:11434)":"Ollama server URL\uFF08\u9ED8\u8BA4\uFF1Ahttp://localhost:11434\uFF09",Check:"\u9A8C\u8BC1","Server URL":"\u670D\u52A1\u5668 URL","Successfully connected to Ollama service":"\u6210\u529F\u8FDE\u63A5\u5230 Ollama \u670D\u52A1","No models found. Please download models using ollama":"\u672A\u627E\u5230\u6A21\u578B\u3002\u8BF7\u4F7F\u7528 ollama \u4E0B\u8F7D\u6A21\u578B","Could not connect to Ollama service":"\u65E0\u6CD5\u8FDE\u63A5\u5230 Ollama \u670D\u52A1","Failed to connect to Ollama service. Please check the server URL.":"\u65E0\u6CD5\u8FDE\u63A5\u5230 Ollama \u670D\u52A1\uFF0C\u8BF7\u68C0\u67E5 server URL\u3002","Currently selected model (Test connection to see all available models)":"\u5F53\u524D\u9009\u62E9\u7684\u6A21\u578B\uFF08\u6D4B\u8BD5\u8FDE\u63A5\u4EE5\u67E5\u770B\u53EF\u7528\u6A21\u578B\uFF09","Select a Ollama model.":"\u9009\u62E9\u4E00\u4E2A Ollama \u6A21\u578B","No models available. Please load an available model first.":"\u65E0\u53EF\u7528\u6A21\u578B\uFF0C\u8BF7\u5148\u52A0\u8F7D\u53EF\u7528\u6A21\u578B\u3002","No models available":"\u65E0\u53EF\u7528\u6A21\u578B","Prompt settings":"\u81EA\u5B9A\u4E49 Prompt","Add Prompt":"\u6DFB\u52A0 Prompt","Input Prompt Name":"\u8F93\u5165 Prompt \u540D\u79F0","Input Prompt Content\nAvailable parameters:\n{{highlight}} - Current highlighted text\n{{comment}} - Existing comment":`\u8F93\u5165 Prompt \u5185\u5BB9
\u53EF\u7528\u53C2\u6570:
{{highlight}} - \u5F53\u524D\u9AD8\u4EAE\u6587\u672C
{{comment}} - \u5DF2\u5B58\u5728\u7684\u6CE8\u91CA`,"Prompt added":"Prompt \u5DF2\u6DFB\u52A0","Prompt updated":"Prompt \u5DF2\u66F4\u65B0","Shift + Enter Wrap, Enter Save":"Shift + Enter \u6362\u884C\uFF0CEnter \u4FDD\u5B58","Delete comment":"\u5220\u9664\u8BC4\u8BBA","Add Comment":"\u6DFB\u52A0\u8BC4\u8BBA","Export as Image":"\u5BFC\u51FA\u4E3A\u56FE\u7247","Select Prompt":"\u9009\u62E9 Prompt","Please add Prompt in the settings first":"\u8BF7\u5148\u5728\u8BBE\u7F6E\u4E2D\u6DFB\u52A0 Prompt","AI comments added ":"AI \u8BC4\u8BBA\u5DF2\u6DFB\u52A0","AI comments failed:":"AI \u8BC4\u8BBA\u5931\u8D25\uFF1A",Chat:"\u5BF9\u8BDD","Failed to process dropped highlight:":"\u65E0\u6CD5\u5904\u7406\u5220\u9664\u7684\u9AD8\u4EAE\uFF1A","highlighted notes":" \u6761\u9AD8\u4EAE\u7B14\u8BB0","Input message...":"\u8F93\u5165\u6D88\u606F...","Unable to access the Ollama model, please check the service.":"\u65E0\u6CD5\u8BBF\u95EE Ollama \u6A21\u578B\uFF0C\u8BF7\u68C0\u67E5\u670D\u52A1\u662F\u5426\u6B63\u5E38\u8FD0\u884C","Unable to get Gemini model list, please check API Key and network connection.":"\u65E0\u6CD5\u83B7\u53D6 Gemini \u6A21\u578B\u5217\u8868\uFF0C\u8BF7\u68C0\u67E5 API Key \u548C\u7F51\u7EDC\u8FDE\u63A5",Download:"\u4E0B\u8F7D","Export successful!":"\u5BFC\u51FA\u6210\u529F\uFF01","Export failed, please try again.":"\u5BFC\u51FA\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5","Loading...":"\u52A0\u8F7D\u4E2D...","Search...":"\u641C\u7D22\u9AD8\u4EAE\u6216\u8BC4\u8BBA...","No matching content found.":"\u672A\u627E\u5230\u5339\u914D\u7684\u5185\u5BB9\u3002","The current document has no highlighted content.":"\u5F53\u524D\u6587\u6863\u6CA1\u6709\u9AD8\u4EAE\u5185\u5BB9\u3002","No corresponding file found.":"\u672A\u627E\u5230\u76F8\u5E94\u7684\u6587\u4EF6\u3002","Export failed: Failed to load necessary components.":"\u5BFC\u51FA\u5931\u8D25\uFF1A\u52A0\u8F7D\u5FC5\u8981\u7EC4\u4EF6\u5931\u8D25\u3002","All Highlight":"\u5168\u90E8\u9AD8\u4EAE","Export as notes":"\u5BFC\u51FA\u4E3A\u7B14\u8BB0","Add File Comment":"\u6DFB\u52A0\u6587\u4EF6\u8BC4\u8BBA","File Comment":"\u6587\u4EF6\u8BC4\u8BBA","Successfully exported highlights to: ":"\u6210\u529F\u5BFC\u51FA\u9AD8\u4EAE\u5230\uFF1A","Failed to export highlights: ":"\u65E0\u6CD5\u5BFC\u51FA\u9AD8\u4EAE\uFF1A","Default Template":"\u9ED8\u8BA4\u6A21\u677F","Modern minimalist knowledge card style":"\u73B0\u4EE3\u6781\u7B80\u77E5\u8BC6\u5361\u7247\u98CE\u683C","Academic Template":"\u5B66\u672F\u6A21\u677F","Formal style suitable for academic citations":"\u9002\u7528\u4E8E\u5B66\u672F\u5F15\u7528\u7684\u6B63\u5F0F\u98CE\u683C","Social Template":"\u793E\u4EA4\u6A21\u677F","Modern style suitable for social media sharing":"\u9002\u7528\u4E8E\u793E\u4EA4\u5A92\u4F53\u5206\u4EAB\u7684\u73B0\u4EE3\u98CE\u683C","Open AI chat window":"\u6253\u5F00 AI \u5BF9\u8BDD\u7A97\u53E3","Open HiNote window":"\u6253\u5F00 HiNote \u7A97\u53E3","General Settings":"\u901A\u7528\u8BBE\u7F6E","Export Path":"\u5BFC\u51FA\u8DEF\u5F84","Set the path for exported highlight notes. Leave empty to use vault root. The path should be relative to your vault root.":"\u8BBE\u7F6E\u9AD8\u4EAE\u7B14\u8BB0\u7684\u5BFC\u51FA\u8DEF\u5F84\u3002\u7559\u7A7A\u5219\u4F7F\u7528 vault \u6839\u76EE\u5F55\u3002\u8DEF\u5F84\u5E94\u76F8\u5BF9\u4E8E vault \u6839\u76EE\u5F55\u3002",Exclusions:"\u6392\u9664","Comma separated list of paths, tags, note titles or file extensions that will be excluded from highlighting. e.g. folder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md":"\u9017\u53F7\u5206\u9694\u7684\u8DEF\u5F84\uFF0C\u6807\u7B7E\uFF0C\u7B14\u8BB0\u6807\u9898\u6216\u6587\u4EF6\u6269\u5C55\u540D\uFF0C\u5C06\u4ECE\u9AD8\u4EAE\u4E2D\u6392\u9664\u3002\u4F8B\u5982\uFF1Afolder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md","Custom text extraction":"\u81EA\u5B9A\u4E49\u6587\u672C\u63D0\u53D6","Use Custom Pattern":"\u4F7F\u7528\u81EA\u5B9A\u4E49\u6A21\u5F0F","Enable to use a custom regular expression for extracting text.":"\u542F\u7528\u81EA\u5B9A\u4E49\u6B63\u5219\u8868\u8FBE\u5F0F\u4EE5\u63D0\u53D6\u6587\u672C\u3002","Custom Pattern":"\u81EA\u5B9A\u4E49\u6A21\u5F0F","Enter a custom regular expression for extracting text. Use capture groups () to specify the text to extract. The first non-empty capture group will be used as the extracted text.":"\u8F93\u5165\u81EA\u5B9A\u4E49\u6B63\u5219\u8868\u8FBE\u5F0F\u4EE5\u63D0\u53D6\u6587\u672C\u3002\u4F7F\u7528\u6355\u83B7\u7EC4 () \u6307\u5B9A\u8981\u63D0\u53D6\u7684\u6587\u672C\u3002\u7B2C\u4E00\u4E2A\u975E\u7A7A\u6355\u83B7\u7EC4\u5C06\u7528\u4F5C\u63D0\u53D6\u7684\u6587\u672C\u3002","Default Color":"\u9ED8\u8BA4\u989C\u8272","Set the default color for decorators when no color is specified. Leave empty to use system default.":"\u8BBE\u7F6E\u5F53\u672A\u6307\u5B9A\u989C\u8272\u65F6\u7684\u88C5\u9970\u5668\u7684\u9ED8\u8BA4\u989C\u8272\u3002\u7559\u7A7A\u4EE5\u4F7F\u7528\u7CFB\u7EDF\u9ED8\u8BA4\u989C\u8272\u3002","Export template":"\u5BFC\u51FA\u6A21\u677F","Clean orphaned data":"\u6E05\u7406\u5B64\u7ACB\u6570\u636E","Remove highlights and comments that no longer exist in your documents. This is useful if you have deleted highlights but their comments are still stored in the data file.":"\u5220\u9664\u4E0D\u518D\u5B58\u5728\u4E8E\u60A8\u7684\u6587\u6863\u4E2D\u7684\u9AD8\u4EAE\u548C\u6CE8\u91CA\u3002\u8FD9\u5728\u60A8\u5220\u9664\u9AD8\u4EAE\u4F46\u6CE8\u91CA\u4ECD\u7136\u5B58\u50A8\u5728\u6570\u636E\u6587\u4EF6\u4E2D\u65F6\u5F88\u6709\u7528\u3002","Flashcard learning":"\u95EA\u5361\u5B66\u4E60\u8BBE\u7F6E","New cards per day":"\u6BCF\u65E5\u65B0\u5361\u7247\u6570\u91CF","Maximum number of new cards to learn each day":"\u6BCF\u5929\u5B66\u4E60\u7684\u65B0\u5361\u7247\u6700\u5927\u6570\u91CF","Reviews per day":"\u6BCF\u65E5\u590D\u4E60\u6570\u91CF","Maximum number of cards to review each day":"\u6BCF\u5929\u590D\u4E60\u7684\u5361\u7247\u6700\u5927\u6570\u91CF","Target retention":"\u76EE\u6807\u8BB0\u5FC6\u4FDD\u6301\u7387","Target memory retention rate (0.8 = 80%)":"\u76EE\u6807\u8BB0\u5FC6\u4FDD\u6301\u7387\uFF080.8 = 80%\uFF09","Maximum interval":"\u6700\u5927\u95F4\u9694","Maximum interval in days between reviews":"\u590D\u4E60\u4E4B\u95F4\u7684\u6700\u5927\u95F4\u9694\u5929\u6570","Reset daily stats":"\u91CD\u7F6E\u4ECA\u65E5\u7EDF\u8BA1","Reset today's learning statistics":"\u91CD\u7F6E\u4ECA\u5929\u7684\u5B66\u4E60\u7EDF\u8BA1\u6570\u636E",Reset:"\u91CD\u7F6E","Daily statistics have been reset":"\u4ECA\u65E5\u7EDF\u8BA1\u5DF2\u91CD\u7F6E","No statistics to reset for today":"\u4ECA\u5929\u6CA1\u6709\u53EF\u91CD\u7F6E\u7684\u7EDF\u8BA1\u6570\u636E",Advanced:"\u9AD8\u7EA7\u8BBE\u7F6E","These settings control the FSRS algorithm parameters. Only change them if you understand the algorithm.":"\u8FD9\u4E9B\u8BBE\u7F6E\u63A7\u5236FSRS\u7B97\u6CD5\u53C2\u6570\u3002\u4EC5\u5728\u7406\u89E3\u7B97\u6CD5\u7684\u60C5\u51B5\u4E0B\u66F4\u6539\u5B83\u4EEC\u3002","Reset algorithm parameters":"\u91CD\u7F6E\u7B97\u6CD5\u53C2\u6570","Reset the FSRS algorithm parameters to default values":"\u5C06FSRS\u7B97\u6CD5\u53C2\u6570\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u503C","Reset to default":"\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u503C","FSRS parameters have been reset to default values":"FSRS\u53C2\u6570\u5DF2\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u503C",days:"\u5929","FSRS weight parameter. The default value is obtained from a smaller sample; if adjustment is needed, please use the FSRS optimizer for calculation.":"\u7B97\u6CD5\u6743\u91CD\u53C2\u6570\u3002\u9ED8\u8BA4\u503C\u4E3A\u8F83\u5C0F\u6837\u672C\u83B7\u5F97\uFF0C\u5982\u679C\u9700\u8981\u8C03\u6574\u8BF7\u4F7F\u7528 FSRS \u4F18\u5316\u5668\u8BA1\u7B97","FSRS parameters":"FSRS \u53C2\u6570","Edit the 17 FSRS algorithm weights. Format: JSON array of numbers.":"\u7F16\u8F91 17 \u4E2A FSRS \u7B97\u6CD5\u6743\u91CD\u3002\u683C\u5F0F\uFF1A\u6570\u5B57\u6570\u7EC4\u7684 JSON \u683C\u5F0F\u3002","FSRS parameters updated successfully":"FSRS \u53C2\u6570\u66F4\u65B0\u6210\u529F","Activate HiCard":"\u6FC0\u6D3B HiCard","Enter your license key to activate HiCard feature.":"\u8F93\u5165\u60A8\u7684\u8BB8\u53EF\u8BC1\u5BC6\u94A5\u4EE5\u6FC0\u6D3B HiCard \u529F\u80FD\u3002","Enter license key":"\u8F93\u5165\u8BB8\u53EF\u8BC1\u5BC6\u94A5",Activate:"\u6FC0\u6D3B","Please enter a license key":"\u8BF7\u8F93\u5165\u8BB8\u53EF\u8BC1\u5BC6\u94A5","HiCard activated successfully!":"HiCard \u6FC0\u6D3B\u6210\u529F\uFF01","Invalid license key":"\u65E0\u6548\u7684\u8BB8\u53EF\u8BC1\u5BC6\u94A5","Use global settings":"\u4F7F\u7528\u5168\u5C40\u8BBE\u7F6E","New cards per day:":"\u6BCF\u65E5\u65B0\u5361\u6570\u91CF:","Reviews per day:":"\u6BCF\u65E5\u590D\u4E60\u6570\u91CF:","Create group":"\u521B\u5EFA\u5206\u7EC4",Create:"\u521B\u5EFA",Again:"\u91CD\u6765",Hard:"\u56F0\u96BE",Good:"\u826F\u597D",Easy:"\u7B80\u5355",Card:"\u5361\u7247",of:"\u5171",Settings:"\u8BBE\u7F6E","Are you sure you want to delete this group?":"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u5206\u7EC4\u5417\uFF1F",Yes:"\u662F",No:"\u5426","You've completed All cards for today!":"\u60A8\u4ECA\u5929\u5DF2\u5B8C\u6210\u6240\u6709\u5361\u7247\uFF01","No cards available.":"\u6CA1\u6709\u53EF\u7528\u7684\u5361\u7247\u3002","Return to First Card":"\u8FD4\u56DE\u7B2C\u4E00\u5F20\u5361\u7247","Edit Group":"\u7F16\u8F91\u5206\u7EC4","Create New Group":"\u521B\u5EFA\u65B0\u5206\u7EC4","Please fill in all fields":"\u8BF7\u586B\u5199\u6240\u6709\u5B57\u6BB5","Saving...":"\u4FDD\u5B58\u4E2D...","Creating...":"\u521B\u5EFA\u4E2D...","Group updated successfully":"\u5206\u7EC4\u66F4\u65B0\u6210\u529F","Failed to update group":"\u5206\u7EC4\u66F4\u65B0\u5931\u8D25","Group created successfully":"\u5206\u7EC4\u521B\u5EFA\u6210\u529F","Failed to create or update group":"\u521B\u5EFA\u6216\u66F4\u65B0\u5206\u7EC4\u5931\u8D25",Retention:"\u4FDD\u7559\u7387","Limits:":"\u9650\u5236\uFF1A","Learning completed!":"\u5B66\u4E60\u5B8C\u6210\uFF01","Group deleted":"\u5206\u7EC4\u5DF2\u5220\u9664","search-prefix-all":"\u8DE8\u6587\u4EF6\u641C\u7D22\u6240\u6709\u9AD8\u4EAE","search-prefix-hicard":"\u53EA\u641C\u7D22\u95EA\u5361\u9AD8\u4EAE","search-prefix-comment":"\u53EA\u641C\u7D22\u5E26\u6279\u6CE8\u7684\u9AD8\u4EAE","search-prefix-path":"\u6309\u6587\u4EF6\u8DEF\u5F84\u641C\u7D22\u9AD8\u4EAE","Open (double-click)":"\u53CC\u51FB\u6253\u5F00"};var po={en:go,zh:uo};function f(Q){let t=(fo.moment.locale().startsWith("zh")?po.zh:po.en)[Q];return t||Q}var pA=require("obsidian");var ns=class{constructor(e,A){this.containerEl=e,this.fsrsManager=A}render(){this.containerEl.empty(),this.containerEl.addClass("flashcard-stats-panel"),this.renderStatsArea(),this.renderHeatmap()}renderStatsArea(){let e=this.containerEl.createDiv("flashcard-stats-area"),A=this.fsrsManager.getProgress();this.createStatItem(e,A.newCards.toString(),"New","flashcard-stat-new"),this.createStatItem(e,A.learned.toString(),"Learning","flashcard-stat-learning"),this.createStatItem(e,A.due.toString(),"Review","flashcard-stat-due")}createStatItem(e,A,t,r){let o=e.createDiv(`flashcard-stat-item ${r}`),l=o.createDiv("flashcard-stat-value");l.textContent=A;let c=o.createDiv("flashcard-stat-label");c.textContent=t}renderHeatmap(){var e;this.createHeatmap(this.containerEl,((e=this.fsrsManager.storage)==null?void 0:e.dailyStats)||[])}createHeatmap(e,A){let t=e.createDiv("flashcard-heatmap-grid"),r=new Date;new Date(r).setDate(r.getDate()-83);let l=new Map,c=new Date(r);c.setHours(0,0,0,0);let d=c.getTime(),g=`${c.getFullYear()}-${c.getMonth()+1}-${c.getDate()}`,u=!1;[...A].forEach(R=>{let N=new Date(R.date),J=N.getFullYear(),AA=N.getMonth()+1,FA=N.getDate(),wA=`${J}-${AA}-${FA}`;wA===g&&(u=!0),l.set(wA,R)}),u||l.set(g,{date:d,newCardsLearned:0,cardsReviewed:0,reviewCount:0,newCount:0,againCount:0,hardCount:0,goodCount:0,easyCount:0});let v=7,F=12;t.style.display="grid",t.style.gridTemplateRows=`repeat(${v}, 1fr)`,t.style.gridTemplateColumns=`repeat(${F}, 1fr)`;let y=r.getDay(),E=y===0?6:y-1,H=new Date(r);H.setDate(r.getDate()-((y===0?7:y)-1));let x=new Date(H);x.setDate(x.getDate()-11*7);let M=[],T=[];for(let R=0;R<F;R++){let N=new Date(x);N.setDate(N.getDate()+R*7),T.push(N)}for(let R=0;R<F;R++){let N=[];for(let J=0;J<v;J++){let AA=new Date(T[R]);AA.setDate(AA.getDate()+J),N.push(AA)}M.push(N)}for(let R=0;R<v;R++)for(let N=0;N<F;N++){let J=M[N][R],AA=J.getFullYear(),FA=J.getMonth()+1,wA=J.getDate(),PA=`${AA}-${FA}-${wA}`,aA=l.get(PA),iA=t.createDiv("flashcard-heatmap-cell"),MA=PA===g;if(aA){let mA=aA.newCardsLearned*1.5+aA.cardsReviewed;if(aA.reviewCount>0){let YA=(aA.againCount*1.5+aA.hardCount*1.2+aA.goodCount+aA.easyCount*.8)/aA.reviewCount;mA=mA*(YA+.5)}mA=Math.min(mA,20);let WA=Math.ceil(mA/4);iA.addClass(`flashcard-heatmap-level-${WA}`);let ZA=`${J.toLocaleDateString()}: Learned ${aA.newCardsLearned} new cards, reviewed ${aA.cardsReviewed} cards`;aA.reviewCount>0&&(ZA+=`
Rating distribution: Again(${aA.againCount}), Hard(${aA.hardCount}), Good(${aA.goodCount}), Easy(${aA.easyCount})`),iA.setAttribute("title",ZA)}else MA||J>r,iA.addClass("flashcard-heatmap-level-0")}}addZoomControl(e,A){}};var as=class{constructor(e){this.isMobileView=!1;this.isSmallScreen=!1;this.showingSidebar=!0;this.isInFlashcardMode=!1;this.component=e,this.isMobileView=pA.Platform.isMobile,this.isSmallScreen=window.innerWidth<768,this.showingSidebar=this.isMobileView,this.isInFlashcardMode=!0}renderActivation(){let e=this.component.getContainer();e.empty(),e.addClass("flashcard-mode");let A=e.createEl("div",{cls:"flashcard-activation-container"}),t=A.createEl("div",{cls:"flashcard-activation-header",text:f("Activate HiCard")}),r=A.createEl("div",{cls:"flashcard-activation-description",text:f("Enter your license key to activate HiCard feature.")}),o=A.createEl("div",{cls:"flashcard-activation-input-container"}),l=o.createEl("input",{cls:"flashcard-activation-input",type:"text",placeholder:f("Enter license key")});o.createEl("button",{cls:"flashcard-activation-button",text:f("Activate")}).addEventListener("click",async()=>{let d=l.value.trim();if(!d){new pA.Notice(f("Please enter a license key"));return}await this.component.getLicenseManager().activateLicense(d)?(new pA.Notice(f("HiCard activated successfully!")),this.render()):new pA.Notice(f("Invalid license key"))})}toggleSidebar(){this.showingSidebar=!this.showingSidebar,this.render()}isShowingSidebar(){return this.showingSidebar}showSidebar(){this.showingSidebar=!0;let e=this.component.getContainer();this.isMobileView&&this.isSmallScreen&&(e.addClass("show-sidebar"),e.removeClass("show-content")),this.render()}goBack(){this.isMobileView&&this.isSmallScreen&&(this.showingSidebar?this.component&&this.component.commentView&&(this.component.commentView.isFlashcardMode=!1,this.component.commentView.isShowingFileList=!0,this.component.commentView.updateViewLayout()):(this.showingSidebar=!0,this.render()))}render(){let e=this.component.getContainer();if(e.empty(),e.addClass("flashcard-mode"),this.isMobileView&&(e.addClass("is-mobile"),this.isSmallScreen&&e.addClass("is-small-screen"),this.showingSidebar?e.addClass("show-sidebar"):e.addClass("show-content")),!this.isMobileView||this.isMobileView&&!this.showingSidebar){let T=e.createEl("div",{cls:"flashcard-progress-container"});this.component.setProgressContainer(T),this.component.updateProgress()}let A=e.createEl("div",{cls:"flashcard-main-container"}),t=A.createEl("div",{cls:"flashcard-sidebar"}),r=t.createEl("div",{cls:"flashcard-stats-container"});new ns(r,this.component.getFsrsManager()).render();let l=t.createEl("div",{cls:"flashcard-groups"}),d=l.createEl("div",{cls:"flashcard-groups-header"}).createEl("div",{cls:"flashcard-add-group",attr:{"aria-label":f("Add Group")}});(0,pA.setIcon)(d,"plus"),d.addEventListener("click",()=>this.component.getGroupManager().showCreateGroupModal());let g=l.createEl("div",{cls:"flashcard-group-list"});(this.component.getFsrsManager().getCardGroups()||[]).forEach(T=>{let R=g.createEl("div",{cls:`flashcard-group-item ${T.name===this.component.getCurrentGroupName()?"active":""}`}),N=R.createEl("div",{cls:"flashcard-group-item-header"}),J=N.createEl("div",{cls:"flashcard-group-title"}),AA=J.createEl("span",{cls:"flashcard-group-icon"});(0,pA.setIcon)(AA,T.filter.startsWith("#")?"hash":"gallery-horizontal-end"),J.createEl("span",{cls:"flashcard-group-name",text:T.name});let FA=N.createEl("div",{cls:"flashcard-group-actions"}),wA=FA.createEl("div",{cls:"flashcard-group-action",attr:{"aria-label":f("Edit Group")}});(0,pA.setIcon)(wA,"edit"),wA.addEventListener("click",iA=>{iA.stopPropagation(),this.component.getGroupManager().showEditGroupModal(T)});let PA=FA.createEl("div",{cls:"flashcard-group-action",attr:{"aria-label":f("Delete Group")}});(0,pA.setIcon)(PA,"trash"),PA.addEventListener("click",async iA=>{if(iA.stopPropagation(),confirm(f('Are you sure you want to delete group "')+T.name+f('"?')))try{if(await this.component.getFsrsManager().deleteCardGroup(T.id)){if(this.component.getCurrentGroupName()===T.name){let mA=this.component.getFsrsManager().getCardGroups()||[];mA.length>0?this.component.setCurrentGroupName(mA[0].name):this.component.setCurrentGroupName("")}new pA.Notice(f("Group deleted")),this.render()}else new pA.Notice(f("Delete group failed"))}catch(MA){console.error("Delete group failed:",MA),new pA.Notice(f("Delete group failed"))}});let aA=this.component.getFsrsManager().getGroupProgress(T.id);if(aA){let iA=R.createEl("div",{cls:"flashcard-group-stats"}),MA=iA.createEl("div",{cls:"flashcard-group-stat",attr:{"data-tooltip":f("Due Today")}}),mA=MA.createEl("span",{cls:"flashcard-stat-icon"});(0,pA.setIcon)(mA,"calendar-clock"),MA.createEl("span",{text:aA.due.toString()});let WA=iA.createEl("div",{cls:"flashcard-group-stat",attr:{"data-tooltip":f("New Cards")}}),ZA=WA.createEl("span",{cls:"flashcard-stat-icon"});(0,pA.setIcon)(ZA,"sparkle"),WA.createEl("span",{text:aA.newCards.toString()});let YA=iA.createEl("div",{cls:"flashcard-group-stat",attr:{"data-tooltip":f("Learned")}}),Se=YA.createEl("span",{cls:"flashcard-stat-icon"});(0,pA.setIcon)(Se,"check-small"),YA.createEl("span",{text:aA.learned.toString()})}R.addEventListener("click",()=>{this.component.setGroupCompletionMessage(this.component.getCurrentGroupName(),this.component.getCompletionMessage());let iA={currentIndex:this.component.getCurrentIndex(),isFlipped:this.component.isCardFlipped()};this.component.setCurrentGroupName(T.name),e.querySelectorAll(".flashcard-group-item").forEach(WA=>WA.classList.remove("active")),R.classList.add("active"),this.component.setCompletionMessage(this.component.getGroupCompletionMessage(T.name)||null),this.component.refreshCardList();let mA=this.component.getGroupProgress(T.name);mA&&!this.component.getCompletionMessage()?(this.component.setCurrentIndex(mA.currentIndex),this.component.setCardFlipped(mA.isFlipped)):(this.component.setCurrentIndex(0),this.component.setCardFlipped(!1)),this.isMobileView&&(this.showingSidebar=!1),this.component.saveState(),this.render()})});let v=A.createEl("div",{cls:"flashcard-content-area"}).createEl("div",{cls:"flashcard-container"}),F=this.component.getCards(),y=this.component.getCurrentIndex(),E=F.length>0&&y<F.length?F[y]:null,H=this.component.getCurrentGroupName(),x=this.component.getGroupCompletionMessage(H),M=this.component.getFsrsManager().getCardGroups().length>0;if(!M||F.length===0){let T=this.component.getFsrsManager().getCardGroups().find(N=>N.name===H),R=T&&T.cardIds.length===0;if(M)if(R){let N=v.createEl("div",{cls:"flashcard-completion-message flashcard-empty-group"}),J=N.createEl("div",{cls:"completion-icon"});(0,pA.setIcon)(J,"circle-slash-2"),N.createEl("h3",{text:f("No Cards in This Group")}),N.createEl("p",{text:f("This group doesn't contain any flashcards yet. Add some flashcards to this group to start learning.")})}else{let N=v.createEl("div",{cls:"flashcard-completion-message"}),J=N.createEl("div",{cls:"completion-icon"});(0,pA.setIcon)(J,"check-circle"),N.createEl("h3",{text:f("Learning Completed!")});let AA=x;AA||(T?AA=f("Group completed: ")+T.name+f(". All cards have been reviewed."):AA=f("All flashcards completed for today!"),this.component.setGroupCompletionMessage(H,AA)),N.createEl("p",{text:AA})}else{let N=v.createEl("div",{cls:"flashcard-completion-message flashcard-no-group"}),J=N.createEl("div",{cls:"completion-icon"});(0,pA.setIcon)(J,"folder-plus"),N.createEl("h3",{text:f("No Flashcard Groups")}),N.createEl("p",{text:f("You haven't created any flashcard groups yet. Create a group to get started with your flashcards.")}),N.createEl("button",{cls:"mod-cta",text:f("Create Flashcard Group")}).addEventListener("click",()=>{this.component&&this.component.groupManager?this.component.groupManager.showCreateGroupModal():console.error("Group manager is not available")})}return}if(E){let T=["flashcard"];this.component.isCardFlipped()&&T.push("is-flipped");let R=v.createEl("div",{cls:T.join(" ")}),AA=this.component.getFsrsManager().getCardGroups().filter(IA=>this.component.getFsrsManager().getCardsInGroup(IA).some(gA=>gA.id===(E==null?void 0:E.id))).some(IA=>IA.isReversed),FA=AA?E.answer:E.text,wA=AA?E.text:E.answer,aA=R.createEl("div",{cls:"flashcard-side flashcard-front"}).createEl("div",{cls:"flashcard-content markdown-rendered"});this.renderMarkdownContent(aA,FA,E.filePath);let MA=R.createEl("div",{cls:"flashcard-side flashcard-back"}).createEl("div",{cls:"flashcard-content markdown-rendered"});this.renderMarkdownContent(MA,wA,E.filePath),R.addEventListener("click",()=>this.component.flipCard());let mA=v.createEl("div",{cls:"flashcard-rating"}),WA=E?this.component.getFsrsManager().getCardPredictions(E.id):null;this.component.getRatingButtons().forEach(IA=>{let re=mA.createEl("button",{cls:"flashcard-rating-button",attr:{"data-rating":IA.ratingText,title:`${IA.label} (${IA.key})`}});if(re.createSpan({text:IA.label}),WA&&WA[IA.rating]){let gA=new Date(WA[IA.rating].nextReview),KA=new Date,LA=gA.getTime()-KA.getTime(),zA=re.createSpan({cls:"prediction-info"}),CA="";if(LA<60*60*1e3)CA=`${Math.max(1,Math.round(LA/6e4))}m`;else if(LA<24*60*60*1e3)CA=`${Math.round(LA/36e5)}h`;else{let RA=Math.round(LA/864e5);RA<1?CA=`${Math.round(RA*24)}h`:RA<30?CA=`${Math.round(RA)}d`:RA<365?CA=`${Math.round(RA/30)}mo`:CA=`${Math.round(RA/365)}y`}zA.createSpan({text:CA,cls:"days"})}else{let gA=0,KA=(E==null?void 0:E.reviews)===0,LA=(E==null?void 0:E.lapses)>0;switch(IA.rating){case cA.AGAIN:gA=KA?.25:LA?.5:1;break;case cA.HARD:gA=KA?24:LA?36:48;break;case cA.GOOD:gA=KA?24*3:LA?24*5:24*7;break;case cA.EASY:gA=KA?24*5:LA?24*9:24*14;break}let zA=gA/24,CA="";gA<1?CA=`${Math.round(gA*60)}m`:gA<24?CA=`${Math.round(gA)}h`:zA<1?CA=`${Math.round(zA*24)}h`:zA<30?CA=`${Math.round(zA)}d`:zA<365?CA=`${Math.round(zA/30)}mo`:CA=`${Math.round(zA/365)}y`,re.createSpan({text:CA,cls:"days"})}re.addEventListener("click",gA=>{gA.stopPropagation(),this.component.rateCard(IA.rating)})}),this.component.isCardFlipped()&&R.classList.add("is-flipped");let ZA=this.component.getCurrentGroupId(),YA=F.length,Se=this.component.getFsrsManager(),SA=(ZA?Se.getCardsForStudy(ZA):[]).length,Pe=Math.max(SA,YA),Ke=Pe-YA+1;if(v.createEl("div",{cls:"flashcard-counter",text:`${Ke}/${Pe}`}),E.filePath){let re=v.createEl("div",{cls:"flashcard-source"}).createEl("span",{text:E.filePath.split("/").pop()||""});this.component.getUtils().addPagePreview(re,E.filePath),re.addEventListener("click",gA=>{gA.stopPropagation();let KA=this.component.getApp().vault.getAbstractFileByPath(E.filePath);KA&&KA instanceof pA.TFile&&this.component.getApp().workspace.getLeaf().openFile(KA)})}}else v.createEl("div",{cls:"flashcard-empty-state",text:f("No cards available")})}async renderMarkdownContent(e,A,t){for(;e.firstChild;)e.removeChild(e.firstChild);if(!A){console.warn("renderMarkdownContent: content is empty or undefined"),e.textContent="Add answer";return}let r=e.closest(".flashcard-front")!==null,o=A;r?o=A.replace(/\{\{([^{}]+)\}\}/g,(l,c)=>{let g=c.split("").reduce((m,v)=>{let F=/[\u4e00-\u9fa5]/.test(v);return m+(F?3:1)},0);return c.length>5&&(g=Math.floor(g*1.2)),"_".repeat(Math.max(8,g))}):o=A.replace(/\{\{([^{}]+)\}\}/g,"$1");try{await pA.MarkdownRenderer.render(this.component.getApp(),o,e,t||"",new pA.Component),e.querySelectorAll("ul, ol").forEach(c=>{c.addClass("flashcard-markdown-list")}),r&&e.querySelectorAll("p").forEach(d=>{d.textContent&&d.textContent.includes("______")&&d.addClass("flashcard-cloze")})}catch(l){console.error("Error rendering markdown in flashcard:",l),e.textContent=o}}};var os=class{constructor(e){this.component=e}flipCard(){let e=!this.component.isCardFlipped();this.component.setCardFlipped(e);let A=document.querySelector(".flashcard");A&&(e?A.classList.add("is-flipped"):A.classList.remove("is-flipped")),this.component.saveState()}nextCard(){let e=this.component.getCards();if(e.length===0)return;let A=this.component.getCurrentIndex()+1;A>=e.length&&(A=0),this.component.setCurrentIndex(A),this.component.setCardFlipped(!1),this.component.saveState(),this.component.getRenderer().render()}rateCard(e){let A=this.component.getCards(),t=this.component.getCurrentIndex();if(A.length===0||t>=A.length)return;let r=A[t];if(r){if(this.component.getFsrsManager().trackStudyProgress(r.id,e),A.splice(t,1),A.length===0){let o=this.component.getCurrentGroupName(),l=f("No cards due for review");if(o){let c=this.component.getFsrsManager().getCardGroups().find(d=>d.name===o);c&&(l=f("Group completed: ")+c.name+f(". Add more cards in Settings, but remember: more cards = more reviews."))}else l=f("All flashcards completed for today!");this.component.setGroupCompletionMessage(o,l),this.component.updateProgress(),this.component.getRenderer().render();return}t>=A.length&&this.component.setCurrentIndex(0),this.component.setCardFlipped(!1),this.component.saveState(),this.component.updateProgress(),this.component.getRenderer().render()}}refreshCardList(){let e=this.component.getCurrentGroupName(),A=this.component.getFsrsManager(),t=this.component.getCards(),r=this.component.getCurrentGroupName();if(t.length>0&&r&&r!==e){let v=this.component.getCards(),F=this.component.getCurrentIndex(),y=v.length>0&&F<v.length?v[F].id:void 0,E={currentIndex:F,isFlipped:this.component.isCardFlipped(),currentCardId:y},H=A.getUIState();H.groupProgress||(H.groupProgress={}),H.groupProgress[r]=E,A.updateUIState(H)}let o=A.getCardGroups().find(v=>v.name===e);if(!o){console.error(`\u672A\u627E\u5230\u540D\u79F0\u4E3A ${e} \u7684\u5206\u7EC4`);return}let l=A.getCardsByGroupId(o.id),c=A.fsrsService,d=l.filter(v=>!!(v.reviews===0&&v.lastReview===0||c.isDue(v)));if(d.length===0){let v=f("No cards due for review");e?v=f("Group completed: ")+o.name+f(". Add more cards in Settings, but remember: more cards = more reviews."):v=f("All flashcards completed for today!"),this.component.setGroupCompletionMessage(e,v),this.component.setCards([]),this.component.updateProgress();let F=A.getUIState();F.groupProgress||(F.groupProgress={}),F.groupProgress[e]={currentIndex:0,isFlipped:!1,currentCardId:null,completionMessage:v},A.updateUIState(F),this.component.getRenderer().render(),this.component.saveState();return}let g=d,u=this.component.getGroupProgress(e),m=A.getUIState();if(m.groupProgress||(m.groupProgress={}),m.groupProgress[e]?m.groupProgress[e].completionMessage=void 0:m.groupProgress[e]={currentIndex:0,isFlipped:!1,currentCardId:void 0,completionMessage:void 0},A.updateUIState(m),this.component.setCards(g),g.length>0)if(u){let v=0;if(u.currentCardId){let F=g.findIndex(y=>y.id===u.currentCardId);F!==-1?v=F:v=Math.min(u.currentIndex,g.length-1)}else v=Math.min(u.currentIndex,g.length-1);this.component.setCurrentIndex(v),this.component.setCardFlipped(u.isFlipped)}else this.component.setCurrentIndex(0),this.component.setCardFlipped(!1);else{let v=f("No cards due for review");if(e){let F=A.getCardGroups().find(y=>y.name===e);F&&(v=f("Group completed: ")+F.name+f(". Add more cards in Settings, but remember: more cards = more reviews."))}else v=f("All flashcards completed for today!");this.component.setGroupCompletionMessage(e,v)}this.component.saveState()}};var ii=require("obsidian");var ls=class{constructor(e){this.component=e}showCreateGroupModal(){this.showEditGroupModal()}showEditGroupModal(e){var CA,RA,Tt;let{app:A}=this.component.getApp(),t=document.createElement("div");t.className="flashcard-modal-overlay",document.body.appendChild(t);let r=document.createElement("div");r.className="flashcard-modal-container",t.appendChild(r);let o=document.createElement("div");o.className="flashcard-modal-content",r.appendChild(o);let l=document.createElement("div");l.className="flashcard-modal-header",o.appendChild(l);let c=document.createElement("h3");c.textContent=e?f("Edit group"):f("Create group"),l.appendChild(c);let d=document.createElement("div");d.className="flashcard-group-form",o.appendChild(d);let g=e?e.name:"",u=document.createElement("input");u.type="text",u.className="flashcard-modal-input",u.placeholder=f("Enter name"),u.value=g,d.appendChild(u),u.addEventListener("input",BA=>{g=BA.target.value});let m=e?e.filter:"",v=document.createElement("textarea");v.className="flashcard-modal-input",v.placeholder=f(`Support format: 
Folder: folder1, folder1/folder2
Note: [[note1]], [[note2]]`),v.value=m,d.appendChild(v),v.addEventListener("input",BA=>{m=BA.target.value});let F=e&&e.isReversed||!1,y=document.createElement("div");y.className="flashcard-modal-option",d.appendChild(y);let E=document.createElement("input");E.type="checkbox",E.className="flashcard-modal-checkbox",E.checked=F,y.appendChild(E);let H=document.createElement("label");H.textContent=f("Reverse cards (use comments as questions)"),H.className="flashcard-modal-label",y.appendChild(H),E.addEventListener("change",BA=>{F=BA.target.checked});let x=document.createElement("div");x.className="flashcard-modal-settings",d.appendChild(x);let M=document.createElement("div");M.className="flashcard-modal-settings-header",x.appendChild(M);let T=document.createElement("h4");T.textContent=f("Learning settings"),T.className="settings-title",M.appendChild(T);let R=e?((CA=e.settings)==null?void 0:CA.useGlobalSettings)!==!1:!0,N=document.createElement("div");N.className="flashcard-modal-option use-global-option",M.appendChild(N);let J=document.createElement("input");J.type="checkbox",J.className="flashcard-modal-checkbox",J.id="use-global-settings",J.checked=R,N.appendChild(J);let AA=document.createElement("label");AA.textContent=f("Use global settings"),AA.className="flashcard-modal-label",AA.htmlFor="use-global-settings",N.appendChild(AA),J.addEventListener("change",BA=>{R=BA.target.checked,re()});let FA=e&&((RA=e.settings)==null?void 0:RA.newCardsPerDay)||20,wA=document.createElement("div");wA.className="flashcard-modal-option slider-option",x.appendChild(wA);let PA=document.createElement("label");PA.textContent=f("New cards per day: "),PA.className="flashcard-modal-label",wA.appendChild(PA);let aA=document.createElement("div");aA.className="slider-with-value",wA.appendChild(aA);let iA=document.createElement("input");iA.className="flashcard-modal-slider",iA.type="range",iA.min="5",iA.max="100",iA.step="5",iA.value=String(FA);let MA=parseInt(iA.value);MA<5?iA.value="5":MA%5!==0&&(iA.value=(Math.round(MA/5)*5).toString()),aA.appendChild(iA);let mA=document.createElement("span");mA.className="slider-value",mA.textContent=iA.value,aA.appendChild(mA),iA.addEventListener("input",()=>{FA=parseInt(iA.value),mA.textContent=iA.value});let WA={setDisabled:BA=>{iA.disabled=BA,wA.classList.toggle("disabled",BA)}},ZA=e&&((Tt=e.settings)==null?void 0:Tt.reviewsPerDay)||100,YA=document.createElement("div");YA.className="flashcard-modal-option slider-option",x.appendChild(YA);let Se=document.createElement("label");Se.textContent=f("Reviews per day: "),Se.className="flashcard-modal-label",YA.appendChild(Se);let De=document.createElement("div");De.className="slider-with-value",YA.appendChild(De);let SA=document.createElement("input");SA.className="flashcard-modal-slider",SA.type="range",SA.min="10",SA.max="500",SA.step="10",SA.value=String(ZA);let Pe=parseInt(SA.value);Pe<10?SA.value="10":Pe%10!==0&&(SA.value=(Math.round(Pe/10)*10).toString()),De.appendChild(SA);let Ke=document.createElement("span");Ke.className="slider-value",Ke.textContent=SA.value,De.appendChild(Ke),SA.addEventListener("input",()=>{ZA=parseInt(SA.value),Ke.textContent=SA.value});let IA={setDisabled:BA=>{SA.disabled=BA,YA.classList.toggle("disabled",BA)}},re=()=>{R?(WA.setDisabled(!0),IA.setDisabled(!0)):(WA.setDisabled(!1),IA.setDisabled(!1))};re();let gA=document.createElement("div");gA.className="button-container",o.appendChild(gA);let KA=document.createElement("button");KA.className="flashcard-cancel-btn",KA.textContent=f("Cancel"),gA.appendChild(KA);let LA=document.createElement("button");LA.className="flashcard-save-group-btn",LA.textContent=e?f("Save"):f("Create"),gA.appendChild(LA),LA.addEventListener("click",async()=>{if(!g){new ii.Notice(f("Group name cannot be empty"));return}let BA=this.component.getFsrsManager();if(e){let me=e.name;try{await BA.updateCardGroup(e.id,{name:g,filter:m,isReversed:F,settings:{useGlobalSettings:R,newCardsPerDay:R?void 0:FA,reviewsPerDay:R?void 0:ZA},lastUpdated:Date.now()});let HA=BA.storage;HA&&HA.uiState&&(HA.uiState.groupCompletionMessages&&HA.uiState.groupCompletionMessages[me]!==void 0&&(HA.uiState.groupCompletionMessages[g]=HA.uiState.groupCompletionMessages[me],delete HA.uiState.groupCompletionMessages[me]),HA.uiState.groupProgress&&HA.uiState.groupProgress[me]&&(HA.uiState.groupProgress[g]=HA.uiState.groupProgress[me],delete HA.uiState.groupProgress[me]),HA.uiState.currentGroupName===me&&(HA.uiState.currentGroupName=g),await BA.saveStoragePublic()),this.component.getCurrentGroupName()===me&&this.component.setCurrentGroupName(g),this.component.refreshCardList(),this.component.getRenderer().render(),new ii.Notice(f("Group update successful"))}catch(HA){console.error("Update group failed:",HA),new ii.Notice(f("Update group failed"))}}else await BA.createCardGroup({name:g,filter:m,isReversed:F,createdTime:Date.now(),sortOrder:BA.getCardGroups().length,settings:{useGlobalSettings:R,newCardsPerDay:R?void 0:FA,reviewsPerDay:R?void 0:ZA}}),new ii.Notice(f("Group created")),this.component.refreshCardList(),this.component.getRenderer().render();document.body.removeChild(t),e&&this.component.getRenderer().render()});let zA=BA=>{BA.key==="Escape"&&(document.body.removeChild(t),document.removeEventListener("keydown",zA))};document.addEventListener("keydown",zA),KA.addEventListener("click",()=>{document.body.removeChild(t),e&&this.component.getRenderer().render()})}};var mo=require("obsidian"),cs=class{constructor(e){this.component=e}getGroupProgress(){let e=this.component.getCurrentGroupId(),A=[];e?A=this.component.getFsrsManager().getCardsByGroupId(e):A=(()=>{let d=this.component.getFsrsManager(),g=d.getCardGroups(),u=[],m=new Set;return g.forEach(v=>{d.getCardsByGroupId(v.id).forEach(y=>{m.has(y.id)||(m.add(y.id),u.push(y))})}),u})();let r=A.filter(d=>this.component.getFsrsManager().fsrsService.isDue(d)).length,o=A.filter(d=>d.reviews===0).length,l=A.filter(d=>d.reviews>0).length,c=this.calculateRetention(A);return{due:r,newCards:o,learned:l,retention:c}}calculateRetention(e){let A=e.filter(r=>r.reviews>0);return A.length===0?1:A.reduce((r,o)=>r+o.retrievability,0)/A.length}updateProgress(){let e=this.component.getProgressContainer();if(!e)return;e.empty();let A=this.getGroupProgress(),t=e.createEl("div",{cls:"flashcard-progress-text"});t.createSpan({text:this.component.getCurrentGroupName()||f("Groups"),cls:"group-name"}),t.createSpan({text:"|",cls:"separator"}),[{label:f("Due"),value:A.due},{label:f("New"),value:A.newCards},{label:f("Learned"),value:A.learned},{label:f("Retention"),value:`${(A.retention*100).toFixed(1)}%`}].forEach((H,x)=>{x>0&&t.createSpan({text:"|",cls:"separator"});let M=t.createEl("div",{cls:"stat"});if(M.createSpan({text:H.label+": "}),M.createSpan({text:H.value.toString(),cls:"stat-value"}),H.label===f("Retention")){let T=M.createSpan({cls:"help-icon"});(0,mo.setIcon)(T,"help-circle"),T.setAttribute("aria-label",f(`Retention = (Total Reviews - Forget Count) / Total Reviews
This metric reflects your learning effectiveness, higher means better memory retention`))}});let l=e.createEl("div",{cls:"flashcard-progress-bar-container"}).createEl("div",{cls:"flashcard-progress-bar"}),c=A.due+A.newCards,d=this.component.getCards().length,g=c>0?Math.round((c-d)/c*100):100;if(l.style.width=`${g}%`,this.component.getCurrentGroupName()){let H=this.component.getFsrsManager().getCardGroups().find(x=>x.id===this.component.getCurrentGroupName());if(H){let x=e.createEl("div",{cls:"flashcard-group-name-container"});x.createEl("div",{cls:"flashcard-group-name",text:H.name}),H.filter&&x.createEl("div",{cls:"flashcard-group-filter",text:f("Filter")+": "+H.filter})}}let u=e.createEl("div",{cls:"flashcard-index-container"}),m=this.component.getCurrentGroupId(),v=this.component.getCards().length,F=this.component.getFsrsManager(),E=(m?F.getCardsForStudy(m):[]).length;if(E>0||v>0){let H=Math.max(E,v),x=H-v+1;v>0?u.textContent=`${x}/${H}`:u.textContent=`${H}/${H}`}else u.textContent="0/0"}saveState(){let e=this.component.getCurrentGroupName(),A=this.component.getFsrsManager().getUIState();A.currentGroupName=e,A.currentIndex=this.component.getCurrentIndex(),A.isFlipped=this.component.isCardFlipped(),A.completionMessage=this.component.getCompletionMessage(),A.groupProgress||(A.groupProgress={}),A.groupProgress[e]={currentIndex:this.component.getCurrentIndex(),isFlipped:this.component.isCardFlipped()},A.groupCompletionMessages||(A.groupCompletionMessages={}),A.groupCompletionMessages[e]=this.component.getGroupCompletionMessage(e),this.component.getFsrsManager().updateUIState(A)}};var hs=class{constructor(e){this.component=e}addPagePreview(e,A){if(!A)return;let t;e.addEventListener("mouseenter",r=>{t=setTimeout(()=>{let o=r.target;this.component.getApp().workspace.trigger("hover-link",{event:r,source:"hi-note",hoverParent:o,targetEl:o,linktext:A})},300)}),e.addEventListener("mouseleave",()=>{t&&clearTimeout(t)})}};var si=class extends Bo.Component{constructor(A,t){super();this.progressContainer=null;this.currentIndex=0;this.isFlipped=!1;this.cards=[];this.isActive=!1;this.currentCard=null;this.currentGroupName="";this.currentGroupId="";this.completionMessage=null;this.groupProgress={};this.ratingButtons=[{label:f("Again"),rating:cA.AGAIN,key:"1",ratingText:"again"},{label:f("Hard"),rating:cA.HARD,key:"2",ratingText:"hard"},{label:f("Good"),rating:cA.GOOD,key:"3",ratingText:"good"},{label:f("Easy"),rating:cA.EASY,key:"4",ratingText:"easy"}];this.container=A,this.app=t.app,this.fsrsManager=t.fsrsManager,this.renderer=new as(this),this.operations=new os(this),this.groupManager=new ls(this),this.progressManager=new cs(this),this.utils=new hs(this),this.groupProgress={};let r=this.fsrsManager.getUIState()||{};if(this.currentGroupName=r.currentGroupName||"",this.currentGroupName){let o=this.fsrsManager.getCardGroups().find(l=>l.name===this.currentGroupName);o?this.currentGroupId=o.id:this.currentGroupId=""}else this.currentGroupId="";this.completionMessage=r.completionMessage||null,r.groupProgress&&(this.groupProgress={...r.groupProgress}),this.currentGroupName&&this.groupProgress[this.currentGroupName]?(this.currentIndex=this.groupProgress[this.currentGroupName].currentIndex||0,this.isFlipped=this.groupProgress[this.currentGroupName].isFlipped||!1):(this.currentIndex=0,this.isFlipped=!1),(!r||!r.groupProgress||typeof r.groupProgress!="object")&&(this.groupProgress={}),r&&"groupProgress"in r&&r.groupProgress&&typeof r.groupProgress=="object"?this.groupProgress={...r.groupProgress}:this.groupProgress={}}setLicenseManager(A){this.licenseManager=A}setCards(A){this.cards=A}cleanup(){}async activate(){if(this.isActive=!0,this.licenseManager){let A=await this.licenseManager.isActivated(),t=A?await this.licenseManager.isFeatureEnabled("flashcard"):!1;if(A&&t){this.operations.refreshCardList(),this.renderer.render();return}}this.renderer.renderActivation()}renderActivation(){this.renderer.renderActivation()}deactivate(){this.isActive=!1,this.container.empty(),this.container.removeClass("flashcard-mode")}destroy(){this.container.removeClass("flashcard-mode"),this.container.empty()}getContainer(){return this.container}getApp(){return this.app}getFsrsManager(){return this.fsrsManager}getLicenseManager(){return this.licenseManager}getCards(){return this.cards}getCurrentIndex(){return this.currentIndex}setCurrentIndex(A){this.currentIndex=A}isCardFlipped(){return this.isFlipped}setCardFlipped(A){this.isFlipped=A}getCurrentGroupName(){return this.currentGroupName}setCurrentGroupName(A){if(this.currentGroupName=A,A){let t=this.fsrsManager.getCardGroups().find(r=>r.name===A);t?this.currentGroupId=t.id:this.currentGroupId=""}else this.currentGroupId=""}getCurrentGroupId(){return this.currentGroupId}setCurrentGroupId(A){if(this.currentGroupId=A,A){let t=this.fsrsManager.getCardGroups().find(r=>r.id===A);this.currentGroupName=t?t.name:""}else this.currentGroupName=""}getCompletionMessage(){return this.completionMessage}setCompletionMessage(A){this.completionMessage=A}getGroupCompletionMessage(A){return this.groupProgress[A]&&this.groupProgress[A].completionMessage||null}setGroupCompletionMessage(A,t){if(this.groupProgress[A]||(this.groupProgress[A]={currentIndex:0,isFlipped:!1,completionMessage:null}),this.groupProgress[A].completionMessage=t,this.fsrsManager){let r=this.fsrsManager.getUIState();r.groupProgress||(r.groupProgress={}),r.groupProgress[A]||(r.groupProgress[A]={currentIndex:0,isFlipped:!1,currentCardId:void 0,completionMessage:void 0}),r.groupProgress[A].completionMessage=t,t&&(r.groupProgress[A].isFlipped=!1,r.groupProgress[A].currentCardId=void 0),this.fsrsManager.updateUIState(r)}}getGroupProgress(A){let t=A||this.currentGroupName;return this.groupProgress[t]||null}isComponentActive(){return this.isActive}getProgressContainer(){return this.progressContainer}setProgressContainer(A){this.progressContainer=A}getRatingButtons(){return this.ratingButtons}flipCard(){this.operations.flipCard()}nextCard(){this.operations.nextCard()}rateCard(A){this.operations.rateCard(A)}refreshCardList(){this.operations.refreshCardList()}saveState(){let A=this.getCurrentGroupName(),t=this.fsrsManager.getUIState();if(t.currentGroupName=A,t.completionMessage=this.completionMessage,t.groupProgress||(t.groupProgress={}),A){let r=this.cards.length>0&&this.currentIndex<this.cards.length?this.cards[this.currentIndex].id:void 0,o=this.getGroupCompletionMessage(A);t.groupProgress[A]?(t.groupProgress[A].currentIndex=this.currentIndex,t.groupProgress[A].isFlipped=this.isFlipped,t.groupProgress[A].currentCardId=r,t.groupProgress[A].completionMessage=o):t.groupProgress[A]={currentIndex:this.currentIndex,isFlipped:this.isFlipped,currentCardId:r,completionMessage:o}}this.fsrsManager.updateUIState(t)}updateProgress(){this.progressManager.updateProgress()}getRenderer(){return this.renderer}getOperations(){return this.operations}getGroupManager(){return this.groupManager}getProgressManager(){return this.progressManager}getUtils(){return this.utils}};var ri=require("obsidian");var wo={id:"default",name:f("Default Template"),description:f("Modern minimalist knowledge card style"),render:Q=>{var F;let e=document.createElement("div");e.className="highlight-export-card highlight-export-card-modern";let A=document.createElement("div");A.className="highlight-export-quote-section";let t=document.createElement("div");t.className="highlight-export-quote-decoration";let r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("viewBox","0 0 24 24"),r.setAttribute("width","48"),r.setAttribute("height","48"),r.setAttribute("fill","none"),r.setAttribute("stroke","currentColor"),r.setAttribute("stroke-width","1");let o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d","M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z");let l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d","M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"),r.appendChild(o),r.appendChild(l),t.appendChild(r),A.appendChild(t);let c=document.createElement("div");c.className="highlight-export-quote",c.textContent=Q.text,A.appendChild(c),e.appendChild(A);let d=document.createElement("div");d.className="highlight-export-footer";let g=document.createElement("div");g.className="highlight-export-source",g.textContent=Q.fileName||((F=Q.filePath)==null?void 0:F.split("/").pop())||"Untitled",d.appendChild(g);let u=document.createElement("div");u.className="highlight-export-date";let m=new Date,v={year:"numeric",month:"long",day:"numeric"};return u.textContent=m.toLocaleDateString(void 0,v),d.appendChild(u),e.appendChild(d),e}},Wg={id:"academic",name:f("Academic Template"),description:f("Formal style suitable for academic citations"),render:Q=>{var l;let e=document.createElement("div");e.className="highlight-export-card highlight-export-card-academic";let A=document.createElement("div");A.className="highlight-export-quote",A.textContent=`"${Q.text}"`,e.appendChild(A);let t=document.createElement("div");t.className="highlight-export-footer";let r=document.createElement("div");r.className="highlight-export-source",r.textContent=Q.fileName||((l=Q.filePath)==null?void 0:l.split("/").pop())||"Untitled",t.appendChild(r);let o=document.createElement("div");return o.className="highlight-export-date",o.textContent=`Retrieved: ${new Date().toLocaleDateString()}`,t.appendChild(o),e.appendChild(t),e}},Yg={id:"social",name:f("Social Template"),description:f("Modern style suitable for social media sharing"),render:Q=>{var m;let e=document.createElement("div");e.className="highlight-export-card highlight-export-card-social";let A=document.createElement("div");A.className="highlight-export-header";let t=document.createElement("div");t.className="highlight-export-logo";let r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.setAttribute("width","24"),r.setAttribute("height","24"),r.setAttribute("viewBox","0 0 100 100"),r.setAttribute("fill","currentColor"),r.setAttribute("stroke","none");let o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d","M50,9.4L14.8,37.1l12.6,38.8l22.6,14.7l22.6-14.7l12.6-38.8L50,9.4z M50,19.5l25.5,20l-9.4,28.9L50,80.6 L33.9,68.4l-9.4-28.9L50,19.5z");let l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d","M50,19.5l-25.5,20l9.4,28.9L50,80.6V19.5z"),l.setAttribute("fill-opacity","0.3"),r.appendChild(o),r.appendChild(l),t.appendChild(r),A.appendChild(t);let c=document.createElement("div");c.className="highlight-export-app-name",c.textContent="HiNote",A.appendChild(c),e.appendChild(A);let d=document.createElement("div");d.className="highlight-export-quote",d.textContent=Q.text,e.appendChild(d);let g=document.createElement("div");g.className="highlight-export-footer";let u=document.createElement("div");return u.className="highlight-export-source",u.textContent=Q.fileName||((m=Q.filePath)==null?void 0:m.split("/").pop())||"Untitled",g.appendChild(u),e.appendChild(g),e}},Yr=[wo,Wg,Yg];function $r(Q){return Yr.find(e=>e.id===Q)||wo}var Co=`
    /* \u5BFC\u51FA\u5361\u7247\u57FA\u7840\u6837\u5F0F */
    .highlight-export-card {
        transition: all 0.3s ease;
        padding: 20px;
        background-color: #ffffff;
        border-radius: 12px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        
        /* \u6DFB\u52A0\u66F4\u4E25\u683C\u7684\u6587\u672C\u63A7\u5236 */
        font-size: 16px;
        line-height: 1.6;
        letter-spacing: normal;
        word-spacing: normal;
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }

    /* \u73B0\u4EE3\u98CE\u683C\u6A21\u677F */
    .highlight-export-card-modern {
        padding: 24px;
        position: relative;
        overflow: hidden;
    }

    .highlight-export-card-modern::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 4px;
        background: linear-gradient(to bottom right, #5871ef 0%, #4c63e6 100%);
    }

    .highlight-export-card-modern .highlight-export-quote-decoration {
        position: absolute;
        top: 24px;
        right: 24px;
        opacity: 0.06;
        transform: scale(2);
    }

    .highlight-export-card-modern .highlight-export-quote-section {
        position: relative;
        padding: 24px 0;
        /* \u786E\u4FDD\u5F15\u7528\u90E8\u5206\u7684\u6587\u672C\u6837\u5F0F\u4E00\u81F4\u6027 */
        font-size: inherit;
        line-height: inherit;
        letter-spacing: inherit;
        word-spacing: inherit;
    }

    .highlight-export-card-modern .highlight-export-quote {
        font-size: 1em;
        line-height: 1.7;
        color: #333333;
        font-weight: 400;
        margin: 0;
        position: relative;
        z-index: 1;
        /* \u786E\u4FDD\u5F15\u7528\u6587\u672C\u7684\u6837\u5F0F\u4E00\u81F4\u6027 */
        letter-spacing: normal;
        word-spacing: normal;
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
    }

    /* \u786E\u4FDD\u6240\u6709\u6587\u672C\u5143\u7D20\u7EE7\u627F\u57FA\u7840\u6837\u5F0F */
    .highlight-export-card * {
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
    }

    /* \u5BFC\u51FA\u9884\u89C8\u5BB9\u5668 */
    .highlight-export-preview {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        padding: 20px;
    }

    /* \u5BFC\u51FA\u5BB9\u5668 */
    .highlight-export-container {
        padding: 20px;
        margin: 0;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        width: 480px;
    }
`;var ds=class extends ri.Modal{constructor(A,t,r){super(A);this.selectedTemplateId="default";this.includeComments=!1;this.highlight=t,this.html2canvasInstance=r}async onOpen(){let{contentEl:A}=this;A.empty(),A.addClass("highlight-export-modal");let t=A.createEl("div",{cls:"highlight-export-main-container"}),r=t.createEl("select",{cls:"highlight-template-select"});Yr.forEach(l=>{let c=r.createEl("option",{text:l.name,value:l.id});this.selectedTemplateId===l.id&&(c.selected=!0)}),r.addEventListener("change",l=>{let c=l.target;this.selectedTemplateId=c.value,this.updatePreview()}),this.previewContainer=t.createEl("div",{cls:"highlight-export-preview-container"}),this.updatePreview();let o=A.createEl("div",{cls:"highlight-export-modal-buttons"});if(this.highlight.comments&&this.highlight.comments.length>0){let l=o.createEl("div",{cls:"highlight-export-checkbox-container"}),c=l.createEl("input",{attr:{type:"checkbox",id:"include-comments-checkbox"},cls:"highlight-export-checkbox"}),d=l.createEl("label",{text:f("Include Comments"),attr:{for:"include-comments-checkbox"},cls:"highlight-export-checkbox-label"});c.addEventListener("change",g=>{this.includeComments=g.target.checked,this.updatePreview()})}o.createEl("button",{cls:"highlight-btn",text:f("Cancel")}).addEventListener("click",()=>this.close()),o.createEl("button",{cls:"highlight-btn highlight-btn-primary",text:f("Download")}).addEventListener("click",async()=>{try{let l=document.createElement("div");l.className="highlight-export-container";let d=$r(this.selectedTemplateId).render(this.highlight);l.appendChild(d),this.includeComments&&this.highlight.comments&&this.highlight.comments.length>0&&this.addCommentsToContainer(l),document.body.appendChild(l);let u=(await this.html2canvasInstance(l,{backgroundColor:null,scale:window.devicePixelRatio*2,useCORS:!0,allowTaint:!0,logging:!1,imageTimeout:0,removeContainer:!0,onclone:async v=>{let F=v.createElement("style");F.textContent=this.getExportStyles(),v.head.appendChild(F),await new Promise(y=>setTimeout(y,100))}})).toDataURL("image/png",1),m=document.createElement("a");m.download=`highlight-${this.selectedTemplateId}-${Date.now()}.png`,m.href=u,m.click(),this.close(),new ri.Notice(f("Export successful!"))}catch(l){new ri.Notice(f("Export failed, please try again"))}})}updatePreview(){this.previewContainer.empty(),this.previewContainer.className="highlight-export-preview";let t=$r(this.selectedTemplateId).render(this.highlight);this.previewContainer.appendChild(t),this.includeComments&&this.highlight.comments&&this.highlight.comments.length>0&&this.addCommentsToContainer(this.previewContainer)}addCommentsToContainer(A){let t=A.querySelector(".highlight-export-card");if(!t)return;let r=t.querySelector(".highlight-export-footer");if(!r)return;let o=document.createElement("div");o.className="highlight-export-comments-section";let l=document.createElement("div");l.className="highlight-export-comments-list",o.appendChild(l),this.highlight.comments&&this.highlight.comments.forEach(c=>{let d=document.createElement("div");d.className="highlight-export-comment-item";let g=document.createElement("div");if(g.className="highlight-export-comment-content",g.textContent=c.content,d.appendChild(g),c.createdAt){let u=document.createElement("div");u.className="highlight-export-comment-time",u.textContent=new Date(c.createdAt).toLocaleString(),d.appendChild(u)}l.appendChild(d)}),t.insertBefore(o,r)}getExportStyles(){return`
            body {
                margin: 0;
                background: none;
            }
            ${Co}
        `}onClose(){let{contentEl:A}=this;A.empty()}};var ai=require("obsidian");var ni=class extends ai.Component{constructor(A,t,r,o=window.app){super();this.highlight=t;this.onHighlightClick=r;this.app=o;this.render(A).catch(l=>{console.error("Error rendering highlight content:",l)})}async render(A){this.container=A.createEl("div",{cls:"highlight-content"}),await this.renderText()}async renderText(){this.textContainer=this.container.createEl("div",{cls:"highlight-text-container"});let A=this.textContainer.createEl("div",{cls:"highlight-text-decorator"});this.highlight.backgroundColor&&(A.style.backgroundColor=this.highlight.backgroundColor);let r=this.textContainer.createEl("div",{cls:"highlight-text"}).createEl("div",{cls:`highlight-text-content ${this.highlight.isVirtual?"virtual-highlight":""} markdown-rendered`}),o=(this.highlight.isVirtual?this.highlight.displayText:this.highlight.text)||"";try{await ai.MarkdownRenderer.render(this.app,o,r,this.highlight.filePath||"",new ai.Component),r.querySelectorAll("ul, ol").forEach(c=>{c.addClass("highlight-markdown-list")}),await this.activateInternalLinks(r,this.highlight.filePath||"")}catch(l){console.error("Error rendering markdown in highlight:",l);let c=o.split(`
`);c.forEach((d,g)=>{let u=r.createEl("p",{text:d,cls:"highlight-text-line"});g<c.length-1&&u.addClass("highlight-text-line-spacing")})}this.highlight.isGlobalSearch?(r.addClass("global-search-highlight"),r.removeAttribute("aria-label"),r.style.cursor="default"):(r.setAttribute("aria-label",f("Jump to highlight")),r.addEventListener("mousedown",async l=>{l.target.closest("a")||(l.preventDefault(),l.stopPropagation(),await this.onHighlightClick(this.highlight))}))}async activateInternalLinks(A,t){A.querySelectorAll("a.internal-link").forEach(l=>{let c=l.getAttribute("data-href")||l.getAttribute("href");c&&(l.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this.app.metadataCache.getFirstLinkpathDest(c,t)&&this.app.workspace.openLinkText(c,t,!1)}),l.addEventListener("mouseenter",d=>{this.app.workspace.trigger("hover-link",{event:d,source:"hi-note",hoverParent:A,targetEl:l,linktext:c,sourcePath:t})}))}),A.querySelectorAll("a.tag").forEach(l=>{let c=l.getAttribute("href");c&&l.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this.app.workspace.trigger("search:open",c)})})}getContainer(){return this.container}};ni.dragPreview=null;var ps=require("obsidian"),vo=/#[\w\u4e00-\u9fa5]+/g,gs=/^\s*(#[\w\u4e00-\u9fa5]+(\s+#[\w\u4e00-\u9fa5]+)*\s*)$/,us=class extends ps.Component{constructor(A,t,r){super();this.highlight=t;this.onCommentEdit=r;this.app=window.app,this.render(A)}render(A){if((this.highlight.comments||[]).length===0)return;let r=A.createEl("div",{cls:"hi-notes-section"});this.container=r.createEl("div",{cls:"hi-notes-list"}),this.renderComments().catch(o=>{console.error("Error rendering comments:",o)})}async renderComments(){let A=this.highlight.comments||[];for(A.sort((t,r)=>{let o=gs.test(t.content),l=gs.test(r.content);return o&&!l?-1:!o&&l?1:r.updatedAt-t.updatedAt});this.container.firstChild;)this.container.removeChild(this.container.firstChild);for(let t of A){let r=gs.test(t.content),o=this.container.createEl("div",{cls:`hi-note${r?" pure-tags-comment":""}`,attr:{"data-comment-id":t.id}}),l=o.createEl("div",{cls:"hi-note-content markdown-rendered"}),c=t.content;if(gs.test(c)){let g=c,u=c.match(vo)||[];for(;l.firstChild;)l.removeChild(l.firstChild);if(u.length>0){let m=g.split(vo),v=0;m.forEach((F,y)=>{if(F&&l.appendChild(document.createTextNode(F)),y<u.length){let E=document.createElement("span");E.className="highlight-tag",E.textContent=u[y],l.appendChild(E)}})}else l.textContent=c}else try{await ps.MarkdownRenderer.renderMarkdown(c,l,this.highlight.filePath||"",this),l.querySelectorAll("ul, ol").forEach(u=>{u.addClass("comment-markdown-list")}),await this.activateInternalLinks(l,this.highlight.filePath||"")}catch(g){console.error("Error rendering markdown in comment:",g),l.textContent=c}l.addEventListener("dblclick",g=>{g.target.closest("a")||(g.stopPropagation(),g.preventDefault(),this.onCommentEdit(t))}),l.addEventListener("click",g=>{g.target.closest("a")||g.stopPropagation()});let d=o.createEl("div",{cls:"hi-note-footer"});d.createEl("div",{text:new Date(t.updatedAt).toLocaleString(),cls:"hi-note-time"}),d.createEl("span",{text:"Double click to edit",cls:"hi-note-edit-hint"}),d.createEl("div",{cls:"hi-note-actions"})}}async activateInternalLinks(A,t){A.querySelectorAll("a.internal-link").forEach(l=>{let c=l.getAttribute("data-href")||l.getAttribute("href");c&&(l.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this.app.metadataCache.getFirstLinkpathDest(c,t)&&this.app.workspace.openLinkText(c,t,!1)}),l.addEventListener("mouseenter",d=>{this.app.workspace.trigger("hover-link",{event:d,source:"hi-note",hoverParent:A,targetEl:l,linktext:c,sourcePath:t})}))}),A.querySelectorAll("a.tag").forEach(l=>{let c=l.getAttribute("href");c&&l.addEventListener("click",d=>{d.preventDefault(),d.stopPropagation(),this.app.workspace.trigger("search:open",c)})})}};var fs=class{constructor(e,A,t){this.parent=e;this.highlight=A;this.onClick=t;this.render()}render(){this.container=this.parent.createEl("div",{cls:"unfocused-comment-input"}),this.container.createEl("div",{cls:"unfocused-input-area",attr:{placeholder:f("Add comment...")}}).addEventListener("click",A=>{A.preventDefault(),A.stopPropagation(),this.onClick()})}remove(){this.container.remove()}hide(){this.container.style.display="none"}};var z=require("obsidian");var ct=class ct{static start(e,A,t={}){var d;let{showIcon:r=!0,maxLength:o=30}=t;this.clear(),this.instance=document.createElement("div"),this.instance.className="highlight-dragging";let l=document.createElement("div");l.className="highlight-dragging-content";let c=A.length>o?A.slice(0,o)+"...":A;l.textContent=c,this.instance.appendChild(l),document.body.appendChild(this.instance),this.updatePosition(e.clientX,e.clientY),(d=e.dataTransfer)==null||d.setDragImage(this.dragImage,0,0),document.addEventListener("dragover",this.handleDragOver)}static updatePosition(e,A){this.instance&&this.instance.setAttribute("style",`left: ${e+10}px; top: ${A+10}px;`)}static clear(){this.instance&&(this.instance.remove(),this.instance=null),document.removeEventListener("dragover",this.handleDragOver)}};ct.instance=null,ct.dragImage=new Image,ct.dragImage.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",ct.handleDragOver=e=>{e.preventDefault(),ct.updatePosition(e.clientX,e.clientY)};var oi=ct;var Fo=require("obsidian"),li=class{constructor(e,A){this.highlight=e;this.plugin=A}generateSync(){var A,t,r,o;let e=[];if(this.highlight.isVirtual){let l=((t=(A=this.highlight.filePath)==null?void 0:A.split("/").pop())==null?void 0:t.replace(".md",""))||"File";e.push(`> [!note] [[${l}]]`),e.push("> ")}else{e.push("> [!quote] HiNote");let l=!1;if(this.highlight.blockId){let c=this.highlight.filePath;if(!c){let d=this.plugin.app.workspace.getActiveFile();d&&(c=d.path)}if(c){let d=(r=c.split("/").pop())==null?void 0:r.replace(".md","");if(d){let g=`> ![[${d}#^${this.highlight.blockId}]]`;e.push(g),e.push("> "),l=!0}}}else if(this.highlight.filePath&&typeof this.highlight.position=="number"){let c=this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath);if(c instanceof Fo.TFile){let d=this.plugin.app.metadataCache.getFileCache(c);if(d!=null&&d.sections){let g=this.highlight.position,u=d.sections.find(m=>m.position.start.offset<=g&&m.position.end.offset>=g);if(u!=null&&u.id){let m=(o=this.highlight.filePath.split("/").pop())==null?void 0:o.replace(".md","");if(m){let v=`> ![[${m}#^${u.id}]]`;e.push(v),e.push("> "),l=!0}}}}}!l&&this.highlight.text&&(e.push(`> ${this.highlight.text}`),e.push("> "))}if(this.highlight.comments&&this.highlight.comments.length>0)for(let l of this.highlight.comments)e.push(...this.formatComment(l,!1));return e.join(`
`)}async generate(){return this.generateSync()}formatComment(e,A){let t=[],r=A?">":">>";A||t.push(">> [!note] Comment");let o=e.content.split(`
`).map(l=>(l=l.trim(),l?`${r} ${l}`:r)).join(`
`);if(t.push(o),e.updatedAt){let l=window.moment(e.updatedAt);t.push(`${r} *${l.format("YYYY-MM-DD HH:mm:ss")}*`)}return t.push(">"),t}};var Le=require("obsidian");var yt=[{id:"deepseek-chat",name:"Deepseek Chat"},{id:"deepseek-reasoner",name:"Deepseek Reasoner"}],$e=[{id:"gemini-1.5-flash",name:"Gemini 1.5 Flash"},{id:"gemini-1.5-pro",name:"Gemini 1.5 Pro"},{id:"gemini-2.0-flash",name:"Gemini 2.0 Flash"},{id:"gemini-2.0-flash-lite-preview-02-05",name:"Gemini 2.0 Flash Lite"}],Ue=[{id:"deepseek-ai/DeepSeek-V3",name:"DeepSeek V3",isCustom:!1},{id:"Qwen/Qwen2.5-7B-Instruct",name:"Qwen2.5 7B",isCustom:!1},{id:"Qwen/Qwen2.5-14B-Instruct",name:"Qwen2.5 14B",isCustom:!1},{id:"Pro/Qwen/Qwen2-7B-Instruct",name:"Qwen2 7B",isCustom:!1},{id:"Pro/THUDM/glm-4-9b-chat",name:"GLM-4 9B",isCustom:!1},{id:"google/gemma-2-9b-it",name:"Gemma2 9B",isCustom:!1}],nA={excludePatterns:"",useCustomPattern:!1,regexRules:[{id:"default-md",name:"Default Highlight",pattern:"==\\s*([\\s\\S]*?)\\s*==",color:"#ffeb3b",enabled:!0},{id:"default-mark",name:"Mark format",pattern:"<mark[^>]*>([\\s\\S]*?)</mark>",color:"#ffeb3b",enabled:!0},{id:"default-span",name:"Span format",pattern:"<span[^>]*>([\\s\\S]*?)</span>",color:"#ffeb3b",enabled:!0}],ai:{provider:"ollama",ollama:{host:"http://localhost:11434",model:""},gemini:{apiKey:"",model:"gemini-pro",baseUrl:"",isCustomModel:!1},openai:{apiKey:"",model:"gpt-4o",baseUrl:""},anthropic:{apiKey:"",model:"claude-2",apiAddress:"",isCustomModel:!1,lastCustomModel:""},deepseek:{apiKey:"",model:"deepseek-chat",baseUrl:""},prompts:{"\u{1F914} Key Insight":"{{highlight}}.Please reinterpret the above content from a fresh perspective and summarize its core idea within 200 characters."}},export:{exportPath:""}};var Et=require("obsidian"),Ut=class{constructor(e="http://localhost:11434"){this.retryAttempts=3;this.retryDelay=1e3;!e.startsWith("http://")&&!e.startsWith("https://")&&(e="http://"+e),this.baseUrl=e.replace(/\/$/,"")}async listModels(){try{await this.ensureConnection();let e=await this.makeRequest({endpoint:"/api/tags",method:"GET"});if(!e||!e.models)throw new Error("Invalid API response format");return e.models.map(A=>A.name)}catch(e){throw this.handleError(e)}}async generateCompletion(e,A){try{await this.ensureConnection();let t=await this.makeRequest({endpoint:"/api/generate",method:"POST",body:JSON.stringify({model:e,prompt:A,stream:!1})});if(!t||!t.response)throw new Error("Invalid API response format");return t.response}catch(t){throw this.handleError(t)}}async pullModel(e){try{new Et.Notice(`Downloading model ${e}...`);let A=await this.makeRequest({endpoint:"/api/pull",method:"POST",body:JSON.stringify({name:e})});if(!A.ok)throw new Error(`Failed to download model: ${A.status}`);new Et.Notice(`Model ${e} downloaded successfully`)}catch(A){throw new Error(`Failed to download model: ${A.message}`)}}async chat(e,A){var t;try{await this.ensureConnection();let r=await this.makeRequest({endpoint:"/api/chat",method:"POST",body:JSON.stringify({model:e,messages:A,stream:!1})});if(!r||!((t=r.message)!=null&&t.content))throw new Error("Invalid API response format");return r.message.content}catch(r){throw this.handleError(r)}}async ensureConnection(){if(!this.baseUrl)throw new Error("Ollama service not configured. Please set the host in settings.");if(!await this.testConnection())throw new Error("Unable to connect to Ollama service. Please ensure the service is running.")}async testConnection(){if(!this.baseUrl)return!1;try{let e=await this.makeRequest({endpoint:"/api/version",method:"GET"});return!!(e!=null&&e.version)}catch(e){return!1}}async makeRequest(e){let A=null;for(let t=1;t<=this.retryAttempts;t++)try{let r=new URL(e.endpoint,this.baseUrl).toString(),o=await(0,Et.requestUrl)({url:r,method:e.method,headers:{"Content-Type":"application/json",Accept:"application/json"},body:e.body,throw:!1});if(o.status===200)try{return o.text?JSON.parse(o.text):{}}catch(c){throw new Error("Invalid JSON response from server")}let l=`HTTP error! status: ${o.status}`;try{let c=JSON.parse(o.text);c.error&&(l=c.error)}catch(c){o.text&&(l=o.text)}throw new Error(l)}catch(r){if(A=r,t<this.retryAttempts){await this.delay(this.retryDelay*t);continue}break}throw A}handleError(e){return e.message.includes("ECONNREFUSED")?(new Et.Notice("Ollama service is not running. Please start the service."),new Error("Unable to connect to Ollama service. Please ensure the service is running.")):e instanceof TypeError&&e.message.includes("Invalid URL")?new Error(`Invalid Ollama service URL: ${this.baseUrl}`):e}delay(e){return new Promise(A=>setTimeout(A,e))}};var qr=require("obsidian"),St=class{constructor(e,A,t){this.apiKey=e,this.apiAddress=A||"https://api.anthropic.com",this.model=t||"claude-3-opus-20240229"}async generateResponse(e){try{let A=await(0,qr.requestUrl)({url:`${this.apiAddress}/v1/messages`,method:"POST",headers:{"x-api-key":this.apiKey,"anthropic-version":"2023-06-01","content-type":"application/json"},body:JSON.stringify({model:this.model,max_tokens:4096,messages:[{role:"user",content:e}]})});if(A.status!==200)throw new Error(`Anthropic API error: ${A.text}`);return A.json.content[0].text}catch(A){throw new Error("Failed to generate response from Anthropic API")}}async testConnection(){try{return(await(0,qr.requestUrl)({url:`${this.apiAddress}/v1/messages`,method:"POST",headers:{"x-api-key":this.apiKey,"anthropic-version":"2023-06-01","content-type":"application/json"},body:JSON.stringify({model:this.model,max_tokens:1,messages:[{role:"user",content:"Hi"}]})})).status===200}catch(e){return!1}}};var ms=require("obsidian"),Bs=class{constructor(e,A="gemini-pro",t){this.apiKey=e,this.model=A,this.baseUrl=t||"https://generativelanguage.googleapis.com"}updateModel(e){this.model=e}async generateResponse(e){var A,t,r,o,l;try{let c=`${this.baseUrl}/v1beta/models/${this.model}:generateContent?key=${this.apiKey}`,g=await(0,ms.requestUrl)({url:c,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:e}]}],generationConfig:{maxOutputTokens:2048,temperature:.7}})});if(g.status!==200)throw new Error(`Gemini API error (${g.status}): ${g.text}`);let u=g.json;if(!((l=(o=(r=(t=(A=u.candidates)==null?void 0:A[0])==null?void 0:t.content)==null?void 0:r.parts)==null?void 0:o[0])!=null&&l.text))throw new Error("Invalid response format from Gemini API");return u.candidates[0].content.parts[0].text}catch(c){throw c instanceof Error?c:new Error("Failed to generate response from Gemini API")}}async chat(e){var A,t,r,o,l;try{let c=`${this.baseUrl}/v1beta/models/${this.model}:generateContent?key=${this.apiKey}`,g={contents:e.map(v=>({role:v.role==="assistant"?"model":"user",parts:[{text:v.content}]})),generationConfig:{maxOutputTokens:2048,temperature:.7}},u=await(0,ms.requestUrl)({url:c,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(u.status!==200)throw new Error(`Gemini Chat API error (${u.status}): ${u.text}`);let m=u.json;if(!((l=(o=(r=(t=(A=m.candidates)==null?void 0:A[0])==null?void 0:t.content)==null?void 0:r.parts)==null?void 0:o[0])!=null&&l.text))throw new Error("Invalid response format from Gemini Chat API");return m.candidates[0].content.parts[0].text}catch(c){throw c instanceof Error?c:new Error("Failed to chat with Gemini API")}}async testConnection(){try{let e=`${this.baseUrl}/v1beta/models/${this.model}?key=${this.apiKey}`,A=await(0,ms.requestUrl)({url:e,method:"GET"});return A.status,A.status===200}catch(e){return!1}}};var Zr=require("obsidian"),ws=class{constructor(e){var A;if(!((A=e.siliconflow)!=null&&A.apiKey))throw new Error("SiliconFlow API key is required");this.settings=e,this.baseUrl=e.siliconflow.baseUrl||"https://api.siliconflow.cn/v1"}async chat(e,A){var t,r;try{let o=((t=this.settings.siliconflow)==null?void 0:t.model)||"deepseek-ai/DeepSeek-V3",l=await(0,Zr.requestUrl)({url:`${this.baseUrl}/chat/completions`,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${(r=this.settings.siliconflow)==null?void 0:r.apiKey}`},body:JSON.stringify({model:o,messages:e.map(d=>({role:d.role,content:d.content})),stream:!1})});if(l.status!==200)throw new Error(`SiliconFlow API request failed: ${l.text}`);let c=l.json;if(!c.choices||!c.choices[0]||!c.choices[0].message)throw new Error("Unexpected API response format");return c.choices[0].message.content}catch(o){throw o}}async listModels(){var e;try{let A=await(0,Zr.requestUrl)({url:`${this.baseUrl}/models`,method:"GET",headers:{Authorization:`Bearer ${(e=this.settings.siliconflow)==null?void 0:e.apiKey}`}});if(A.status!==200)throw new Error(`Failed to list models: ${A.text}`);return A.json.data.map(t=>({id:t.id,name:t.id.split("/").pop()||t.id,isCustom:!1}))}catch(A){throw A}}};var zr=require("obsidian"),Cs=class{constructor(e,A="deepseek-chat",t){this.apiKey=e;this.model=A,this.baseUrl=t||"https://api.deepseek.com/v1"}updateModel(e){this.model=e}async generateResponse(e){let A=[{role:"user",content:e}];return await this.chat(A)}async chat(e){var A,t,r;try{let o=await(0,zr.requestUrl)({url:`${this.baseUrl}/chat/completions`,method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:this.model,messages:e,temperature:.7,max_tokens:4096,frequency_penalty:0,presence_penalty:0})});if(o.status!==200)throw new Error(`Deepseek API error (${o.status}): ${o.text}`);let l=o.json;if(!((r=(t=(A=l.choices)==null?void 0:A[0])==null?void 0:t.message)!=null&&r.content))throw new Error("Invalid response format from Deepseek API");return l.choices[0].message.content}catch(o){throw o instanceof Error?o:new Error("Failed to generate response from Deepseek API")}}async testConnection(){try{return(await(0,zr.requestUrl)({url:`${this.baseUrl}/chat/completions`,method:"POST",headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"},body:JSON.stringify({model:this.model,messages:[{role:"user",content:"test"}],max_tokens:10})})).status===200}catch(e){return!1}}};var Qo=require("obsidian"),It=class{constructor(e){this.settings=e;this.anthropicService=null;this.geminiService=null;this.deepseekService=null;this.siliconflowService=null;this.currentState={provider:"",model:""};var A,t,r,o,l,c,d,g;switch((A=e.ollama)!=null&&A.host&&(this.ollamaService=new Ut(e.ollama.host)),(t=e.anthropic)!=null&&t.apiKey&&(this.anthropicService=new St(e.anthropic.apiKey,e.anthropic.apiAddress,e.anthropic.model)),(r=e.gemini)!=null&&r.apiKey&&(this.geminiService=new Bs(e.gemini.apiKey,e.gemini.model,e.gemini.baseUrl)),(o=e.deepseek)!=null&&o.apiKey&&(this.deepseekService=new Cs(e.deepseek.apiKey,e.deepseek.model,e.deepseek.baseUrl)),(l=e.siliconflow)!=null&&l.apiKey&&(this.siliconflowService=new ws(this.settings)),this.currentState.provider=e.provider,e.provider){case"gemini":this.currentState.model=((c=e.gemini)==null?void 0:c.model)||"";break;case"deepseek":this.currentState.model=((d=e.deepseek)==null?void 0:d.model)||"deepseek-chat";break;case"siliconflow":this.currentState.model=((g=e.siliconflow)==null?void 0:g.model)||"internlm/internlm2_5-7b-chat";break}}updateModel(e,A){switch(this.currentState.provider=e,this.currentState.model=A,e){case"gemini":this.geminiService&&this.geminiService.updateModel(A);break;case"deepseek":this.deepseekService&&this.deepseekService.updateModel(A);break}}async generateResponse(e,A,t){let r=e.replace("{{highlight}}",A);switch(t&&(r=r.replace("{{comment}}",t)),this.settings.provider){case"openai":return await this.callOpenAI(r);case"anthropic":return await this.callAnthropic(r);case"ollama":return await this.callOllama(r);case"gemini":return await this.callGemini(r);case"deepseek":return await this.callDeepseek(r);case"siliconflow":return await this.callSiliconFlow(r);default:throw new Error("AI service not configured")}}async chat(e){switch(this.settings.provider){case"openai":return await this.chatWithOpenAI(e);case"anthropic":return await this.chatWithAnthropic(e);case"ollama":return await this.chatWithOllama(e);case"gemini":return await this.chatWithGemini(e);case"deepseek":return await this.chatWithDeepseek(e);case"siliconflow":return await this.chatWithSiliconFlow(e);default:throw new Error("AI service not configured")}}async chatWithOpenAI(e){var r;if(!((r=this.settings.openai)!=null&&r.apiKey))throw new Error("OpenAI API Key not configured");let A=await(0,Qo.requestUrl)({url:this.settings.openai.baseUrl||"https://api.openai.com/v1/chat/completions",method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.settings.openai.apiKey}`},body:JSON.stringify({model:this.settings.openai.model,messages:e,temperature:.7})});if(A.status!==200)throw new Error(`OpenAI API request failed: ${A.text}`);return A.json.choices[0].message.content}async chatWithAnthropic(e){if(!this.anthropicService)throw new Error("Anthropic service not configured");let A=e[e.length-1];return await this.anthropicService.generateResponse(A.content)}async chatWithOllama(e){var A;if(!this.ollamaService)throw new Error("Ollama service not configured");if(!((A=this.settings.ollama)!=null&&A.model))throw new Error("Ollama model not configured");return await this.ollamaService.chat(this.settings.ollama.model,e)}async chatWithGemini(e){if(!this.geminiService)throw new Error("Gemini service not configured");return await this.geminiService.chat(e)}async chatWithSiliconFlow(e){if(!this.siliconflowService)throw new Error("SiliconFlow service not configured");try{return await this.siliconflowService.chat(e)}catch(A){throw A}}async chatWithDeepseek(e){if(!this.deepseekService)throw new Error("Deepseek service not configured");return await this.deepseekService.chat(e)}async callOpenAI(e){return await this.chatWithOpenAI([{role:"user",content:e}])}async callAnthropic(e){if(!this.anthropicService)throw new Error("Anthropic service not configured");return await this.anthropicService.generateResponse(e)}async callOllama(e){var A;if(!this.ollamaService)throw new Error("Ollama service not configured");if(!((A=this.settings.ollama)!=null&&A.model))throw new Error("Ollama model not configured");return await this.ollamaService.generateCompletion(this.settings.ollama.model,e)}async callGemini(e){if(!this.geminiService)throw new Error("Gemini service not configured");return await this.geminiService.generateResponse(e)}async callSiliconFlow(e){if(!this.siliconflowService)throw new Error("SiliconFlow service not configured");try{return await this.siliconflowService.chat([{role:"user",content:e}])}catch(A){throw A}}async callDeepseek(e){if(!this.deepseekService)throw new Error("Deepseek service not configured");return await this.deepseekService.generateResponse(e)}async testConnection(){switch(this.settings.provider){case"openai":try{return await this.chatWithOpenAI([{role:"user",content:"test"}]),!0}catch(e){return!1}case"anthropic":return this.anthropicService?await this.anthropicService.testConnection():!1;case"ollama":return this.ollamaService?await this.ollamaService.testConnection():!1;case"gemini":return this.geminiService?await this.geminiService.testConnection():!1;case"deepseek":return this.deepseekService?await this.deepseekService.testConnection():!1;default:return!1}}async listOllamaModels(){if(!this.ollamaService)throw new Error("Ollama service not configured");return await this.ollamaService.listModels()}async listGeminiModels(){if(!this.geminiService)throw new Error("Gemini service not configured");return Promise.resolve($e)}async listDeepseekModels(){if(!this.deepseekService)throw new Error("Deepseek service not configured");return Promise.resolve([{id:"deepseek-chat",name:"Deepseek Chat"},{id:"deepseek-coder",name:"Deepseek Coder"}])}async listSiliconFlowModels(){return Ue}async listOpenAIModels(){var A,t;let e=[{id:"gpt-4",name:"GPT-4",isCustom:!1},{id:"gpt-4-turbo",name:"GPT-4 Turbo",isCustom:!1},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo",isCustom:!1}];return(A=this.settings.openai)!=null&&A.isCustomModel&&((t=this.settings.openai)!=null&&t.model)&&e.push({id:this.settings.openai.model,name:this.settings.openai.model,isCustom:!0}),e}};var vs=class{constructor(e,A,t,r){var c;this.plugin=t,this.container=e,this.contentProvider=A,this.options={...r},this.initButton();let o=(c=this.plugin.app.workspace.getLeavesOfType("comment-view")[0])==null?void 0:c.view,l=o instanceof ue?o:null;l!=null&&l.registerAIButton&&l.registerAIButton(this)}destroy(){var t;document.removeEventListener("click",this.boundClickHandler);let e=(t=this.plugin.app.workspace.getLeavesOfType("comment-view")[0])==null?void 0:t.view,A=e instanceof ue?e:null;A!=null&&A.unregisterAIButton&&A.unregisterAIButton(this)}initButton(){let e=this.container.createEl("div",{cls:"highlight-ai-container"});this.options.position&&e.addClass(`highlight-ai-container-${this.options.position}`);let A=e.createEl("div",{cls:this.options.buttonClass,attr:{"aria-label":this.options.buttonLabel}});(0,Le.setIcon)(A,this.options.buttonIcon),A.addEventListener("click",t=>{t.stopPropagation(),this.toggleDropdown()}),this.aiButton=A}toggleDropdown(){let e=new Le.Menu,A=Object.entries(this.plugin.settings.ai.prompts||{});A.length>0?A.forEach(([r])=>{e.addItem(o=>o.setTitle(r).onClick(async()=>{await this.handleAIAnalysis(r)}))}):e.addItem(r=>r.setTitle(f("Please add Prompt in the settings first")).setDisabled(!0));let t=this.aiButton.getBoundingClientRect();e.showAtPosition({x:t.left-92,y:t.bottom+8})}async handleAIAnalysis(e){try{this.setLoading(!0);let A=new It(this.plugin.settings.ai),t=this.plugin.settings.ai.prompts[e];if(!t)throw new Error(f(`Not found named "${e}" Prompt`));let r=this.contentProvider.getText(),o=this.contentProvider.getComments(),l=await A.generateResponse(t,r,o);await this.options.onResponse(l),new Le.Notice(f("AI comments added"))}catch(A){new Le.Notice(f(`AI comments failed: ${A.message}`))}finally{this.setLoading(!1)}}setLoading(e){e?(this.aiButton.addClass("loading"),(0,Le.setIcon)(this.aiButton,"loader")):(this.aiButton.removeClass("loading"),(0,Le.setIcon)(this.aiButton,this.options.buttonIcon||"bot-message-square"))}getButtonElement(){return this.aiButton}};var jr=require("obsidian"),qe=class{constructor(e){this.STORAGE_KEY="flashcard-license";this.VAULT_ID_KEY="vault-id";this.API_URL="https://hi-note-license-server-production.up.railway.app";this.FEATURES=["flashcard"];this.VERIFICATION_INTERVAL_DAYS=7;this.licenseToken=null;this.plugin=e}async generateVaultId(){try{let e=await this.plugin.loadData()||{};if(e[this.VAULT_ID_KEY])return e[this.VAULT_ID_KEY];let A=this.plugin.app.vault.adapter,t=this.plugin.app.vault.getName();A&&"basePath"in A&&(t=A.basePath+"/"+t);let r=navigator.platform||"",o=[t,r].join("|"),c=new TextEncoder().encode(o),d=await crypto.subtle.digest("SHA-256",c),u=Array.from(new Uint8Array(d)).map(m=>m.toString(16).padStart(2,"0")).join("");return await this.saveVaultId(u),u}catch(e){let A=this.plugin.app.vault.getName(),r=new TextEncoder().encode(A),o=await crypto.subtle.digest("SHA-256",r),c=Array.from(new Uint8Array(o)).map(d=>d.toString(16).padStart(2,"0")).join("");return await this.saveVaultId(c),c}}async saveVaultId(e){let A=await this.plugin.loadData()||{};await this.plugin.saveData({...A,[this.VAULT_ID_KEY]:e})}async activateLicense(e){try{let A=await this.generateVaultId(),t=`${this.API_URL}/api/verify`,l=(await(0,jr.requestUrl)({url:t,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({licenseKey:e,deviceId:A})})).json;if(l.valid){let c=await this.plugin.loadData()||{};return await this.plugin.saveData({...c,[this.STORAGE_KEY]:{key:e,token:l.token,features:l.features,vaultId:A,lastVerified:Date.now()}}),this.licenseToken=l.token,!0}return!1}catch(A){let t=A instanceof Error?A.message:"Unknown error";return!1}}async isFeatureEnabled(e){var r;let A=await this.plugin.loadData(),t=A==null?void 0:A[this.STORAGE_KEY];return((r=t==null?void 0:t.features)==null?void 0:r.includes(e))||!1}async isActivated(){try{let e=await this.plugin.loadData(),A=e==null?void 0:e[this.STORAGE_KEY];return A!=null&&A.token?this.shouldVerifyLicense(A.lastVerified)?this.verifyWithServer(A):(this.licenseToken||(this.licenseToken=A.token),!0):!1}catch(e){return!1}}shouldVerifyLicense(e){return e?(Date.now()-e)/(1e3*60*60*24)>=this.VERIFICATION_INTERVAL_DAYS:!0}async verifyWithServer(e){try{let A=await this.generateVaultId(),t=e.vaultId,r=t&&t!==A,l=(await(0,jr.requestUrl)({url:`${this.API_URL}/api/verify`,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${e.token}`},body:JSON.stringify({licenseKey:e.key,deviceId:A,isDeviceChanged:r})})).json;if(!l)return!!this.licenseToken;if(l.valid){let c=await this.plugin.loadData()||{};return await this.plugin.saveData({...c,[this.STORAGE_KEY]:{...e,token:l.token||e.token,vaultId:A,lastVerified:Date.now()}}),this.licenseToken=l.token||e.token,!0}return!1}catch(A){return!!this.licenseToken}}};var $=class ${constructor(e,A,t,r,o=!1,l){this.container=e;this.highlight=A;this.plugin=t;this.options=r;this.isInMainView=o;this.isEditing=!1;this.aiButtonInstance=null;this.moreActionsDropdown=null;this.unfocusedInput=null;this.hasFlashcard=!1;this.isShowingRealInput=!1;var c;this.fileName=l,this.highlight=A,this.plugin=t,this.options=r,this.fileName=(c=this.highlight.filePath)==null?void 0:c.split("/").pop(),$.cardInstances.add(this),this.setupCommentInputEventListeners(),this.render()}static getSelectedCards(){return $.selectedCards}static clearSelection(){$.selectedCards.forEach(e=>{e.removeClass("selected")}),$.selectedCards.clear(),$.lastSelectedCard=null}static clearAllInstances(){$.cardInstances.forEach(e=>{typeof e.destroy=="function"&&e.destroy()}),$.cardInstances.clear(),$.selectedCards.clear(),$.lastSelectedCard=null}static findCardInstanceByHighlightId(e){for(let A of $.cardInstances)if(A.highlight.id===e)return A;return null}static updateCardUIByHighlightId(e){let A=$.findCardInstanceByHighlightId(e);A&&A.updateIconsAfterCardCreation()}static clearAllUnfocusedInputs(){$.cardInstances.forEach(e=>{e.unfocusedInput&&(e.unfocusedInput.remove(),e.unfocusedInput=null)})}setupCommentInputEventListeners(){let e=t=>{var r;((r=t.detail)==null?void 0:r.highlightId)===this.highlight.id&&(this.isShowingRealInput=!0,this.unfocusedInput&&(this.unfocusedInput.remove(),this.unfocusedInput=null))},A=t=>{var r;((r=t.detail)==null?void 0:r.highlightId)===this.highlight.id&&(this.isShowingRealInput=!1)};document.addEventListener("comment-input-shown",e),document.addEventListener("comment-input-closed",A),this.plugin.register(()=>{document.removeEventListener("comment-input-shown",e),document.removeEventListener("comment-input-closed",A)})}render(){this.card=this.container.createEl("div",{cls:`highlight-card ${this.highlight.isVirtual?"virtual-highlight-card":""}`,attr:{"data-highlight":JSON.stringify(this.highlight)}}),this.card.addEventListener("click",c=>{if(this.isEditing||this.isShowingRealInput)return;let d=c.target;d.closest(".hi-note-input")||d.closest(".hi-note-actions-hint")||this.selectCard(c)});let e=this.card.createEl("div",{cls:"highlight-card-title-bar"}),A=e.createEl("div",{cls:"highlight-card-title-left"}),t=e.createEl("div",{cls:"highlight-card-title-right"});if((this.isInMainView||this.highlight.isGlobalSearch)&&this.fileName){let c=A.createEl("div",{cls:"highlight-card-icon",attr:{"aria-label":f("Open (DoubleClick)")}});this.checkHasFlashcard()?((0,z.setIcon)(c,"book-heart"),c.addClass("has-flashcard")):(0,z.setIcon)(c,"file-text"),c.addEventListener("dblclick",async m=>{m.stopPropagation();let v=this.highlight.filePath||this.fileName;if(!v)return;let F=this.plugin.app.vault.getAbstractFileByPath(v);if(!F||!(F instanceof z.TFile))return;let y=this.plugin.app.workspace.getLeavesOfType("markdown"),E=this.plugin.app.workspace.activeLeaf,H=y.find(x=>x!==E);if(H||(H=this.plugin.app.workspace.getLeaf("split","vertical")),await H.openFile(F),this.highlight.position!==void 0){let x=H.view;if(x.getViewType()==="markdown"){let M=x.getViewType()==="markdown"?x.editor:null;if(M){let T=M.offsetToPos(this.highlight.position);M.setCursor(T),M.scrollIntoView({from:T,to:T},!0)}}}});let g=this.fileName?this.fileName.replace(/\.md$/,""):"",u=A.createEl("span",{text:g,cls:"highlight-card-title-text"});A.setAttribute("draggable","true"),this.highlight&&this.highlight.filePath&&typeof this.highlight.position=="number"&&this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath)instanceof z.TFile&&this.generateDragContent().catch(v=>{console.error("[HighlightCard] Error pre-generating block ID:",v)}),A.addEventListener("dragstart",async m=>{var v,F;try{if(!this.highlight||!this.highlight.text)throw new Error("Invalid highlight data");let y;try{let H=new Promise((x,M)=>{setTimeout(()=>M(new Error("Block ID generation timeout")),300)});y=await Promise.race([this.generateDragContent(),H])}catch(H){console.debug("[HighlightCard] Using sync fallback for drag content:",H),y=this.generateDragContentSync()}(v=m.dataTransfer)==null||v.setData("text/plain",y);let E=JSON.stringify(this.highlight);(F=m.dataTransfer)==null||F.setData("application/highlight",E),A.addClass("dragging"),oi.start(m,this.highlight.text)}catch(y){console.error("[HighlightCard] Error during drag start:",y),m.preventDefault(),m.stopPropagation()}}),A.addEventListener("dragend",()=>{A.removeClass("dragging"),oi.clear()}),this.addPagePreview(u,this.highlight.filePath||this.fileName)}else{let c=A.createEl("div",{cls:"highlight-card-icon"});if(this.checkHasFlashcard()?((0,z.setIcon)(c,"book-heart"),c.addClass("has-flashcard")):(0,z.setIcon)(c,"highlighter"),this.highlight.filePath&&typeof this.highlight.position=="number"){let g=this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath);if(g instanceof z.TFile&&!this.highlight.isGlobalSearch){let u=this.plugin.app.workspace.getLeavesOfType("markdown").find(m=>{let v=m.view;return v instanceof z.MarkdownView&&v.file&&v.file.path===g.path});if(u){let m=u.view;if(m.editor){let F=m.editor.offsetToPos(this.highlight.position).line+1;A.createEl("div",{cls:"highlight-line-number-badge"}).createEl("span",{text:`L${F}`,cls:"highlight-line-number"})}}}}}this.aiButtonInstance=new vs(t,{getText:()=>this.highlight.text,getComments:()=>(this.highlight.comments||[]).map(c=>c.content||"").join(`
`)},this.plugin,{onResponse:async c=>{await this.options.onAIResponse(c)},buttonClass:"highlight-title-btn highlight-ai-btn",buttonIcon:"sparkles",buttonLabel:f("AI comment"),position:"titlebar"});let o=t.createEl("div",{cls:"highlight-more-actions-container"}).createEl("div",{cls:"highlight-title-btn highlight-more-btn",attr:{"aria-label":f("More")}});(0,z.setIcon)(o,"ellipsis-vertical"),o.addEventListener("click",c=>{c.stopPropagation(),this.toggleMoreActionsDropdown(o)}),this.isInMainView&&this.fileName&&this.highlight&&this.highlight.filePath&&typeof this.highlight.position=="number"&&this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath)instanceof z.TFile&&this.generateDragContent().catch(d=>{console.error("[HighlightCard] Error pre-generating block ID:",d)});let l=this.card.createEl("div",{cls:"highlight-content"});new ni(l,this.highlight,this.options.onHighlightClick),new us(this.card,this.highlight,c=>{this.isEditing=!0,this.selectCard(),this.options.onCommentEdit(this.highlight,c)})}showUnfocusedCommentInput(){if(this.unfocusedInput&&(this.unfocusedInput.remove(),this.unfocusedInput=null),this.isEditing||this.isShowingRealInput)return;let e=this.card.querySelector(".highlight-content");e&&(this.unfocusedInput=new fs(e,this.highlight,()=>{this.unfocusedInput&&(this.unfocusedInput.remove(),this.unfocusedInput=null),this.options.onCommentAdd(this.highlight)}))}static findCardInstanceByElement(e){for(let A of $.cardInstances)if(A.card===e||A.card.contains(e))return A;return null}showCommentInput(){$.clearAllUnfocusedInputs(),this.unfocusedInput&&(this.unfocusedInput.remove(),this.unfocusedInput=null),this.options.onCommentAdd(this.highlight)}selectCard(e){if($.clearAllUnfocusedInputs(),e&&e.shiftKey&&$.lastSelectedCard){this.card.hasClass("selected")?(this.card.removeClass("selected"),$.selectedCards.delete(this.card)):($.selectedCards.add($.lastSelectedCard),$.selectedCards.add(this.card),this.card.addClass("selected"));let r=new CustomEvent("highlight-multi-select",{detail:{selectedCards:Array.from($.selectedCards),lastSelected:this.card},bubbles:!0});this.card.dispatchEvent(r)}else document.querySelectorAll(".highlight-card.selected").forEach(r=>{r!==this.card&&r.removeClass("selected")}),$.selectedCards.forEach(r=>{r!==this.card&&r.removeClass("selected")}),$.selectedCards.clear(),$.selectedCards.add(this.card),this.card.addClass("selected");let A=new CustomEvent("highlight-multi-select",{detail:{selectedCards:Array.from($.selectedCards),lastSelected:this.card},bubbles:!0});this.card.dispatchEvent(A),e!=null&&e.shiftKey||this.showUnfocusedCommentInput(),$.lastSelectedCard=this.card}getElement(){return this.card}addPagePreview(e,A){if(!A)return;let t=this.plugin.app.vault.getAbstractFileByPath(A);if(!(t instanceof z.TFile))return;let r;e.addEventListener("mouseenter",o=>{r=setTimeout(async()=>{let l=o.target;this.plugin.app.workspace.trigger("hover-link",{event:o,source:"hi-note",hoverParent:l,targetEl:l,linktext:t.path})},300)}),e.addEventListener("mouseleave",()=>{r&&clearTimeout(r)})}update(e){this.highlight=e,this.isEditing=!1,this.card.empty(),this.render()}generateDragContentSync(){return new li(this.highlight,this.plugin).generateSync()}async generateDragContent(){return new li(this.highlight,this.plugin).generate()}copyHighlightContent(){try{let e=`> [!quote] HiNote
`;if(e+=`> ${this.highlight.text}`,this.highlight.filePath){let A=this.fileName||this.highlight.filePath.split("/").pop()||this.highlight.filePath;e+=`
> 
`,e+=`> From: [[${A}]]`}e+=`

`,navigator.clipboard.writeText(e).then(()=>{new z.Notice("Copied")}).catch(A=>{console.error("\u590D\u5236\u5185\u5BB9\u5931\u8D25:",A),new z.Notice("Failed to copy content")})}catch(e){console.error("\u590D\u5236\u9AD8\u4EAE\u5185\u5BB9\u65F6\u51FA\u9519:",e),new z.Notice("Failed to copy content")}}handleExportAsImage(){this.options.onExport(this.highlight)}toggleMoreActionsDropdown(e){let A=new z.Menu;this.hasFlashcard=this.checkHasFlashcard(),A.addItem(r=>r.setTitle(this.hasFlashcard?f("Delete HiCard"):f("Create HiCard")).onClick(()=>this.handleCreateHiCard())),A.addItem(r=>r.setTitle(f("Copy Highlight")).onClick(()=>this.copyHighlightContent())),A.addItem(r=>r.setTitle(f("Export as Image")).onClick(()=>this.handleExportAsImage())),A.addItem(r=>r.setTitle(f("Delete")).onClick(()=>this.handleDeleteHighlight()));let t=e.getBoundingClientRect();A.showAtPosition({x:t.left-100,y:t.bottom+8})}hasVisibleMoreDropdown(){return $.visibleDropdowns.size>0}static addVisibleDropdown(e){$.isGlobalListenerAdded||(document.addEventListener("click",$.handleDocumentClick,!0),$.isGlobalListenerAdded=!0),$.visibleDropdowns.add(e)}static removeVisibleDropdown(e){$.visibleDropdowns.delete(e)}checkHasFlashcard(){let e=this.plugin.fsrsManager;if(!e||!this.highlight.id)return!1;let A=e.findCardsBySourceId(this.highlight.id,"highlight");return A&&A.length>0}async handleCreateHiCard(){try{let e=new qe(this.plugin),A=await e.isActivated(),t=A?await e.isFeatureEnabled("flashcard"):!1;if(!A||!t){new z.Notice(f("Only HiNote Pro"));return}if(!this.plugin.fsrsManager){new z.Notice(f("FSRS \u7BA1\u7406\u5668\u672A\u521D\u59CB\u5316"));return}let o=this.checkHasFlashcard();this.hasFlashcard=o,o?await this.handleDeleteHiCard():await this.handleCreateNewHiCard()}catch(e){console.error("\u5904\u7406\u95EA\u5361\u64CD\u4F5C\u65F6\u51FA\u9519:",e),new z.Notice(f(`\u64CD\u4F5C\u5931\u8D25: ${e.message}`))}}async deleteHiCardForHighlight(e=!1){try{return await this.handleDeleteHiCard(e),!0}catch(A){return console.error("\u5220\u9664\u95EA\u5361\u65F6\u51FA\u9519:",A),!1}}async handleDeleteHiCard(e=!1){try{let A=this.plugin.fsrsManager;if(!A){e||new z.Notice(f("FSRS \u7BA1\u7406\u5668\u672A\u521D\u59CB\u5316"));return}if(A.deleteCardsBySourceId(this.highlight.id||"","highlight")>0){this.hasFlashcard=!1;let r=A.cleanupInvalidCardReferences();!(this.highlight.comments&&this.highlight.comments.length>0)&&!e?(await this.deleteHighlightCompletely(),e||new z.Notice(f("Flashcard and highlight deleted"))):e||new z.Notice(f("Flashcard deleted, highlight and comments preserved")),this.updateIconsAfterCardDeletion(),e||this.plugin.eventManager.emitFlashcardChanged()}else e||new z.Notice(f("Flashcard not found"))}catch(A){console.error("\u5220\u9664\u95EA\u5361\u65F6\u51FA\u9519:",A),e||new z.Notice(f(`Failed to delete flashcard: ${A.message}`))}}async deleteHighlightCompletely(){try{if(this.highlight.filePath){let e=this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath);if(e instanceof z.TFile){let A=window.app.plugins.plugins["hi-note"];A&&A.commentStore?await A.commentStore.removeComment(e,this.highlight):console.warn("\u65E0\u6CD5\u8BBF\u95EE commentStore"),this.plugin.eventManager.emitHighlightDelete(this.highlight.filePath,this.highlight.text||"",this.highlight.id||"")}}}catch(e){throw console.error("\u5220\u9664\u9AD8\u4EAE\u65F6\u51FA\u9519:",e),e}}async createHiCardForHighlight(e=!1){try{return await this.handleCreateNewHiCard(e),!0}catch(A){return console.error("\u521B\u5EFA\u95EA\u5361\u65F6\u51FA\u9519:",A),!1}}async handleCreateNewHiCard(e=!1){let A=this.plugin.fsrsManager;if(!A){new z.Notice(f("FSRS \u7BA1\u7406\u5668\u672A\u521D\u59CB\u5316"));return}if(this.highlight.id||(console.warn("\u9AD8\u4EAE\u7F3A\u5C11 ID\uFF0C\u6B63\u5728\u751F\u6210..."),this.highlight.id=`highlight-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),this.highlight.filePath)try{let u=this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath);if(u instanceof z.TFile){let m={id:this.highlight.id,text:this.highlight.text||"",position:this.highlight.position||0,comments:this.highlight.comments||[],createdAt:this.highlight.createdAt||Date.now(),updatedAt:this.highlight.updatedAt||Date.now(),isVirtual:this.highlight.isVirtual,filePath:this.highlight.filePath,fileType:this.highlight.fileType,displayText:this.highlight.displayText,paragraphOffset:this.highlight.paragraphOffset,backgroundColor:this.highlight.backgroundColor,isCloze:this.highlight.isCloze},v=window.app.plugins.plugins["hi-note"];v&&v.commentStore?await v.commentStore.addComment(u,m):console.warn("\u65E0\u6CD5\u8BBF\u95EE commentStore")}}catch(u){console.error("\u4FDD\u5B58\u9AD8\u4EAE\u65F6\u51FA\u9519:",u)}else console.warn("\u9AD8\u4EAE\u5BF9\u8C61\u7F3A\u5C11\u6587\u4EF6\u8DEF\u5F84");let t=this.highlight.text||"",r="",o=/\{\{([^{}]+)\}\}/g,l,c=[];for(;(l=o.exec(t))!==null;)c.push(l[1]);let d=[];if(c.length>0&&d.push(c.join(`
`)),this.highlight.comments&&this.highlight.comments.length>0&&d.push(this.highlight.comments.map(u=>u.content||"").join(`
`)),r=d.length>0?d.join(`

`):f("Add answer"),!A.addCard(t,r,this.highlight.filePath||this.fileName,this.highlight.id,"highlight")){new z.Notice(f("Failed to create flashcard, please check highlight content"));return}this.plugin.eventManager.emitFlashcardChanged(),e||new z.Notice(f("Flashcard created successfully!")),this.hasFlashcard=!0,this.updateIconsAfterCardCreation()}updateIconsAfterCardDeletion(){this.card.querySelectorAll(".highlight-card-icon").forEach(A=>{(0,z.setIcon)(A,"file-text"),A.removeClass("has-flashcard")})}updateIconsAfterCardCreation(){this.card.querySelectorAll(".highlight-card-icon").forEach(A=>{(0,z.setIcon)(A,"book-heart"),A.addClass("has-flashcard")})}updateCreateHiCardButtonText(){let e=this.card.querySelector(".create-hicard-btn");e&&(e.textContent=this.hasFlashcard?f("Delete HiCard"):f("Create HiCard"))}async handleDeleteHighlight(e=!1,A=!1){try{if(!e&&!confirm(f("Delete this highlight and all its data, including Comments and HiCards? Can't undo.")))return;if(this.hasFlashcard&&await this.handleDeleteHiCard(!0),this.highlight.filePath){let t=this.plugin.app.vault.getAbstractFileByPath(this.highlight.filePath);if(t instanceof z.TFile){let r=window.app.plugins.plugins["hi-note"];r&&r.commentStore?await r.commentStore.removeComment(t,this.highlight):console.warn("\u65E0\u6CD5\u8BBF\u95EE commentStore"),await this.removeHighlightFormatFromEditor(t),this.plugin.eventManager.emitHighlightDelete(this.highlight.filePath,this.highlight.text||"",this.highlight.id||""),A||new z.Notice(f("Successfully deleted")),this.card.remove(),$.cardInstances.delete(this)}}else console.warn("\u9AD8\u4EAE\u5BF9\u8C61\u7F3A\u5C11\u6587\u4EF6\u8DEF\u5F84"),new z.Notice(f("\u5220\u9664\u9AD8\u4EAE\u5931\u8D25\uFF1A\u7F3A\u5C11\u6587\u4EF6\u8DEF\u5F84"))}catch(t){console.error("\u5220\u9664\u9AD8\u4EAE\u65F6\u51FA\u9519:",t),new z.Notice(f(`\u5220\u9664\u9AD8\u4EAE\u5931\u8D25: ${t.message}`))}}async removeHighlightFormatFromEditor(e){let A=null,t="",r=this.plugin.app.workspace.getActiveViewOfType(z.MarkdownView);if(r&&r.file&&r.file.path===e.path&&(A=r.editor),A?t=A.getValue():t=await this.plugin.app.vault.read(e),typeof this.highlight.position=="number"){let o=this.highlight.position,l=this.highlight.text,c=t.substring(Math.max(0,o-100),o),d=t.substring(o+l.length,Math.min(t.length,o+l.length+100)),g=[new RegExp(`==\\s*(${this.escapeRegExp(l)})\\s*==`,"g"),new RegExp(`<mark[^>]*>(${this.escapeRegExp(l)})</mark>`,"g"),new RegExp(`<span[^>]*>(${this.escapeRegExp(l)})</span>`,"g")],u=t,m=!1,v=t;for(let F of g)if(v.match(F)){u=v.replace(F,l),m=!0;break}if(!m){let F=window.app.plugins.plugins["hi-note"];if(F&&F.settings&&F.settings.customHighlightRegex)try{let y=new RegExp(F.settings.customHighlightRegex,"g"),E=v.match(y);if(E)for(let H of E)H.includes(l)&&(u=u||v,u=u.replace(H,l),m=!0)}catch(y){console.error("\u81EA\u5B9A\u4E49\u6B63\u5219\u8868\u8FBE\u5F0F\u9519\u8BEF:",y)}}if(!m){let F=this.escapeRegExp(l),y=new RegExp(`==\\s*(${F})\\s*==`,"g");u=t.replace(y,l);let E=new RegExp(`<mark[^>]*>(${F})</mark>`,"g");u=u.replace(E,l);let H=new RegExp(`<span[^>]*>(${F})</span>`,"g");u=u.replace(H,l)}A?A.setValue(u):await this.plugin.app.vault.modify(e,u)}else{let o=this.highlight.text,l=this.escapeRegExp(o),c=[new RegExp(`==\\s*(${l})\\s*==`,"g"),new RegExp(`<mark[^>]*>(${l})</mark>`,"g"),new RegExp(`<span[^>]*>(${l})</span>`,"g")],d=t,g=!1;for(let u of c){let m=d.replace(u,o);if(m!==d){d=m,g=!0;break}}if(!g){let u=window.app.plugins.plugins["hi-note"];if(u&&u.settings&&u.settings.customHighlightRegex)try{let m=new RegExp(u.settings.customHighlightRegex,"g"),v=d.replace(m,(F,...y)=>{for(let E of y)if(typeof E=="string"&&E.includes(o))return o;return F});v!==d&&(d=v,g=!0)}catch(m){console.error("\u81EA\u5B9A\u4E49\u6B63\u5219\u8868\u8FBE\u5F0F\u9519\u8BEF:",m)}}if(!g){let u=new RegExp(`==\\s*${l}\\s*==`,"g");d=t.replace(u,o)}A?A.setValue(d):await this.plugin.app.vault.modify(e,d)}}escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}destroy(){this.unfocusedInput&&(this.unfocusedInput.remove(),this.unfocusedInput=null),this.moreActionsDropdown&&(this.moreActionsDropdown.remove(),this.moreActionsDropdown=null),$.cardInstances.delete(this)}};window.HighlightCard={findCardInstanceByHighlightId:$.findCardInstanceByHighlightId},$.selectedCards=new Set,$.lastSelectedCard=null,$.cardInstances=new Set,$.visibleDropdowns=new Set,$.isGlobalListenerAdded=!1,$.handleDocumentClick=e=>{for(let A of $.visibleDropdowns){let t=A.closest(".highlight-card");t&&!t.contains(e.target)&&!A.contains(e.target)&&(A.classList.add("hi-note-hidden"),$.visibleDropdowns.delete(A))}};var UA=$;var hi=require("obsidian");var Fs=class{static shouldExclude(e,A){if(!A||A.trim().length===0)return!1;let t=A.split(",").map(l=>l.trim()).filter(l=>l.length>0),r=e.path,o=e.basename;return t.some(l=>{if(l=l.trim(),!l)return!1;if(l.startsWith("[[")&&l.endsWith("]]")){let g=l.slice(2,-2);return o===g}if(l.startsWith("*.")){let g=l.slice(2);return e.extension===g||r.endsWith(g)}let c=l.replace(/^\/+/,""),d=r.replace(/^\/+/,"");return d.startsWith(c+"/")||d===c})}};var ci=class{extractColorFromStyle(e){if(!e)return null;let A=e.match(/background(?:-color)?:\s*((?:rgba?\(.*?\)|#[0-9a-fA-F]{3,8}|var\(--[^)]+\)))/);return A?A[1]:null}extractColorFromElement(e){let A=e.match(/style=["']([^"']*)["']/);return A?this.extractColorFromStyle(A[1]):null}};ci.COLOR_PATTERNS=[/rgba?\(\d+,\s*\d+,\s*\d+(?:,\s*[0-9.]+)?\)/,/#[0-9a-fA-F]{3,8}/,/var\(--[^)]+\)/];var yo=require("obsidian"),Ze=class{constructor(e){this.app=e;this.events=new yo.Events}emitHighlightUpdate(e,A,t,r){this.events.trigger("highlight:update",e,A,t,r)}emitHighlightDelete(e,A,t){this.events.trigger("highlight:delete",e,A,t)}emitCommentUpdate(e,A,t,r){this.events.trigger("comment:update",e,A,t,r)}emitCommentDelete(e,A,t){this.events.trigger("comment:delete",e,A,t)}emitFlashcardChanged(){this.events.trigger("flashcard:changed")}on(e,A){return this.events.on(e,A)}off(e,A){this.events.off(e,A)}};var Te=class Te{constructor(e){this.app=e}getOrCreateBlockId(e,A){let t=e.getLine(A),r=t.match(Te.BLOCK_ID_REGEX);if(r)return r[1];let o="";for(let c=0;c<7;c++)o+=Te.BLOCK_ID_CHARS.charAt(Math.floor(Math.random()*Te.BLOCK_ID_CHARS.length));let l=t.trimEnd();return e.setLine(A,`${l} ^${o}`),o}extractBlockId(e){let A=e.match(Te.BLOCK_ID_REGEX);return A?A[1]:void 0}getParagraphBlockId(e,A){let t=this.app.metadataCache.getFileCache(e);if(!(t!=null&&t.sections))return;let r=t.sections.find(o=>o.position.start.offset<=A&&o.position.end.offset>=A);return r!=null&&r.id?`${e.path}#^${r.id}`:void 0}async createParagraphBlockId(e,A,t){let r=this.getParagraphBlockId(e,A);if(r)return r;let o=this.app.workspace.getLeaf();await o.openFile(e,{active:!1});let c=o.view.editor,g=c.offsetToPos(A).line,u=this.app.metadataCache.getFileCache(e);if(u!=null&&u.sections){let v=t||A,F=u.sections.find(y=>y.position.start.offset<=v&&y.position.end.offset>=v);F&&(g=c.offsetToPos(F.position.end.offset).line,console.debug(`[BlockIdService] \u627E\u5230\u5305\u542B\u9AD8\u4EAE\u7684\u6BB5\u843D\uFF0C\u7ED3\u675F\u884C: ${g}`))}let m=this.getOrCreateBlockId(c,g);return await this.app.vault.modify(e,c.getValue()),`${e.path}#^${m}`}hasValidBlockId(e){return Te.BLOCK_ID_REGEX.test(e)}};Te.BLOCK_ID_REGEX=/\^([a-zA-Z0-9-]+)$/,Te.BLOCK_ID_CHARS="abcdefghijklmnopqrstuvwxyz0123456789";var Ht=Te;var Qs=class Qs{constructor(e){this.app=e;this.fileIndex={wordToFiles:new Map,fileToHighlights:new Map,lastUpdated:0};this.isIndexing=!1;var r;let A=e.plugins,t=A&&A.plugins?A.plugins["hi-note"]:void 0;this.settings=t==null?void 0:t.settings,this.colorExtractor=new ci,this.eventManager=new Ze(e),this.blockIdService=new Ht(e),console.debug("[HighlightService] Current settings:",this.settings),console.debug("[HighlightService] Exclude patterns:",(r=this.settings)==null?void 0:r.excludePatterns)}async initialize(){this.registerFileEventHandlers(),setTimeout(()=>{this.buildFileIndex().then(()=>{})},3e3)}destroy(){this.unregisterFileEventHandlers(),this.fileIndex={wordToFiles:new Map,fileToHighlights:new Map,lastUpdated:0}}registerFileEventHandlers(){this.fileCreateEventRef=this.app.vault.on("create",e=>{e instanceof hi.TFile&&e.extension==="md"&&this.updateFileInIndex(e)}),this.fileModifyEventRef=this.app.vault.on("modify",e=>{e instanceof hi.TFile&&e.extension==="md"&&this.updateFileInIndex(e)}),this.fileDeleteEventRef=this.app.vault.on("delete",e=>{e instanceof hi.TFile&&e.extension==="md"&&this.removeFileFromIndex(e.path)}),this.fileRenameEventRef=this.app.vault.on("rename",(e,A)=>{e instanceof hi.TFile&&e.extension==="md"&&(this.removeFileFromIndex(A),this.updateFileInIndex(e))})}unregisterFileEventHandlers(){this.app.vault.offref(this.fileCreateEventRef),this.app.vault.offref(this.fileModifyEventRef),this.app.vault.offref(this.fileDeleteEventRef),this.app.vault.offref(this.fileRenameEventRef)}shouldProcessFile(e){var A;return!Fs.shouldExclude(e,((A=this.settings)==null?void 0:A.excludePatterns)||"")}extractHighlights(e,A){var r;let t=[];if(this.settings.useCustomPattern&&((r=this.settings.regexRules)==null?void 0:r.length)>0)for(let o of this.settings.regexRules.filter(l=>l.enabled))try{let l=new RegExp(o.pattern,"g");this.processRegexMatches(e,l,t,A,o.color)}catch(l){console.error(`[HighlightService] \u6B63\u5219\u89C4\u5219 "${o.name}" \u9519\u8BEF:`,l)}else this.processRegexMatches(e,Qs.DEFAULT_HIGHLIGHT_PATTERN,t,A,"#ffeb3b");return t.sort((o,l)=>{var c,d;return((c=o.position)!=null?c:0)-((d=l.position)!=null?d:0)})}processRegexMatches(e,A,t,r,o){let l=[];if(r){let g=this.app.metadataCache.getFileCache(r);g!=null&&g.sections&&(l=g.sections.filter(m=>["code","codeblock","fenced_code","pre"].includes(m.type)).map(m=>[m.position.start.offset,m.position.end.offset]))}function c(g,u,m){return m.some(([v,F])=>Math.max(g,v)<Math.min(u,F))}let d;for(;(d=A.exec(e))!==null;){let g=d,u=g[0],m=g.index,v=m+u.length;if(c(m,v,l))continue;let F=g.slice(1).find(H=>H!==void 0);F||(F=u);let y=null;if(u.includes("style=")&&(y=this.colorExtractor.extractColorFromElement(u)),!t.some(H=>typeof H.position=="number"&&Math.abs(H.position-g.index)<10&&H.text===F)&&F&&r){let H=this.app.metadataCache.getFileCache(r);if(H!=null&&H.sections){let x=H.sections.find(N=>N.position.start.offset<=g.index&&N.position.end.offset>=g.index),M=x==null?void 0:x.id;if(!M){let N=this.blockIdService.getParagraphBlockId(r,g.index);if(N){let J=N.match(/#\^([a-zA-Z0-9-]+)/);J&&J[1]&&(M=J[1])}}let T=/\{\{([^{}]+)\}\}/.test(F),R={text:F,position:g.index,paragraphOffset:this.getParagraphOffset(e,g.index),backgroundColor:y||o,id:`highlight-${Date.now()}-${g.index}`,comments:[],createdAt:Date.now(),updatedAt:Date.now(),originalLength:u.length,blockId:M,isCloze:T,filePath:r.path};t.push(R)}}}}getParagraphOffset(e,A){let t=e.substring(0,A),r=t.split(/\n\s*\n/);return t.length-r[r.length-1].length}async getFilesWithHighlights(){let e=this.app.vault.getMarkdownFiles(),A=[],t=0;for(let r of e){if(!this.shouldProcessFile(r))continue;let o=await this.app.vault.read(r),l=this.extractHighlights(o,r);l.length>0&&(A.push(r),t+=l.length)}return A}async getAllHighlights(){let e=this.app.vault.getMarkdownFiles(),A=[];for(let t of e){if(!this.shouldProcessFile(t))continue;let r=await this.app.vault.read(t),o=this.extractHighlights(r,t);o.length>0&&A.push({file:t,highlights:o})}return A}async buildFileIndex(){var A,t;if(this.isIndexing)return;this.isIndexing=!0;let e=Date.now();try{let r=await this.getAllHighlights(),o=new Map,l=new Map;for(let{file:c,highlights:d}of r){let g=d.map(m=>({...m,fileName:c.basename,filePath:c.path}));l.set(c.path,g);let u=new Set;for(let m of d){let v=this.tokenizeText(m.text);for(let F of v)u.add(F);if((A=m.comments)!=null&&A.length)for(let F of m.comments){let y=this.tokenizeText(F.content);for(let E of y)u.add(E)}}for(let m of u)o.has(m)||o.set(m,new Set),(t=o.get(m))==null||t.add(c.path)}this.fileIndex={wordToFiles:o,fileToHighlights:l,lastUpdated:Date.now()}}catch(r){console.error("\u6784\u5EFA\u7D22\u5F15\u65F6\u51FA\u9519:",r)}finally{this.isIndexing=!1}}tokenizeText(e){return e?e.toLowerCase().split(/\s+/).filter(t=>t.length>=2).map(t=>t.replace(/[.,;:!?()\[\]{}'"`~]/g,"")).filter(t=>t.length>=2):[]}removeFileFromIndex(e){if(!(this.fileIndex.lastUpdated===0||Date.now()-this.fileIndex.lastUpdated>36e5))try{if(this.fileIndex.fileToHighlights.has(e)){for(let[A,t]of this.fileIndex.wordToFiles.entries())t.delete(e),t.size===0&&this.fileIndex.wordToFiles.delete(A);this.fileIndex.fileToHighlights.delete(e)}}catch(A){console.error(`[HighlightService] \u79FB\u9664\u6587\u4EF6 ${e} \u7D22\u5F15\u65F6\u51FA\u9519:`,A)}}async updateFileInIndex(e){var A,t;if(!(this.fileIndex.lastUpdated===0||Date.now()-this.fileIndex.lastUpdated>36e5))try{if(this.removeFileFromIndex(e.path),this.shouldProcessFile(e)){let r=await this.app.vault.read(e),o=this.extractHighlights(r,e);if(o.length>0){let l=o.map(d=>({...d,fileName:e.basename,filePath:e.path}));this.fileIndex.fileToHighlights.set(e.path,l);let c=new Set;for(let d of o){let g=this.tokenizeText(d.text);for(let u of g)c.add(u);if((A=d.comments)!=null&&A.length)for(let u of d.comments){let m=this.tokenizeText(u.content);for(let v of m)c.add(v)}}for(let d of c)this.fileIndex.wordToFiles.has(d)||this.fileIndex.wordToFiles.set(d,new Set),(t=this.fileIndex.wordToFiles.get(d))==null||t.add(e.path)}}}catch(r){console.error(`\u66F4\u65B0\u6587\u4EF6 ${e.path} \u7684\u7D22\u5F15\u65F6\u51FA\u9519:`,r)}}async searchHighlightsFromIndex(e){var c;if((Date.now()-this.fileIndex.lastUpdated>36e5||this.fileIndex.fileToHighlights.size===0)&&await this.buildFileIndex(),!e.trim()){let d=[];for(let g of this.fileIndex.fileToHighlights.values())d.push(...g);return d}let t=this.tokenizeText(e);if(t.length===0){let d=[];for(let g of this.fileIndex.fileToHighlights.values())d.push(...g);return d}let r=[];for(let d of t){let g=new Set;for(let[u,m]of this.fileIndex.wordToFiles.entries())if(u.includes(d))for(let v of m)g.add(v);r.push(g)}let o;if(r.length>0){o=r[0];for(let d=1;d<r.length;d++)o=new Set([...o].filter(g=>r[d].has(g)))}else o=new Set;let l=[];for(let d of o){let g=this.fileIndex.fileToHighlights.get(d)||[];for(let u of g){let m=u.text.toLowerCase(),v=((c=u.comments)==null?void 0:c.map(y=>y.content.toLowerCase()))||[];t.every(y=>m.includes(y)||v.some(E=>E.includes(y)))&&l.push(u)}}return l}async createBlockIdForHighlight(e,A,t){try{let r=this.blockIdService.getParagraphBlockId(e,A);if(r)return r;let o=t?A+t:A;return await this.blockIdService.createParagraphBlockId(e,A,o)}catch(r){throw console.error("[HighlightService] Error creating block ID for highlight:",r),r}}};Qs.DEFAULT_HIGHLIGHT_PATTERN=/==\s*([\s\S]*?)\s*==|<mark[^>]*>([\s\S]*?)<\/mark>|<span[^>]*>([\s\S]*?)<\/span>/g;var oe=Qs;var di=require("obsidian");var we=class{constructor(e){this.app=e;this.SIMILARITY_THRESHOLD=.7;this.MAX_SEARCH_RANGE=5e3;this.POSITION_WEIGHT=.3;this.POSITION_TOLERANCE=100}levenshteinDistance(e,A){if(e===A)return 0;if(e.length===0)return A.length;if(A.length===0)return e.length;let t=[];for(let r=0;r<=e.length;r++)t[r]=[r];for(let r=0;r<=A.length;r++)t[0][r]=r;for(let r=1;r<=e.length;r++)for(let o=1;o<=A.length;o++)e[r-1]===A[o-1]?t[r][o]=t[r-1][o-1]:t[r][o]=Math.min(t[r-1][o-1]+1,t[r][o-1]+1,t[r-1][o]+1);return t[e.length][A.length]}calculateSimilarity(e,A){let t=this.levenshteinDistance(e,A),r=Math.max(e.length,A.length);return r===0?1:1-t/r}findBestMatch(e,A,t,r){if(e.length<10){if(t!==void 0&&t>=0){let F=Math.max(0,t-this.POSITION_TOLERANCE),y=Math.min(A.length,t+this.POSITION_TOLERANCE),H=A.substring(F,y).indexOf(e);if(H!==-1)return{text:e,position:F+H}}let v=A.indexOf(e);return v!==-1?{text:e,position:v}:null}let o=r||this.SIMILARITY_THRESHOLD,l=A,c=0;if(t!==void 0&&t>=0){let v=this.MAX_SEARCH_RANGE/2,F=Math.max(0,t-v),y=Math.min(A.length,t+v);l=A.substring(F,y),c=F}let d=this.extractPossibleMatches(l,e.length),g=null,u=0,m=-1;for(let v of d){let F=this.calculateSimilarity(e,v.text);if(F<o)continue;let y=1;if(t!==void 0&&t>=0){let x=v.position+c,M=Math.abs(x-t);y=Math.max(0,1-M/(this.POSITION_TOLERANCE*2))}let E=F*(1-this.POSITION_WEIGHT)+y*this.POSITION_WEIGHT,H=F===1?F*.5+y*.5:E;H>u&&(u=H,g=v.text,m=v.position)}return g&&m!==-1?{text:g,position:m+c}:null}extractPossibleMatches(e,A){let t=[],r=new Set,o=Math.max(3,Math.floor(A*.9)),l=Math.ceil(A*1.1);for(let g=o;g<=l;g++){let u=Math.max(1,Math.floor(g/4));for(let m=0;m<e.length-g+1;m+=u){let v=e.substring(m,m+g),F=`${m}:${v.length}`;r.has(F)||(t.push({text:v,position:m}),r.add(F))}}let c=e.split(/[.!?。！？;；:\n\r]+/),d=0;for(let g of c){let u=g.trim();if(u.length>=o&&u.length<=l*2&&(d=e.indexOf(u,d),d!==-1)){let m=`${d}:${u.length}`;r.has(m)||(t.push({text:u,position:d}),r.add(m)),d+=u.length}}return t}};var ys=class{constructor(e){this.app=e;this.textSimilarityService=new we(e)}async jumpToHighlight(e,A){let t=await this.openOrActivateFile(A);t&&await this.locateAndHighlightText(t,e.text,e.position)}async openOrActivateFile(e){let t=this.app.workspace.getLeavesOfType("markdown").find(r=>{var l;return((l=r.view.file)==null?void 0:l.path)===e});if(!t)try{let r=this.app.vault.getAbstractFileByPath(e);if(!r)return new di.Notice("\u672A\u627E\u5230\u6587\u4EF6"),null;t=await this.app.workspace.getLeaf("tab"),await t.openFile(r)}catch(r){return new di.Notice("\u6253\u5F00\u6587\u4EF6\u5931\u8D25"),null}return await this.app.workspace.setActiveLeaf(t,{focus:!1}),t}async locateAndHighlightText(e,A,t){await new Promise(y=>setTimeout(y,300));let o=e.view.editor,l=o.getValue(),c=-1,d=[],g=A,u=0,m=-1;for(;(m=l.indexOf(A,u))!==-1;)d.push(m),u=m+1;if(t!==void 0&&t>=0){if(l.substring(t,t+A.length)===A)c=t;else if(d.length>0){let y=d[0],E=Math.abs(t-y);for(let H of d){let x=Math.abs(t-H);x<E&&(E=x,y=H)}c=y}}if(c===-1)if(d.length>0)c=d[0];else{let y=this.textSimilarityService.findBestMatch(A,l,t);if(y)c=y.position,g=y.text,new di.Notice("\u4F7F\u7528\u6A21\u7CCA\u5339\u914D\u627E\u5230\u4E86\u76F8\u4F3C\u5185\u5BB9");else{new di.Notice("\u672A\u627E\u5230\u9AD8\u4EAE\u5185\u5BB9");return}}let v=o.offsetToPos(c),F=o.offsetToPos(c+g.length);o.setSelection(v,F),o.scrollIntoView({from:v,to:F},!0),this.app.workspace.setActiveLeaf(e,{focus:!0})}};var An=require("obsidian");var XA=class{static generateHighlightId(e,A,t){let r=`${e}:${A}:${t}`,o=this.hashCode(r);return`highlight-${Math.abs(o)}-${A}`}static generateCommentId(){let e=Date.now(),A=Math.random().toString(36).substr(2,9);return`comment-${e}-${A}`}static generateCardId(){let e=Date.now(),A=Math.random().toString(36).substr(2,9);return`card-${e}-${A}`}static generateGroupId(){let e=Date.now(),A=Math.random().toString(36).substr(2,7);return`group-${e}-${A}`}static hashCode(e){let A=0;if(e.length===0)return A;for(let t=0;t<e.length;t++){let r=e.charCodeAt(t);A=(A<<5)-A+r,A=A&A}return A}static isValidHighlightId(e){return/^highlight-\d+-\d+$/.test(e)}static isValidCommentId(e){return/^comment-\d+-[a-z0-9]+$/.test(e)}static isValidCardId(e){return/^card-\d+-[a-z0-9]+$/.test(e)}static extractPositionFromHighlightId(e){let A=e.match(/^highlight-\d+-(\d+)$/);return A?parseInt(A[1],10):null}};var Es=class{constructor(e,A){this.app=e;this.commentStore=A;this.highlightService=new oe(e)}async exportHighlightsAsMarkdown(e){var m,v,F,y;if(!e||e.length===0)return null;let A=this.app.plugins,t=A&&A.plugins?A.plugins["hi-note"]:void 0,r={};for(let E of e)E.filePath&&(r[E.filePath]||(r[E.filePath]=[]),r[E.filePath].push(E));let o=[];for(let E in r){let H=this.app.vault.getAbstractFileByPath(E);if(!(H instanceof An.TFile))continue;o.push(`## ${H.basename}`),o.push("");let x=r[E],M=(v=(m=t==null?void 0:t.settings)==null?void 0:m.export)==null?void 0:v.exportTemplate;if(M&&M.trim()!==""){let T=await this.generateContentFromTemplate(H,x,M);T.trim()!==""&&o.push(T)}else{let T=await this.generateDefaultContent(H,x);o.push(T)}}let l=o.join(`
`),c=((y=(F=t==null?void 0:t.settings)==null?void 0:F.export)==null?void 0:y.exportPath)||"",d=`Selected Highlights ${window.moment().format("YYYYMMDDHHmm")}`,g=d;return c&&(this.app.vault.getAbstractFileByPath(c)||await this.app.vault.createFolder(c),g=`${c}/${d}`),await this.app.vault.create(`${g}.md`,l)}async generateContentForMultipleHighlights(e){let A=[];A.push(`# ${f("Selected Highlights")}`),A.push(""),A.push(`*${f("Exported on")} ${window.moment().format("YYYY-MM-DD HH:mm:ss")}*`),A.push("");let t={};for(let r of e)r.filePath&&(t[r.filePath]||(t[r.filePath]=[]),t[r.filePath].push(r));for(let r in t){let o=this.app.vault.getAbstractFileByPath(r);if(!(o instanceof An.TFile))continue;A.push(`## ${o.basename}`),A.push("");let l=t[r];for(let c of l){if(A.push(`> ${c.text}`),A.push("> "),c.comments&&c.comments.length>0){A.push("> ---"),A.push("> ");for(let d of c.comments){A.push(">> [!note] Comment");let g=d.content.split(`
`).map(u=>(u=u.trim(),u?`>> ${u}`:">>")).join(`
`);if(A.push(g),d.updatedAt){let u=window.moment(d.updatedAt);A.push(`>> *${u.format("YYYY-MM-DD HH:mm:ss")}*`)}A.push(">")}}A.push("")}}return A.join(`
`)}async exportHighlightsToNote(e){var u,m;let A=await this.getFileHighlights(e);if(!A||A.length===0)throw new Error(f("No highlights found in the current file."));let t=await this.generateExportContent(e,A),r=this.app.plugins,o=r&&r.plugins?r.plugins["hi-note"]:void 0,l=((m=(u=o==null?void 0:o.settings)==null?void 0:u.export)==null?void 0:m.exportPath)||"",c=`${e.basename} - HiNote ${window.moment().format("YYYYMMDDHHmm")}`,d=c;return l&&(this.app.vault.getAbstractFileByPath(l)||await this.app.vault.createFolder(l),d=`${l}/${c}`),await this.app.vault.create(`${d}.md`,t)}async getFileHighlights(e){let A=await this.app.vault.read(e),t=this.highlightService.extractHighlights(A,e),r=this.commentStore.getFileComments(e),o=r.filter(d=>d.isVirtual&&d.comments&&d.comments.length>0),l=r.filter(d=>!d.isVirtual),c=t.map(d=>{var u,m,v,F;let g=l.find(y=>{let E=y.text===d.text;return E&&typeof y.position=="number"&&typeof d.position=="number"?Math.abs(y.position-d.position)<1e3:E});return g?{...g,position:(u=d.position)!=null?u:0,paragraphOffset:(m=d.paragraphOffset)!=null?m:0}:{id:XA.generateHighlightId(e.path,d.position||0,d.text),...d,position:(v=d.position)!=null?v:0,paragraphOffset:(F=d.paragraphOffset)!=null?F:0,comments:[],createdAt:Date.now(),updatedAt:Date.now()}});return[...o,...c]}async generateExportContent(e,A){var l,c;let t=this.app.plugins,r=t&&t.plugins?t.plugins["hi-note"]:void 0,o=(c=(l=r==null?void 0:r.settings)==null?void 0:l.export)==null?void 0:c.exportTemplate;return o&&o.trim()!==""?this.generateContentFromTemplate(e,A,o):this.generateDefaultContent(e,A)}async generateContentFromTemplate(e,A,t){let r=[],o=t.includes("{{highlightText}}")||t.includes("{{highlightBlockRef}}"),l=t.includes("{{commentContent}}")||t.includes("{{commentDate}}");for(let c of A){if(c.isVirtual){if(c.comments&&c.comments.length>0)for(let d of c.comments)if(l){let g=this.replaceVariables(t,{sourceFile:e.basename,commentContent:d.content||"",commentDate:window.moment(d.updatedAt||Date.now()).format("YYYY-MM-DD HH:mm:ss"),highlightText:"",highlightBlockRef:"",highlightType:"HiNote"});r.push(g.trim())}else{let u=this.replaceVariables(`> [!note] File Comment
> {{commentContent}}
> *{{commentDate}}*`,{commentContent:d.content||"",commentDate:window.moment(d.updatedAt||Date.now()).format("YYYY-MM-DD HH:mm:ss")});r.push(u)}}else{let d="",g=c.text||"";if(typeof c.position=="number"&&t.includes("{{highlightBlockRef}}"))try{let u=c.originalLength||c.text.length;d=await this.highlightService.createBlockIdForHighlight(e,c.position,u)||""}catch(u){console.error("[ExportService] Error creating block ID:",u)}if(!c.comments||c.comments.length===0){if(l&&!o)continue;if(o){let u=t;if(l){let v=/\n>\s*\n>\s*---[\s\S]*?(?=\n\s*$|$)/g;u=u.replace(v,"");let F=/\n>>\s*\[!note\]\s*Comment[\s\S]*?(?=\n>\s*$|\n\s*$|$)/g;u=u.replace(F,""),u=u.replace(/\{\{commentContent\}\}/g,""),u=u.replace(/\{\{commentDate\}\}/g,""),u=u.replace(/\n{3,}/g,`

`),u=u.replace(/\n>\s*\n\s*$/g,`
`)}let m=this.replaceVariables(u,{sourceFile:e.basename,highlightText:g,highlightBlockRef:d,highlightType:"HiNote",commentContent:"",commentDate:""});r.push(m.trim())}}else if(c.comments&&c.comments.length>0){if(l&&!o)for(let u of c.comments){let m=this.replaceVariables(t,{sourceFile:e.basename,commentContent:u.content||"",commentDate:window.moment(u.updatedAt||Date.now()).format("YYYY-MM-DD HH:mm:ss"),highlightText:"",highlightBlockRef:"",highlightType:"HiNote"});r.push(m.trim())}else if(o&&l){let u=t,m=this.findCommentSectionStart(t),v="";m!==-1&&(u=t.substring(0,m),v=t.substring(m));let F=this.replaceVariables(u,{sourceFile:e.basename,highlightText:g,highlightBlockRef:d,highlightType:"HiNote",commentContent:"",commentDate:""});if(r.push(F.trim()),v&&c.comments&&c.comments.length>0)for(let y of c.comments){let E=window.moment(y.updatedAt||Date.now()).format("YYYY-MM-DD HH:mm:ss"),H=this.replaceVariables(v,{sourceFile:e.basename,highlightText:"",highlightBlockRef:"",highlightType:"HiNote",commentContent:y.content||"",commentDate:E});r.push(H.trim())}}else if(o&&!l){let u=this.replaceVariables(t,{sourceFile:e.basename,highlightText:g,highlightBlockRef:d,highlightType:"HiNote",commentContent:"",commentDate:""});r.push(u.trim())}}}r.push("")}return r.join(`
`)}replaceVariables(e,A){let t=e;for(let[r,o]of Object.entries(A))t=t.replace(new RegExp(`{{${r}}}`,"g"),o||"");return t}findCommentSectionStart(e){let A=["commentContent","commentDate"],t=-1;for(let r of A){let o=e.indexOf(`{{${r}}}`);o!==-1&&(t===-1||o<t)&&(t=o)}if(t!==-1){let o=e.substring(0,t).lastIndexOf(`
`);return o!==-1?o:0}return-1}async generateDefaultContent(e,A){return this.generateContentFromTemplate(e,A,`> [!quote] HiNote
> {{highlightText}}
> 
>> [!note] Comment
>> {{commentContent}}
>> *{{commentDate}}*`)}getParagraphOffset(e,A){let r=e.substring(0,A).lastIndexOf(`
`);return r===-1?A:A-r}generateHighlightId(e,A){return XA.generateHighlightId(A,e.position||0,e.text)}};var en=require("obsidian"),$g=/#[\w\u4e00-\u9fa5]+/g,qg=/^\s*(#[\w\u4e00-\u9fa5]+(\s+#[\w\u4e00-\u9fa5]+)*\s*)$/,Us=class{constructor(e,A,t,r){this.card=e;this.highlight=A;this.existingComment=t;this.options=r;this.cancelEdit=()=>{};this.isProcessing=!1;if(this.boundHandleOutsideClick=this.handleOutsideClick.bind(this),document.addEventListener("click",this.boundHandleOutsideClick),this.findHighlightCardInstance()){let l=new CustomEvent("comment-input-shown",{detail:{highlightId:this.highlight.id}});document.dispatchEvent(l)}}findHighlightCardInstance(){var e,A;try{return(A=(e=window.HighlightCard)==null?void 0:e.findCardInstanceByHighlightId)==null?void 0:A.call(e,this.highlight.id)}catch(t){return null}}show(){this.existingComment?this.showEditMode():this.showCreateMode()}showEditMode(){var o;let e=this.card.querySelector(`[data-comment-id="${this.existingComment.id}"]`);if(!e)return;let A=e.querySelector(".hi-note-content");if(!A)return;let t=((o=this.existingComment)==null?void 0:o.content)||"";this.textarea=document.createElement("textarea"),this.textarea.value=t,this.textarea.className="hi-note-input",this.textarea.style.minHeight=`${A.offsetHeight}px`,this.textarea.addEventListener("input",()=>{this.processTagsInInput(),this.autoResizeTextarea()}),this.textarea.addEventListener("click",l=>{l.stopPropagation()}),A.replaceWith(this.textarea);let r=e.querySelector(".hi-note-footer");if(r&&r.addClass("hi-note-hidden"),this.actionHint=e.createEl("div",{cls:"hi-note-actions-hint"}),this.actionHint.addEventListener("click",l=>{l.stopPropagation()}),!en.Platform.isMobile)this.actionHint.createEl("span",{cls:"hi-note-hint",text:f("Shift + Enter Wrap, Enter Save")});else{let l=this.actionHint.createEl("button",{cls:"hi-note-save-button",text:f("Submit")});l.addEventListener("click",async c=>{if(c.stopPropagation(),this.isProcessing)return;let d=this.textarea.value.trim();if(d){this.isProcessing=!0,this.textarea.disabled=!0,l.disabled=!0;try{await this.options.onSave(d),requestAnimationFrame(()=>{document.removeEventListener("click",this.boundHandleOutsideClick),this.isProcessing=!1,this.textarea.disabled=!1})}catch(g){this.isProcessing=!1,this.textarea.disabled=!1,l.disabled=!1}}})}this.options.onDelete&&this.actionHint.createEl("div",{cls:"hi-note-delete-link",text:f("Delete comment")}).addEventListener("click",async c=>{var d,g;c.stopPropagation(),await((g=(d=this.options).onDelete)==null?void 0:g.call(d))}),this.setupKeyboardEvents(A,r||void 0),setTimeout(()=>{this.textarea.focus(),this.textarea.setSelectionRange(this.textarea.value.length,this.textarea.value.length)},50)}showCreateMode(){let e=document.createElement("div");e.className="hi-note-input",this.textarea=e.createEl("textarea"),this.textarea.addEventListener("input",()=>{this.processTagsInInput(),this.autoResizeTextarea()}),e.addEventListener("click",r=>{r.stopPropagation()}),this.textarea.addEventListener("click",r=>{r.stopPropagation()});let A=this.card.querySelector(".hi-notes-section");A||(A=this.card.createEl("div",{cls:"hi-notes-section"}),A.createEl("div",{cls:"hi-notes-list"}));let t=A.querySelector(".hi-notes-list");t&&t.insertBefore(e,t.firstChild),this.setupKeyboardEvents(),setTimeout(()=>{this.textarea.focus()},50)}setupKeyboardEvents(e,A){this.cancelEdit=()=>{this.existingComment?e&&A&&requestAnimationFrame(()=>{this.textarea.replaceWith(e),this.actionHint.remove(),A.removeClass("hi-note-hidden"),document.removeEventListener("click",this.boundHandleOutsideClick)}):requestAnimationFrame(()=>{var t,r;(t=this.textarea.closest(".hi-note-input"))==null||t.remove(),this.card.querySelector(".hi-note")||(r=this.card.querySelector(".hi-notes-section"))==null||r.remove(),document.removeEventListener("click",this.boundHandleOutsideClick)}),this.options.onCancel()},this.textarea.onkeydown=async t=>{if(t.key==="Enter"){if(en.Platform.isMobile)return;if(t.shiftKey||(t.preventDefault(),this.isProcessing))return;let r=this.textarea.value.trim();if(!r)return;this.isProcessing=!0,this.textarea.disabled=!0;try{await this.options.onSave(r),requestAnimationFrame(()=>{document.removeEventListener("click",this.boundHandleOutsideClick),this.isProcessing=!1,this.textarea.disabled=!1})}catch(o){this.textarea.disabled=!1,this.isProcessing=!1}}}}autoResizeTextarea(){let e=window.scrollY;this.textarea.style.height="auto";let A=this.textarea.scrollHeight;this.textarea.style.height=`${A}px`,window.scrollTo(0,e)}processTagsInInput(){var A,t,r,o;let e=this.textarea.value;if(qg.test(e)){let l=e.match($g)||[];if(l.length>0){let c=(A=this.textarea.parentElement)==null?void 0:A.querySelector(".highlight-tags-preview");if(c||(c=document.createElement("div"),c.className="highlight-tags-preview",(t=this.textarea.parentElement)==null||t.insertBefore(c,this.textarea)),c){for(;c.firstChild;)c.removeChild(c.firstChild);let d=c;l.forEach(g=>{let u=document.createElement("span");u.className="highlight-tag",u.textContent=g,d.appendChild(u)})}}}else(o=(r=this.textarea.parentElement)==null?void 0:r.querySelector(".highlight-tags-preview"))==null||o.remove()}handleOutsideClick(e){if(!this.textarea||this.isProcessing)return;let A=e.target;if(!this.textarea.contains(A)&&!A.closest(".hi-note-actions-hint")){e.preventDefault(),e.stopPropagation(),this.isProcessing=!0;let r=this.textarea.value.trim();if(r){let o=r;this.textarea.disabled=!0,this.options.onSave(o).then(()=>{requestAnimationFrame(()=>{document.removeEventListener("click",this.boundHandleOutsideClick),this.isProcessing=!1,this.textarea.disabled=!1})}).catch(()=>{this.textarea.disabled=!1,this.isProcessing=!1})}else requestAnimationFrame(()=>{this.cancelEdit(),this.isProcessing=!1})}}destroy(){document.removeEventListener("click",this.boundHandleOutsideClick),this.isProcessing=!1;let e=new CustomEvent("comment-input-closed",{detail:{highlightId:this.highlight.id}});document.dispatchEvent(e)}};var DA=require("obsidian");var Eo=require("obsidian");var Ss=class{constructor(e){this.plugin=e;this.aiService=new It(this.plugin.settings.ai)}updateModel(e,A){this.aiService&&this.aiService.updateModel(e,A)}async sendMessage(e,A=[]){try{let t=A.map(o=>({role:o.role,content:o.content}));return t.push({role:"user",content:e}),{content:await this.aiService.chat(t),type:"assistant",timestamp:Date.now()}}catch(t){throw new Eo.Notice("\u83B7\u53D6 AI \u54CD\u5E94\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u670D\u52A1\u914D\u7F6E\u548C\u7F51\u7EDC\u8FDE\u63A5"),t}}async testConnection(){return await this.aiService.testConnection()}};var $A=class $A extends DA.Component{constructor(A,t){super();this.plugin=t;this.isProcessing=!1;this.draggedContents=[];this.chatHistory=[];this.currentPreviewContainer=null;this.textarea=null;this.chatModelState={provider:"",model:""};if($A.instance)return $A.instance;this.app=A,this.chatService=new Ss(this.plugin),this.floatingButton=document.querySelector(".highlight-floating-button"),this.containerEl=document.createElement("div"),this.containerEl.addClass("highlight-chat-window");let r=this.containerEl.createEl("div",{cls:"highlight-chat-header"}),o=r.createEl("div",{cls:"highlight-chat-title"});o.createEl("span",{text:f("Chat")});let l=o.createEl("div",{cls:"highlight-chat-model",text:this.getCurrentModelName()});l.addEventListener("click",M=>{M.stopPropagation(),this.showModelSelector(l,M)});let c=r.createEl("div",{cls:"highlight-chat-buttons"}),d=c.createEl("div",{cls:"highlight-chat-clear"});(0,DA.setIcon)(d,"eraser"),d.addEventListener("click",()=>this.clearChat());let g=c.createEl("div",{cls:"highlight-chat-close"});(0,DA.setIcon)(g,"x"),g.addEventListener("click",()=>this.close());let u=this.containerEl.createEl("div",{cls:"highlight-chat-history"}),m=this.containerEl.createEl("div",{cls:"highlight-chat-input-container"});this.setupChatInput(m);let v={text:"",position:0,paragraphOffset:0,paragraphId:"chat",createdAt:Date.now(),updatedAt:Date.now()};u.addEventListener("dragenter",M=>{M.preventDefault(),u.addClass("drag-over")}),u.addEventListener("dragover",M=>{M.preventDefault(),M.stopPropagation(),u.addClass("drag-over");let T=u.getBoundingClientRect(),R=u.scrollTop,N=T.height;u.addClass("highlight-chat-history-drag-guide"),u.style.setProperty("--drag-guide-top",`${R+12}px`),u.style.setProperty("--drag-guide-height",`${N-24}px`);let J=document.querySelector(".highlight-dragging");J&&(J.addClass("highlight-chat-preview"),J.style.left=`${M.clientX+10}px`,J.style.top=`${M.clientY+10}px`)}),u.addEventListener("dragleave",M=>{u.contains(M.relatedTarget)||u.removeClass("drag-over")}),u.addEventListener("drop",async M=>{var R;M.preventDefault(),u.removeClass("drag-over");let T=(R=M.dataTransfer)==null?void 0:R.getData("application/highlight");if(T)try{let N=JSON.parse(T);if(!N.text)return;this.draggedContents.some(AA=>AA.text===N.text)||(this.draggedContents.push(N),this.showDraggedPreviewsInChat(u))}catch(N){}});let F=!1,y,E,H,x;if(r.addEventListener("mousedown",M=>{M.target===g||M.target===d||(F=!0,H=M.clientX-this.containerEl.offsetLeft,x=M.clientY-this.containerEl.offsetTop,r.addClass("dragging"))}),document.addEventListener("mousemove",M=>{if(!F)return;M.preventDefault(),y=M.clientX-H,E=M.clientY-x;let T=window.innerWidth-this.containerEl.offsetWidth,R=window.innerHeight-this.containerEl.offsetHeight;y=Math.max(0,Math.min(y,T)),E=Math.max(0,Math.min(E,R)),this.containerEl.addClass("highlight-chat-window"),this.containerEl.style.left=`${y}px`,this.containerEl.style.top=`${E}px`}),document.addEventListener("mouseup",()=>{F=!1,r.removeClass("dragging")}),$A.savedState){this.chatHistory=$A.savedState.chatHistory,this.draggedContents=$A.savedState.draggedContents;let M=this.containerEl.querySelector(".highlight-chat-history");if(M){for(;M.firstChild;)M.removeChild(M.firstChild);this.chatHistory.forEach(T=>{this.addMessage(M,T.content,T.role,!1)}),this.draggedContents.length>0&&this.showDraggedPreviewsInChat(M),$A.savedState.currentPreviewContainer&&(this.currentPreviewContainer=M.querySelector(".highlight-chat-preview-cards"))}}$A.instance=this}showDraggedPreviewsInChat(A){var c;if(!this.currentPreviewContainer){let g=A.createEl("div",{cls:"highlight-chat-message highlight-chat-message-preview"}).createEl("div",{cls:"highlight-chat-previews"}),u=g.createEl("div",{cls:"highlight-chat-preview-header"});u.createEl("span",{cls:"highlight-chat-preview-count",text:String(this.draggedContents.length)}),u.createSpan({text:f("highlighted notes")});let m=g.createEl("div",{cls:"highlight-chat-preview-cards"});this.currentPreviewContainer=m}let t=this.currentPreviewContainer.createEl("div",{cls:"highlight-chat-preview-card"}),r=this.draggedContents[this.draggedContents.length-1];t.createEl("div",{cls:"highlight-chat-preview-content",text:r.text});let o=t.createEl("div",{cls:"highlight-chat-preview-delete"});(0,DA.setIcon)(o,"x"),o.addEventListener("click",()=>{var g;let d=this.draggedContents.indexOf(r);if(d>-1)if(this.draggedContents.splice(d,1),t.remove(),this.draggedContents.length===0){let u=(g=this.currentPreviewContainer)==null?void 0:g.closest(".highlight-chat-message-preview");u&&(u.remove(),this.currentPreviewContainer=null)}else this.updatePreviewCount()});let l=(c=this.currentPreviewContainer.closest(".highlight-chat-message-preview"))==null?void 0:c.querySelector(".highlight-chat-preview-count");l&&(l.textContent=String(this.draggedContents.length)),A.scrollTop=A.scrollHeight}show(){document.body.contains(this.containerEl)?this.containerEl.removeClass("highlight-chat-hidden"):(this.containerEl.addClass("highlight-chat-window"),this.containerEl.addClass("highlight-chat-window-position"),document.body.appendChild(this.containerEl)),document.querySelectorAll(".highlight-floating-button").forEach(A=>{A.style.display="none"}),requestAnimationFrame(()=>{var A;(A=this.textarea)==null||A.focus()})}close(){this.containerEl.addClass("highlight-chat-hidden"),document.querySelectorAll(".highlight-floating-button").forEach(A=>{A.style.display=""})}addMessage(A,t,r,o=!0){let l=A.createEl("div",{cls:"highlight-chat-message"}),c=l.createEl("div",{cls:"highlight-chat-message-content markdown-rendered"});l.addClass(`highlight-chat-message-${r}`),c.addClass(`highlight-chat-message-content-${r}`),r==="assistant"&&o?this.typeWriter(c,t):this.renderMarkdownContent(c,t),A.scrollTop=A.scrollHeight}async typeWriter(A,t,r=30){let o=0;A.textContent="";let l=A.createEl("span",{cls:"highlight-chat-cursor"}),c=()=>{o<t.length?(A.insertBefore(document.createTextNode(t.charAt(o)),l),o++,setTimeout(c,r)):(l.remove(),this.renderMarkdownContent(A,t))};c()}static getInstance(A,t){return $A.instance||($A.instance=new $A(A,t)),$A.instance}async renderMarkdownContent(A,t){for(;A.firstChild;)A.removeChild(A.firstChild);try{await DA.MarkdownRenderer.render(this.app,t,A,"",new DA.Component),A.querySelectorAll("ul, ol").forEach(o=>{o.addClass("chat-markdown-list")})}catch(r){console.error("Error rendering markdown in chat:",r),A.textContent=t}}setupChatInput(A){let t=A.createEl("div",{cls:"highlight-chat-input-wrapper"});this.textarea=t.createEl("textarea",{cls:"highlight-chat-input",attr:{placeholder:f("Input message..."),rows:"1"}});let r=()=>{this.textarea&&(this.textarea.addClass("highlight-chat-input"),this.textarea.style.height=`${Math.min(this.textarea.scrollHeight,150)}px`)};return this.textarea.addEventListener("input",()=>{r()}),this.textarea.addEventListener("keydown",o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),this.textarea&&this.handleSendMessage(this.textarea))}),this.textarea}async handleSendMessage(A){let t=A.value.trim();if(!(!t||this.isProcessing))try{this.isProcessing=!0;let r=t,o=t;if(this.draggedContents.length>0){let c=this.draggedContents.map(d=>d.text).join(`

---

`);if(this.chatHistory.push({role:"user",content:`\u4EE5\u4E0B\u662F\u9700\u8981\u5206\u6790\u7684\u5185\u5BB9\uFF1A

${c}`}),r=t,o=`\u7528\u6237\u63D0\u793A\uFF1A${t}`,this.currentPreviewContainer){let d=this.currentPreviewContainer.closest(".highlight-chat-message-preview");d&&d.addClass("sent"),this.currentPreviewContainer=null,this.draggedContents=[]}}this.chatHistory.push({role:"user",content:o}),requestAnimationFrame(()=>{A.value="",A.addClass("highlight-chat-input"),A.dispatchEvent(new Event("input"))});let l=this.containerEl.querySelector(".highlight-chat-history");if(l){this.addMessage(l,t,"user",!0);let c=await this.chatService.sendMessage(r,this.chatHistory);this.chatHistory.push({role:"assistant",content:c.content}),this.addMessage(l,c.content,"assistant",!0)}}catch(r){}finally{this.isProcessing=!1}}updatePreviewCount(){if(this.currentPreviewContainer){let A=this.currentPreviewContainer.closest(".highlight-chat-message-preview"),t=A==null?void 0:A.querySelector(".highlight-chat-preview-count");t&&(t.textContent=String(this.draggedContents.length),this.draggedContents.length===0&&A&&(A.remove(),this.currentPreviewContainer=null))}}clearChat(){if(this.chatHistory=[],this.draggedContents=[],this.currentPreviewContainer){let t=this.currentPreviewContainer.closest(".highlight-chat-message-preview");t&&t.remove(),this.currentPreviewContainer=null}let A=this.containerEl.querySelector(".highlight-chat-history");if(A)for(;A.firstChild;)A.removeChild(A.firstChild);this.textarea&&(this.textarea.value="",this.textarea.addClass("highlight-chat-input"))}getCurrentModelName(){var r,o,l,c,d,g,u,m;let A=this.plugin.settings.ai;switch(this.chatModelState.provider||A.provider){case"openai":return this.chatModelState.model||((r=A.openai)==null?void 0:r.model)||"GPT-4";case"anthropic":return this.chatModelState.model||((o=A.anthropic)==null?void 0:o.model)||"Claude-3";case"ollama":return this.chatModelState.model||((l=A.ollama)==null?void 0:l.model)||"Ollama";case"gemini":return this.chatModelState.model||((c=A.gemini)==null?void 0:c.model)||"Gemini Pro";case"deepseek":return this.chatModelState.model||((d=A.deepseek)==null?void 0:d.model)||"Deepseek Chat";case"siliconflow":return(g=A.siliconflow)!=null&&g.isCustomModel&&((u=A.siliconflow)!=null&&u.model)?A.siliconflow.model:this.chatModelState.model?this.chatModelState.model:((m=A.siliconflow)==null?void 0:m.model)||"SiliconFlow";default:return"Unknown model"}}async showModelSelector(A,t){var c,d,g,u,m,v;let r=new DA.Menu,o=this.plugin.settings.ai;switch(o.provider){case"siliconflow":try{if(Ue.forEach(E=>{r.addItem(H=>{var M,T;let x=!((M=o.siliconflow)!=null&&M.isCustomModel)&&(this.chatModelState.model===E.id||((T=o.siliconflow)==null?void 0:T.model)===E.id);H.setTitle(E.name).setChecked(x).onClick(async()=>{o.siliconflow?(o.siliconflow.model=E.id,o.siliconflow.isCustomModel=!1):o.siliconflow={model:E.id,isCustomModel:!1},this.chatModelState.provider="siliconflow",this.chatModelState.model=E.id,this.chatService.updateModel("siliconflow",E.id),await this.plugin.saveSettings(),A.textContent=E.name})})}),(c=o.siliconflow)!=null&&c.isCustomModel&&((d=o.siliconflow)!=null&&d.model)){r.addSeparator();let E=o.siliconflow.model;r.addItem(H=>{var M,T;let x=((M=o.siliconflow)==null?void 0:M.isCustomModel)&&(this.chatModelState.model===E||((T=o.siliconflow)==null?void 0:T.model)===E);H.setTitle(E).setChecked(x).onClick(async()=>{o.siliconflow?(o.siliconflow.model=E,o.siliconflow.isCustomModel=!0):o.siliconflow={model:E,isCustomModel:!0},this.chatModelState.provider="siliconflow",this.chatModelState.model=E,this.chatService.updateModel("siliconflow",E),await this.plugin.saveSettings(),A.textContent=E})})}}catch(y){new DA.Notice(f("Unable to get SiliconFlow model list, please check API Key and network connection."))}break;case"openai":try{let y=await this.chatService.aiService.listOpenAIModels(),E=y.filter(x=>!x.isCustom),H=y.filter(x=>x.isCustom);E.forEach(x=>{r.addItem(M=>{M.setTitle(x.name).setChecked(this.chatModelState.model===x.id).onClick(async()=>{this.chatModelState.provider="openai",this.chatModelState.model=x.id,this.chatService.updateModel("openai",x.id),A.textContent=this.getCurrentModelName()})})}),H.length>0&&(r.addSeparator(),H.forEach(x=>{r.addItem(M=>{M.setTitle(x.name).setChecked(this.chatModelState.model===x.id).onClick(async()=>{this.chatModelState.provider="openai",this.chatModelState.model=x.id,this.chatService.updateModel("openai",x.id),A.textContent=this.getCurrentModelName()})})}))}catch(y){new DA.Notice(f("Unable to get OpenAI model list, please check API Key and network connection."))}break;case"anthropic":["claude-3-opus-20240229","claude-3-sonnet-20240229","claude-3-haiku-20240307"].forEach(y=>{r.addItem(E=>{var H;E.setTitle(y).setChecked(((H=o.anthropic)==null?void 0:H.model)===y).onClick(async()=>{o.anthropic||(o.anthropic={apiKey:"",model:y}),o.anthropic.model=y,await this.plugin.saveSettings(),A.textContent=this.getCurrentModelName()})})});break;case"ollama":try{(await this.chatService.aiService.listOllamaModels()).forEach(E=>{r.addItem(H=>{var x;H.setTitle(E).setChecked(((x=o.ollama)==null?void 0:x.model)===E).onClick(async()=>{o.ollama||(o.ollama={host:"http://localhost:11434",model:E}),o.ollama.model=E,await this.plugin.saveSettings(),A.textContent=this.getCurrentModelName()})})})}catch(y){new DA.Notice(f("Unable to access the Ollama model, please check the service."))}break;case"gemini":try{(await this.chatService.aiService.listGeminiModels()).forEach(E=>{r.addItem(H=>{var x;H.setTitle(E.name).setChecked(((x=o.gemini)==null?void 0:x.model)===E.id).onClick(async()=>{this.chatModelState.provider="gemini",this.chatModelState.model=E.id,this.chatService.updateModel("gemini",E.id),A.textContent=this.getCurrentModelName()})})}),(g=o.gemini)!=null&&g.isCustomModel&&((u=o.gemini)!=null&&u.model)&&(r.addSeparator(),r.addItem(E=>{var x,M;let H={id:((x=o.gemini)==null?void 0:x.model)||"",name:(M=o.gemini)==null?void 0:M.model,isCustom:!0};E.setTitle(H.name).setChecked(this.chatModelState.model===H.id).onClick(async()=>{this.chatModelState.provider="gemini",this.chatModelState.model=H.id,this.chatService.updateModel("gemini",H.id),A.textContent=this.getCurrentModelName()})}))}catch(y){new DA.Notice(f("Unable to get Gemini model list, please check API Key and network connection."))}break;case"deepseek":try{(await this.chatService.aiService.listDeepseekModels()).forEach(E=>{r.addItem(H=>{var x;H.setTitle(E.name).setChecked(((x=o.deepseek)==null?void 0:x.model)===E.id).onClick(async()=>{this.chatModelState.provider="deepseek",this.chatModelState.model=E.id,this.chatService.updateModel("deepseek",E.id),A.textContent=this.getCurrentModelName()})})}),(m=o.deepseek)!=null&&m.isCustomModel&&((v=o.deepseek)!=null&&v.model)&&(r.addSeparator(),r.addItem(E=>{var x,M;let H={id:((x=o.deepseek)==null?void 0:x.model)||"",name:(M=o.deepseek)==null?void 0:M.model,isCustom:!0};E.setTitle(H.name).setChecked(this.chatModelState.model===H.id).onClick(async()=>{this.chatModelState.provider="deepseek",this.chatModelState.model=H.id,this.chatService.updateModel("deepseek",H.id),A.textContent=this.getCurrentModelName()})}))}catch(y){new DA.Notice(f("Unable to get Deepseek model list, please check API Key and network connection."))}break;default:new DA.Notice(f("Unknown AI provider"));break}let l=A.getBoundingClientRect();r.showAtPosition({x:l.left,y:l.bottom})}};$A.instance=null,$A.savedState=null;var ze=$A;var ie="comment-view",ue=class extends X.ItemView{constructor(A,t){super(A);this.searchHintsEventHandlers=null;this.handleGlobalClick=A=>{if(this.isSelectionMode||this.selectedHighlights.size<=1||!this.multiSelectActionsContainer||this.multiSelectActionsContainer.style.display==="none")return;let t=A.target;t.closest(".multi-select-actions")||t.closest(".highlight-card.selected")||t.closest(".highlight-container")||this.clearSelection()};this.handleSelectionStart=A=>{A.target.closest(".highlight-card")||A.target.closest(".flashcard-mode")||A.target.closest(".flashcard-add-group")||A.target.closest(".flashcard-group-action")||A.target.closest(".highlight-floating-button")||(this.selectionStartX=A.clientX,this.selectionStartY=A.clientY,this.mouseMoved=!1,document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp))};this.handleMouseMove=A=>{let t=A.clientX-this.selectionStartX,r=A.clientY-this.selectionStartY;Math.sqrt(t*t+r*r)>=this.mouseMoveThreshold&&(this.mouseMoved=!0,document.removeEventListener("mousemove",this.handleMouseMove),this.startSelection(A))};this.handleMouseUp=A=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.mouseMoved||this.clearSelection()};this.handleSelectionMove=A=>{if(!this.isSelectionMode||!this.selectionBox)return;let t=A.clientX-this.selectionStartX,r=A.clientY-this.selectionStartY;t<0?(this.selectionBox.style.left=`${A.clientX}px`,this.selectionBox.style.width=`${-t}px`):this.selectionBox.style.width=`${t}px`,r<0?(this.selectionBox.style.top=`${A.clientY}px`,this.selectionBox.style.height=`${-r}px`):this.selectionBox.style.height=`${r}px`,this.selectCardsInBox()};this.handleSelectionEnd=A=>{this.isSelectionMode&&(this.selectionBox&&(this.selectionBox.remove(),this.selectionBox=null),this.isSelectionMode=!1,document.removeEventListener("mousemove",this.handleSelectionMove),document.removeEventListener("mouseup",this.handleSelectionEnd),this.updateSelectedHighlights())};this.selectedHighlights=new Set;this.currentFile=null;this.isFlashcardMode=!1;this.highlights=[];this.highlightsWithFlashcards=new Set;this.searchDebounceTimer=null;this.localSearchDebounceTime=200;this.globalSearchDebounceTime=500;this.isSearching=!1;this.isDraggedToMainView=!1;this.isMobileView=!1;this.isSmallScreen=!1;this.isShowingFileList=!0;this.currentBatch=0;this.isLoading=!1;this.BATCH_SIZE=20;this.floatingButton=null;this.aiButtons=[];this.currentEditingHighlightId=null;this.flashcardComponent=null;this.isSelectionMode=!1;this.selectionBox=null;this.selectionStartX=0;this.selectionStartY=0;this.mouseMoveThreshold=5;this.mouseMoved=!1;this.handleSearchInputWithDebounce=A=>{this.searchDebounceTimer!==null&&(window.clearTimeout(this.searchDebounceTimer),this.searchDebounceTimer=null);let t=this.searchInput.value.toLowerCase().trim(),r=t.startsWith("all:"),o=r?this.globalSearchDebounceTime:this.localSearchDebounceTime;r&&t.length>4&&this.showSearchLoadingIndicator(),this.searchDebounceTimer=window.setTimeout(()=>{this.updateHighlightsList(),this.searchDebounceTimer=null},o)};this.commentStore=t;let r=this.app.plugins;if(r&&r.plugins&&r.plugins["hi-note"])this.plugin=r.plugins["hi-note"];else throw new Error("Hi-Note plugin not found");this.locationService=new ys(this.app),this.exportService=new Es(this.app,this.commentStore),this.highlightService=new oe(this.app),this.licenseManager=new qe(this.plugin),this.canvasService=new rs(this.app.vault),this.registerEvent(this.app.workspace.on("file-open",l=>{var c,d,g;if(l&&!this.isDraggedToMainView){this.currentFile=l;let u=this.app.workspace.activeLeaf,m=((d=(c=u==null?void 0:u.getViewState())==null?void 0:c.state)==null?void 0:d.file)!==l.path&&((g=u==null?void 0:u.view)==null?void 0:g.getViewType())==="canvas";this.updateHighlights(m)}})),this.registerEvent(this.app.vault.on("modify",l=>{var c,d,g;if(l===this.currentFile&&!this.isDraggedToMainView){let u=this.app.workspace.activeLeaf,m=((d=(c=u==null?void 0:u.getViewState())==null?void 0:c.state)==null?void 0:d.file)!==l.path&&((g=u==null?void 0:u.view)==null?void 0:g.getViewType())==="canvas";this.updateHighlights(m)}}));let o=l=>{let{highlightId:c,text:d}=l.detail;setTimeout(()=>{this.highlightContainer.querySelectorAll(".highlight-card").forEach(u=>{u.removeClass("selected")});let g=UA.findCardInstanceByHighlightId(c);if(!g){let u=Array.from(this.highlightContainer.querySelectorAll(".highlight-card")).find(m=>{var F;return((F=m.querySelector(".highlight-text-content"))==null?void 0:F.textContent)===d});u&&(u.addClass("selected"),g=UA.findCardInstanceByElement(u),u.scrollIntoView({behavior:"smooth"}))}g&&g.showCommentInput()},100)};window.addEventListener("open-comment-input",o),this.register(()=>window.removeEventListener("open-comment-input",o)),this.registerEvent(this.app.workspace.on("layout-change",()=>{this.checkViewPosition()})),this.loadingIndicator=createEl("div",{cls:"highlight-loading-indicator",text:f("Loading...")}),this.loadingIndicator.addClass("highlight-display-none")}clearSelection(){this.highlightContainer.querySelectorAll(".highlight-card.selected").forEach(A=>{A.removeClass("selected")}),UA&&typeof UA.clearSelection=="function"&&UA.clearSelection(),this.selectedHighlights.clear(),this.hideMultiSelectActions(),this.isSelectionMode=!1}handleMultiSelect(A){let t=A.detail;t&&t.selectedCards&&this.updateSelectedHighlights()}updateSelectedHighlights(){this.selectedHighlights.clear(),Array.from(this.highlightContainer.querySelectorAll(".highlight-card.selected")).forEach(t=>{let r=t.getAttribute("data-highlight");if(r)try{let o=JSON.parse(r);this.selectedHighlights.add(o)}catch(o){console.error("Error parsing highlight data:",o)}}),this.selectedHighlights.size>1?this.showMultiSelectActions():this.hideMultiSelectActions()}async showMultiSelectActions(){this.hideMultiSelectActions(),this.multiSelectActionsContainer||(this.multiSelectActionsContainer=this.containerEl.createEl("div",{cls:"multi-select-actions"})),this.multiSelectActionsContainer.show(),this.multiSelectActionsContainer.empty();let A=this.multiSelectActionsContainer.createEl("div",{cls:"selected-count",text:`selected ${this.selectedHighlights.size}`}),t=this.multiSelectActionsContainer.createEl("div",{cls:"multi-select-action-button"});t.setAttribute("aria-label",f("Export")),(0,X.setIcon)(t,"file-input"),t.addEventListener("click",()=>{this.exportSelectedHighlights()});let r=this.plugin.fsrsManager;if(!r){this.createDefaultFlashcardButton(this.multiSelectActionsContainer);return}let o=0;for(let c of this.selectedHighlights)if(c.id){let d=r.findCardsBySourceId(c.id,"highlight");d&&d.length>0&&o++}if(o===0){let c=this.multiSelectActionsContainer.createEl("div",{cls:"multi-select-action-button"});c.setAttribute("aria-label",f("Create HiCard")),(0,X.setIcon)(c,"book-plus"),(async()=>{let g=await this.licenseManager.isActivated(),u=g?await this.licenseManager.isFeatureEnabled("flashcard"):!1;return g&&u})().then(g=>{g||(c.addClass("disabled-button"),c.setAttribute("aria-label",f("Only HiNote Pro")))}),c.addEventListener("click",async()=>{if(c.hasClass("disabled-button")){new X.Notice(f("Only HiNote Pro"));return}await this.createMissingFlashcards()})}else if(o===this.selectedHighlights.size){let c=this.multiSelectActionsContainer.createEl("div",{cls:"multi-select-action-button delete-flashcard-button"});c.setAttribute("aria-label",f("Delete HiCard")),(0,X.setIcon)(c,"book-x"),c.addEventListener("click",()=>{this.deleteFlashcardsFromSelected()})}else{let c=this.multiSelectActionsContainer.createEl("div",{cls:"multi-select-action-button"});c.setAttribute("aria-label",f("Manage HiCard")),(0,X.setIcon)(c,"book-heart"),c.addEventListener("click",d=>{this.showFlashcardManageMenu(d)})}let l=this.multiSelectActionsContainer.createEl("div",{cls:"multi-select-action-button"});l.setAttribute("aria-label",f("Delete")),(0,X.setIcon)(l,"trash"),l.addEventListener("click",()=>{this.deleteSelectedHighlights()})}hideMultiSelectActions(){this.multiSelectActionsContainer&&(this.multiSelectActionsContainer.empty(),this.multiSelectActionsContainer.hide())}createDefaultFlashcardButton(A){let t=A.createEl("div",{cls:"multi-select-action-button"});t.setAttribute("aria-label",f("Create HiCard")),(0,X.setIcon)(t,"plus-circle"),t.addEventListener("click",()=>{new X.Notice(f("HiCard function is not initialized, please enable FSRS function"))})}showFlashcardManageMenu(A){let t=new X.Menu;t.addItem(o=>{o.setTitle(f("Create missing HiCard")).setIcon("plus-circle").onClick(async()=>{await this.createMissingFlashcards()})}),t.addItem(o=>{o.setTitle(f("Delete existing HiCards")).setIcon("trash").onClick(()=>{this.deleteFlashcardsFromSelected()})});let r=A.currentTarget;if(r){let o=r.getBoundingClientRect();t.showAtPosition({x:o.left-85,y:o.top-60})}else t.showAtMouseEvent(A)}async createMissingFlashcards(){let A=await this.licenseManager.isActivated(),t=A?await this.licenseManager.isFeatureEnabled("flashcard"):!1;if(!A||!t){new X.Notice(f("Only HiNote Pro"));return}let r=this.plugin.fsrsManager;if(!r){new X.Notice(f("HiCard function is not initialized, please enable FSRS function"));return}let o=0,l=0;for(let c of this.selectedHighlights)try{if(c.id){let d=r.findCardsBySourceId(c.id,"highlight");if(d&&d.length>0)continue;let g=UA.findCardInstanceByHighlightId(c.id),u=!1;if(g)u=await g.createHiCardForHighlight(!0);else{let m=document.createElement("div");g=new UA(m,c,this.plugin,{onHighlightClick:async()=>{},onCommentAdd:()=>{},onExport:()=>{},onCommentEdit:()=>{},onAIResponse:async()=>{}},!1),u=await g.createHiCardForHighlight(!0)}u?o++:(l++,console.error(`Create HiCard failed: ${c.text}`))}}catch(d){l++,console.error("Create HiCard failed:",d)}o>0&&this.plugin.eventManager.emitFlashcardChanged(),o>0&&l===0?new X.Notice(f(`Successfully created ${o} HiCard`)):o>0&&l>0?new X.Notice(f(`Successfully created ${o} HiCard, ${l} failed`)):o===0&&l===0?new X.Notice(f("No HiCard to create")):new X.Notice(f("Failed to create HiCard! Please check the selected highlight content")),this.clearSelection(),this.renderHighlights(this.highlights)}async exportSelectedHighlights(){if(this.selectedHighlights.size===0){new X.Notice(f("Please select highlights to export"));return}try{let A=Array.from(this.selectedHighlights),t=await this.exportService.exportHighlightsAsMarkdown(A);t?(new X.Notice(f("Successfully exported selected highlights to: ")+t.path),this.clearSelection()):new X.Notice(f("No highlights to export"))}catch(A){console.error("Failed to export highlights:",A),new X.Notice(f("Failed to export highlights: ")+(A instanceof Error?A.message:String(A)))}}deleteFlashcardsFromSelected(){let A=new X.Modal(this.app);A.titleEl.setText(f("Confirm delete HiCard"));let t=A.contentEl;t.empty(),t.createEl("p",{text:f("Are you sure you want to delete the HiCards of the selected highlights? This action cannot be undone.")});let r=t.createEl("div",{cls:"modal-button-container"});r.createEl("button",{text:f("Cancel")}).addEventListener("click",()=>{A.close()}),r.createEl("button",{cls:"mod-warning",text:f("Delete")}).addEventListener("click",async()=>{A.close(),await this.deleteExistingFlashcards()}),A.open()}deleteSelectedHighlights(){if(this.selectedHighlights.size===0){new X.Notice(f("No highlights selected"));return}let A=new X.Modal(this.app);A.titleEl.setText(f("Confirm delete highlights"));let t=A.contentEl;t.empty(),t.createEl("p",{text:f(`Are you sure you want to delete ${this.selectedHighlights.size} highlights and all their data, including Comments and HiCards? This action cannot be undone.`)});let r=t.createEl("div",{cls:"modal-button-container"});r.createEl("button",{text:f("Cancel")}).addEventListener("click",()=>{A.close()}),r.createEl("button",{cls:"mod-warning",text:f("Delete")}).addEventListener("click",async()=>{A.close(),await this.performDeleteSelectedHighlights()}),A.open()}async performDeleteSelectedHighlights(){if(this.selectedHighlights.size===0){new X.Notice(f("No highlights selected"));return}let A=0,t=0,r=Array.from(this.highlightContainer.querySelectorAll(".highlight-card.selected"));for(let o of r)try{let l=o.getAttribute("data-highlight");if(!l)continue;let c=JSON.parse(l);if(!c.id)continue;let d=UA.findCardInstanceByHighlightId(c.id);d?(await d.handleDeleteHighlight(!0,!0),A++):(t++,console.error(`\u65E0\u6CD5\u627E\u5230\u9AD8\u4EAE\u5361\u7247\u5B9E\u4F8B: ${c.id}`))}catch(l){console.error("\u5220\u9664\u9AD8\u4EAE\u65F6\u51FA\u9519:",l),t++}this.clearSelection(),A>0&&t===0?new X.Notice(f(`\u6210\u529F\u5220\u9664 ${A} \u4E2A\u9AD8\u4EAE`)):A>0&&t>0?new X.Notice(f(`\u6210\u529F\u5220\u9664 ${A} \u4E2A\u9AD8\u4EAE\uFF0C${t} \u4E2A\u5220\u9664\u5931\u8D25`)):A===0&&t>0&&new X.Notice(f("\u5220\u9664\u9AD8\u4EAE\u5931\u8D25"))}async deleteExistingFlashcards(){let A=this.plugin.fsrsManager;if(!A){new X.Notice(f("HiCard function is not initialized, please enable FSRS function"));return}let t=0,r=0;for(let o of this.selectedHighlights)try{if(o.id){let l=A.findCardsBySourceId(o.id,"highlight");if(!l||l.length===0)continue;let c=UA.findCardInstanceByHighlightId(o.id),d=!1;if(c)d=await c.deleteHiCardForHighlight(!0);else{let g=document.createElement("div");c=new UA(g,o,this.plugin,{onHighlightClick:async()=>{},onCommentAdd:()=>{},onExport:()=>{},onCommentEdit:()=>{},onAIResponse:async()=>{}},!1),d=await c.deleteHiCardForHighlight(!0)}d?t++:(r++,console.error(`Failed to delete HiCard: ${o.text}`))}}catch(l){r++,console.error("Failed to delete HiCard:",l)}t>0&&this.plugin.eventManager.emitFlashcardChanged(),t>0&&r===0?new X.Notice(f(`Successfully deleted ${t} HiCard`)):t>0&&r>0?new X.Notice(f(`Successfully deleted ${t} HiCard, ${r} failed`)):t===0&&r===0?new X.Notice(f("No HiCard to delete")):new X.Notice(f("Failed to delete HiCard! Please check the selected highlight content")),this.clearSelection(),this.renderHighlights(this.highlights)}setupSelectionBox(){this.highlightContainer.removeEventListener("mousedown",this.handleSelectionStart),this.highlightContainer.addEventListener("mousedown",this.handleSelectionStart)}startSelection(A){let t=this.highlightContainer.querySelectorAll(".highlight-card.selected").length>0,r=window.HighlightCard,o=r&&r.selectedCards&&r.selectedCards.size>0;(this.selectedHighlights.size>0||t||o)&&this.clearSelection(),this.selectionBox=document.createElement("div"),this.selectionBox.className="selection-box",this.selectionBox.style.left=`${this.selectionStartX}px`,this.selectionBox.style.top=`${this.selectionStartY}px`,document.body.appendChild(this.selectionBox),this.isSelectionMode=!0,document.addEventListener("mousemove",this.handleSelectionMove),document.addEventListener("mouseup",this.handleSelectionEnd)}selectCardsInBox(){if(!this.selectionBox)return;let A=this.selectionBox.getBoundingClientRect(),t=this.highlightContainer.querySelectorAll(".highlight-card"),r=window.HighlightCard;t.forEach(o=>{let l=o.getBoundingClientRect();!(A.right<l.left||A.left>l.right||A.bottom<l.top||A.top>l.bottom)?(o.addClass("selected"),r&&r.selectedCards&&r.selectedCards.add(o)):document.querySelector(".multi-select-mode")||(o.removeClass("selected"),r&&r.selectedCards&&r.selectedCards.delete(o))})}getViewType(){return ie}getDisplayText(){return"HiNote"}getIcon(){return"highlighter"}async onOpen(){let A=this.containerEl.children[1];A.empty(),A.addClass("comment-view-container"),A.addEventListener("highlight-multi-select",v=>{this.handleMultiSelect(v)}),document.addEventListener("click",this.handleGlobalClick);let t=A.createEl("div",{cls:"highlight-main-container"});this.fileListContainer=t.createEl("div",{cls:"highlight-file-list-container"}),this.mainContentContainer=t.createEl("div",{cls:"highlight-content-container"});let o=this.mainContentContainer.createEl("div",{cls:"highlight-back-button-container"}).createEl("div",{cls:"highlight-back-button"});(0,X.setIcon)(o,"arrow-left"),o.createEl("span",{text:f("BACK"),cls:"highlight-back-button-text"}),o.addEventListener("click",()=>{if(this.isMobileView&&this.isSmallScreen&&this.isDraggedToMainView){if(this.isFlashcardMode&&this.flashcardComponent){let v=this.flashcardComponent.getRenderer();if(v&&!v.isShowingSidebar()){v.showSidebar();return}}this.isShowingFileList=!0,this.updateViewLayout()}}),this.searchContainer=this.mainContentContainer.createEl("div",{cls:"highlight-search-container"}),this.searchInput=this.searchContainer.createEl("input",{cls:"highlight-search-input",attr:{type:"text",placeholder:f("Search...")}}),this.searchInput.addEventListener("focus",()=>{this.searchContainer.addClass("focused"),this.showSearchPrefixHints()}),this.searchInput.addEventListener("blur",v=>{this.searchContainer.removeClass("focused"),setTimeout(()=>{let F=document.querySelector(".search-prefix-hints");F&&F.remove()},200)}),this.searchLoadingIndicator=this.searchContainer.createEl("div",{cls:"highlight-search-loading"}),this.searchLoadingIndicator.innerHTML='<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="loading-spinner"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg>',this.searchLoadingIndicator.style.display="none";let l=this.searchContainer.createEl("div",{cls:"highlight-search-icons"}),c=l.createEl("div",{cls:"highlight-icon-button"});(0,X.setIcon)(c,"message-square-plus"),c.setAttribute("aria-label",f("Add File Comment")),c.addEventListener("click",async()=>{if(!this.currentFile){new X.Notice(f("Please open a file first."));return}let v=Date.now(),y={id:`file-comment-${v}`,text:`__virtual_highlight_${v}__`,filePath:this.currentFile.path,fileType:this.currentFile.extension,displayText:f("File Comment"),isVirtual:!0,position:0,paragraphOffset:0,paragraphId:`${this.currentFile.path}#^virtual-${v}`,createdAt:v,updatedAt:v,comments:[]};await this.commentStore.addComment(this.currentFile,y),this.highlights.unshift(y),this.renderHighlights(this.highlights),setTimeout(()=>{let E=this.highlightContainer.querySelector(".highlight-card");E&&(this.showCommentInput(E,y),this.highlightContainer.scrollTo({top:0,behavior:"smooth"}))},100)});let d=l.createEl("div",{cls:"highlight-icon-button"});(0,X.setIcon)(d,"file-symlink"),d.setAttribute("aria-label",f("Export as notes")),d.addEventListener("click",async()=>{if(!this.currentFile){new X.Notice(f("Please open a file first."));return}try{let v=await this.exportService.exportHighlightsToNote(this.currentFile);new X.Notice(f("Successfully exported highlights to: ")+v.path),await this.app.workspace.getLeaf().openFile(v)}catch(v){new X.Notice(f("Failed to export highlights: ")+v.message)}}),this.searchInput.addEventListener("input",this.handleSearchInputWithDebounce),this.highlightContainer=this.mainContentContainer.createEl("div",{cls:"highlight-container"}),this.registerDomEvent(document,"keydown",v=>{v.key==="Shift"&&this.highlightContainer.addClass("multi-select-mode")}),this.registerDomEvent(document,"keyup",v=>{v.key==="Shift"&&this.highlightContainer.removeClass("multi-select-mode")});let g=this.app.workspace.getActiveFile();g&&(this.currentFile=g,await this.updateHighlights()),this.updateViewLayout(),this.highlightContainer.empty();let u=this.searchInput.value.toLowerCase().trim(),m=this.highlights.filter(v=>{var F,y;return!!(v.text.toLowerCase().includes(u)||(F=v.comments)!=null&&F.some(E=>E.content.toLowerCase().includes(u))||this.currentFile===null&&((y=v.fileName)!=null&&y.toLowerCase().includes(u)))});this.renderHighlights(m)}renderHighlights(A,t=!1){if(t||(typeof UA.clearAllInstances=="function"?UA.clearAllInstances():UA.clearSelection(),this.highlightContainer.empty(),this.currentBatch=0,this.selectedHighlights.clear(),this.isSelectionMode=!1),A.length===0){let o=this.searchInput&&this.searchInput.value.trim()!=="",l=this.highlightContainer.createEl("div",{cls:"highlight-empty-state",text:o?f("No matching highlights found for your search."):f("The current document has no highlighted content.")});return}this.setupSelectionBox();let r=this.highlightContainer.querySelector(".highlight-list");r||(r=this.highlightContainer.createEl("div",{cls:"highlight-list"})),A.forEach(o=>{let l;this.currentFile&&!o.filePath&&(o.filePath=this.currentFile.path),l=new UA(r,o,this.plugin,{onHighlightClick:async d=>await this.jumpToHighlight(d),onCommentAdd:d=>this.showCommentInput(l.getElement(),d),onExport:d=>this.exportHighlightAsImage(d),onCommentEdit:(d,g)=>this.showCommentInput(l.getElement(),d,g),onAIResponse:async d=>{await this.addComment(o,d),await this.updateHighlights()}},this.isDraggedToMainView,this.currentFile===null?o.fileName:this.currentFile.basename),o.id&&this.highlightsWithFlashcards.has(o.id)&&setTimeout(()=>{o.id&&UA.updateCardUIByHighlightId(o.id)},0);let c=l.getElement();if(this.isDraggedToMainView){c.classList.add("in-main-view");let d=c.querySelector(".highlight-text-content");d&&d.removeAttribute("title")}else{c.classList.remove("in-main-view");let d=c.querySelector(".highlight-text-content");d&&d.setAttribute("aria-label","Jump to highlight")}})}async addComment(A,t){var l;let r=await this.getFileForHighlight(A);if(!r){new X.Notice(f("No corresponding file found."));return}A.id||(A.id=XA.generateHighlightId(((l=this.currentFile)==null?void 0:l.path)||"",A.position||0,A.text)),A.comments||(A.comments=[]);let o={id:XA.generateCommentId(),content:t,createdAt:Date.now(),updatedAt:Date.now()};A.comments.push(o),A.updatedAt=Date.now(),await this.commentStore.addComment(r,A),window.dispatchEvent(new CustomEvent("comment-updated",{detail:{text:A.text,comments:A.comments}})),await this.refreshView()}async updateComment(A,t,r){let o=await this.getFileForHighlight(A);if(!o||!A.comments)return;let l=A.comments.find(c=>c.id===t);if(l){let c=l.content;l.content=r,l.updatedAt=Date.now(),A.updatedAt=Date.now(),await this.commentStore.addComment(o,A),window.dispatchEvent(new CustomEvent("comment-updated",{detail:{text:A.text,comments:A.comments}})),A.id&&this.plugin.eventManager.emitCommentUpdate(o.path,c,r,A.id),await this.refreshView()}}checkHasFlashcard(A){let r=this.plugin.fsrsManager;if(!r||!A)return!1;let o=r.findCardsBySourceId(A,"highlight");return o&&o.length>0}async deleteComment(A,t){let r=await this.getFileForHighlight(A);if(!(!r||!A.comments)){if(A.comments=A.comments.filter(o=>o.id!==t),A.updatedAt=Date.now(),A.comments.length===0){let o=A.id?this.checkHasFlashcard(A.id):!1;A.isVirtual||!o?(await this.commentStore.removeComment(r,A),this.highlights=this.highlights.filter(l=>l.id!==A.id)):await this.commentStore.addComment(r,A)}else await this.commentStore.addComment(r,A);window.dispatchEvent(new CustomEvent("comment-updated",{detail:{text:A.text,comments:A.comments}})),await this.refreshView()}}async getFileForHighlight(A){if(this.currentFile)return this.currentFile;if(A.filePath){let t=this.app.vault.getAbstractFileByPath(A.filePath);if(t instanceof X.TFile)return t}if(A.fileName){let r=this.app.vault.getFiles().find(o=>o.basename===A.fileName||o.name===A.fileName);if(r)return r}return null}generateHighlightId(A){var t;return XA.generateHighlightId(((t=this.currentFile)==null?void 0:t.path)||"",A.position||0,A.text)}async jumpToHighlight(A){if(!this.isDraggedToMainView&&!A.isGlobalSearch){if(!this.currentFile){new X.Notice(f("No corresponding file found."));return}await this.locationService.jumpToHighlight(A,this.currentFile.path)}}async exportHighlightAsImage(A){try{let t=(await Promise.resolve().then(()=>ho(rn()))).default;new ds(this.app,A,t).open()}catch(t){new X.Notice(f("Export failed: Failed to load necessary components."))}}async showCommentInput(A,t,r){this.currentEditingHighlightId=t.id,new Us(A,t,r,{onSave:async o=>{r?await this.updateComment(t,r.id,o):await this.addComment(t,o),await this.updateHighlights()},onDelete:r?async()=>{await this.deleteComment(t,r.id)}:void 0,onCancel:async()=>{let o=this.highlights.find(l=>l.id===this.currentEditingHighlightId);if(o!=null&&o.isVirtual&&(!o.comments||o.comments.length===0)){let l=await this.getFileForHighlight(o);l&&(await this.commentStore.removeComment(l,o),this.highlights=this.highlights.filter(c=>c.id!==o.id),await this.refreshView())}}}).show()}async onload(){}async checkViewPosition(){let A=this.app.workspace.rootSplit;if(!A)return;let t=this.isViewInMainArea(this.leaf,A);if(this.isDraggedToMainView!==t){let r=this.isInAllHighlightsView(),o=[...this.highlights];if(this.isDraggedToMainView=t,t){this.checkIfMobile()&&this.checkIfSmallScreen()&&(this.isShowingFileList=!0);let l=this.app.workspace.getActiveFile();l?(this.currentFile=l,await this.updateHighlights()):(this.currentFile=null,await this.updateAllHighlights()),this.updateFileListSelection()}else{this.isFlashcardMode&&(this.isFlashcardMode=!1,this.flashcardComponent&&(this.flashcardComponent.deactivate(),this.flashcardComponent=null),this.updateFileListSelection());let l=this.app.workspace.getActiveFile();l?r?(this.currentFile=l,this.highlightContainer.empty(),this.highlightContainer.appendChild(this.loadingIndicator),setTimeout(()=>{this.updateHighlights()},10)):(this.currentFile=l,this.updateHighlights()):(this.highlights=[],this.renderHighlights([]))}this.updateViewLayout(),this.searchInput&&this.searchInput.value.trim()!==""&&this.updateHighlightsList()}}isViewInMainArea(A,t){return t&&t.children?t.children.some(r=>r===A?!0:this.isViewInMainArea(A,r)):!1}checkIfMobile(){return X.Platform.isMobile}checkIfSmallScreen(){return window.innerWidth<768}async updateViewLayout(){this.isMobileView=this.checkIfMobile(),this.isSmallScreen=this.checkIfSmallScreen(),this.fileListContainer.removeClass("highlight-display-block"),this.fileListContainer.removeClass("highlight-display-none"),this.mainContentContainer.removeClass("highlight-display-none");let A=this.containerEl.children[1];if(this.isDraggedToMainView?A.addClass("is-in-main-view"):A.removeClass("is-in-main-view"),this.isSmallScreen?A.addClass("is-small-screen"):A.removeClass("is-small-screen"),this.isDraggedToMainView)await this.updateFileList(),this.createFloatingButton(),this.isMobileView&&this.isSmallScreen?this.isShowingFileList?(this.fileListContainer.addClass("highlight-display-block"),this.mainContentContainer.addClass("highlight-display-none"),this.fileListContainer.addClass("highlight-full-width")):(this.fileListContainer.addClass("highlight-display-none"),this.mainContentContainer.removeClass("highlight-display-none"),this.fileListContainer.removeClass("highlight-full-width")):(this.fileListContainer.addClass("highlight-display-block"),this.mainContentContainer.removeClass("highlight-display-none"),this.fileListContainer.removeClass("highlight-full-width"));else if(this.fileListContainer.addClass("highlight-display-none"),this.removeFloatingButton(),!this.isFlashcardMode){this.searchContainer.removeClass("highlight-display-none");let t=this.searchContainer.querySelector(".highlight-search-icons");t&&t.removeClass("highlight-display-none")}}async updateFileList(){var y;if(this.fileListContainer.children.length>0){this.updateFileListSelection();return}this.fileListContainer.empty(),this.fileListContainer.createEl("div",{cls:"highlight-file-list-header"}).createEl("div",{text:"HiNote",cls:"highlight-file-list-title"});let t=this.fileListContainer.createEl("div",{cls:"highlight-file-list"}),r=t.createEl("div",{cls:`highlight-file-item highlight-file-item-all ${this.currentFile===null?"is-active":""}`});r.addEventListener("click",()=>{this.currentFile=null,this.isFlashcardMode=!1,this.updateHighlights(),this.updateFileListSelection(),this.searchContainer.removeClass("highlight-display-none");let E=this.searchContainer.querySelector(".highlight-search-icons");E&&E.addClass("highlight-display-none")});let o=r.createEl("div",{cls:"highlight-file-item-left"}),l=o.createEl("span",{cls:"highlight-file-item-icon"});(0,X.setIcon)(l,"square-library"),o.createEl("span",{text:f("All Highlight"),cls:"highlight-file-item-name"});let c=t.createEl("div",{cls:"highlight-file-item highlight-file-item-flashcard"});c.addEventListener("click",async()=>{this.currentFile=null,this.isFlashcardMode=!0,this.updateFileListSelection(),this.searchContainer.addClass("highlight-display-none"),this.highlightContainer.empty(),this.flashcardComponent||(this.flashcardComponent=new si(this.highlightContainer,this.plugin),this.flashcardComponent.setLicenseManager(this.licenseManager)),this.isMobileView&&this.isSmallScreen&&this.isDraggedToMainView&&(this.isShowingFileList=!1,this.updateViewLayout()),await this.flashcardComponent.activate()});let d=c.createEl("div",{cls:"highlight-file-item-left"}),g=d.createEl("span",{cls:"highlight-file-item-icon"});(0,X.setIcon)(g,"book-heart"),d.createEl("span",{text:f("HiCard"),cls:"highlight-file-item-name"});let u=c.createEl("span",{cls:"highlight-file-item-count"}),m=async()=>{let E=this.plugin.fsrsManager.getTotalCardsCount();u.textContent=`${E}`};m(),this.registerEvent(this.plugin.eventManager.on("flashcard:changed",()=>{m()})),d.addEventListener("click",async()=>{let E=this.plugin.fsrsManager.getCardGroups(),H=[];if(E&&E.length>0){let x=E[0].id;H=this.plugin.fsrsManager.getCardsForStudy(x),this.highlightContainer.empty(),this.flashcardComponent||(this.flashcardComponent=new si(this.highlightContainer,this.plugin),this.flashcardComponent.setLicenseManager(this.licenseManager)),await this.flashcardComponent.activate(),this.updateFileListSelection()}});let v=await this.getTotalHighlightsCount();r.createEl("span",{text:`${v}`,cls:"highlight-file-item-count"}),t.createEl("div",{cls:"highlight-file-list-separator"}),r.addEventListener("click",async()=>{this.currentFile=null,this.isFlashcardMode=!1,this.flashcardComponent&&(this.flashcardComponent.deactivate(),this.flashcardComponent=null),this.updateFileListSelection(),this.isMobileView&&this.isSmallScreen&&this.isDraggedToMainView&&(this.isShowingFileList=!1,this.updateViewLayout()),await this.updateAllHighlights()});let F=await this.getFilesWithHighlights();for(let E of F){let H=t.createEl("div",{cls:`highlight-file-item ${((y=this.currentFile)==null?void 0:y.path)===E.path?"is-active":""}`});H.setAttribute("data-path",E.path);let x=H.createEl("div",{cls:"highlight-file-item-left"}),M=x.createEl("span",{cls:"highlight-file-item-icon",attr:{"aria-label":f("Open (DoubleClick)")}});(0,X.setIcon)(M,"file-text"),M.addEventListener("dblclick",async N=>{N.stopPropagation(),await this.getPreferredLeaf().openFile(E)});let T=x.createEl("span",{text:E.basename,cls:"highlight-file-item-name"});this.addPagePreview(T,E);let R=await this.getFileHighlightsCount(E);H.createEl("span",{text:`${R}`,cls:"highlight-file-item-count"}),H.addEventListener("click",async()=>{this.currentFile=E,this.isFlashcardMode=!1,this.flashcardComponent&&(this.flashcardComponent.deactivate(),this.flashcardComponent=null),this.updateFileListSelection(),this.searchContainer.removeClass("highlight-display-none");let N=this.searchContainer.querySelector(".highlight-search-icons");N&&N.removeClass("highlight-display-none"),this.isMobileView&&this.isSmallScreen&&this.isDraggedToMainView&&(this.isShowingFileList=!1,this.updateViewLayout()),await this.updateHighlights()})}}updateFileListSelection(){let A=this.fileListContainer.querySelector(".highlight-file-item-all");A&&A.classList.toggle("is-active",this.currentFile===null&&!this.isFlashcardMode);let t=this.fileListContainer.querySelector(".highlight-file-item-flashcard");t&&t.classList.toggle("is-active",this.isFlashcardMode),this.fileListContainer.querySelectorAll(".highlight-file-item:not(.highlight-file-item-all):not(.highlight-file-item-flashcard)").forEach(o=>{var c;let l=((c=this.currentFile)==null?void 0:c.path)===o.getAttribute("data-path");o.classList.toggle("is-active",l)})}async getFilesWithHighlights(){let t=(await this.app.vault.getMarkdownFiles()).filter(o=>this.highlightService.shouldProcessFile(o)),r=[];for(let o of t){let l=await this.app.vault.read(o);this.highlightService.extractHighlights(l,o).length>0&&r.push(o)}return r}async updateAllHighlights(A="",t=""){this.currentBatch=0,this.highlights=[],this.highlightContainer.empty(),this.highlightContainer.appendChild(this.loadingIndicator);try{if(t==="path"){let d=await this.highlightService.getAllHighlights(),g=new Map,u=this.app.vault.getMarkdownFiles();for(let m of u){let v=this.commentStore.getFileComments(m);v&&v.length>0&&g.set(m.path,v)}this.highlights=[];for(let{file:m,highlights:v}of d){if(A&&!m.path.toLowerCase().includes(A.toLowerCase()))continue;let F=g.get(m.path)||[],y=new Set,E=v.map(x=>{let M=F.find(T=>!y.has(T.id)&&T.id===x.id);if(M||(M=F.find(T=>{if(y.has(T.id))return!1;let R=T.text===x.text;return R&&x.position!==void 0&&T.position!==void 0?Math.abs(T.position-x.position)<1e3:R})),!M&&x.position!==void 0){let T=x.position;M=F.find(R=>!y.has(R.id)&&R.position!==void 0&&Math.abs(R.position-T)<50)}return M?(y.add(M.id),{...x,id:M.id,comments:M.comments||[],createdAt:M.createdAt,updatedAt:M.updatedAt,fileName:m.basename,filePath:m.path,fileIcon:"file-text"}):{...x,comments:x.comments||[],fileName:m.basename,filePath:m.path,fileIcon:"file-text"}});this.highlights.push(...E),F.filter(x=>x.isVirtual&&x.comments&&x.comments.length>0&&!y.has(x.id)).forEach(x=>{y.add(x.id),this.highlights.push({...x,fileName:m.basename,filePath:m.path,fileIcon:"file-text",position:x.position||0})})}await this.loadMoreHighlights();return}if(A){let d=Date.now(),g=await this.highlightService.searchHighlightsFromIndex(A);this.highlights=g.map(u=>{var m;return{...u,comments:u.comments||[],fileName:u.fileName||(u.filePath?(m=u.filePath.split("/").pop())==null?void 0:m.replace(".md",""):""),filePath:u.filePath||"",fileIcon:"file-text"}}),await this.loadMoreHighlights();return}let r=await this.highlightService.getAllHighlights(),o=new Map,l=this.app.vault.getMarkdownFiles();for(let d of l){let g=this.commentStore.getFileComments(d);g&&g.length>0&&o.set(d.path,g)}this.highlights=[];for(let{file:d,highlights:g}of r){let u=o.get(d.path)||[],m=new Set,v=g.map(y=>{let E=u.find(H=>!m.has(H.id)&&H.id===y.id);if(E||(E=u.find(H=>{if(m.has(H.id))return!1;let x=H.text===y.text;return x&&y.position!==void 0&&H.position!==void 0?Math.abs(H.position-y.position)<1e3:x})),!E&&y.position!==void 0){let H=y.position;E=u.find(x=>!m.has(x.id)&&x.position!==void 0&&Math.abs(x.position-H)<50)}return E?(m.add(E.id),{...y,id:E.id,comments:E.comments||[],createdAt:E.createdAt,updatedAt:E.updatedAt,fileName:d.basename,filePath:d.path,fileIcon:"file-text"}):{...y,comments:y.comments||[],fileName:d.basename,filePath:d.path,fileIcon:"file-text"}});this.highlights.push(...v),u.filter(y=>y.isVirtual&&y.comments&&y.comments.length>0&&!m.has(y.id)).forEach(y=>{m.add(y.id),this.highlights.push({...y,fileName:d.basename,filePath:d.path,fileIcon:"file-text",position:y.position||0})})}await this.loadMoreHighlights();let c=(0,X.debounce)(async d=>{let g=d.target,{scrollTop:u,scrollHeight:m,clientHeight:v}=g;m-u-v<300&&await this.loadMoreHighlights()},100);this.highlightContainer.addEventListener("scroll",c),this.register(()=>this.highlightContainer.removeEventListener("scroll",c))}catch(r){console.error("[CommentView] Error in updateAllHighlights:",r),new X.Notice(f("Error loading all highlights")),this.highlightContainer.empty(),this.highlightContainer.createEl("div",{cls:"highlight-empty-state",text:f("Error loading highlights. Please try again.")})}finally{this.loadingIndicator.removeClass("highlight-display-block")}}async loadMoreHighlights(){if(!this.isLoading){this.isLoading=!0,this.loadingIndicator.addClass("highlight-display-block");try{let A=this.currentBatch*this.BATCH_SIZE,t=this.highlights.slice(A,A+this.BATCH_SIZE);if(t.length===0){this.loadingIndicator.remove();return}await this.renderHighlights(t,!0),this.currentBatch++}catch(A){new X.Notice("\u52A0\u8F7D\u9AD8\u4EAE\u5185\u5BB9\u65F6\u51FA\u9519")}finally{this.isLoading=!1,this.loadingIndicator.addClass("highlight-display-none")}}}async getFileHighlightsCount(A){let t=await this.app.vault.read(A);return this.highlightService.extractHighlights(t,A).length}async getTotalHighlightsCount(){let A=await this.getFilesWithHighlights(),t=0;for(let r of A)t+=await this.getFileHighlightsCount(r);return t}createFloatingButton(){if(this.floatingButton)return;this.floatingButton=document.createElement("div"),this.floatingButton.className="highlight-floating-button";let A=document.createElement("span");(0,X.setIcon)(A,"bot-message-square"),this.floatingButton.appendChild(A),this.floatingButton.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();try{let r=ze.getInstance(this.app,this.plugin);setTimeout(()=>{r.show()},0)}catch(r){console.error("\u521B\u5EFAChatView\u5931\u8D25:",r)}}),document.body.appendChild(this.floatingButton),this.registerActiveLeafChangeHandler()}removeFloatingButton(){this.floatingButton&&(this.floatingButton.remove(),this.floatingButton=null),this.unregisterActiveLeafChangeHandler()}registerActiveLeafChangeHandler(){this.unregisterActiveLeafChangeHandler(),this.activeLeafChangeHandler=()=>{this.updateFloatingButtonVisibility(),typeof UA.clearAllInstances=="function"&&UA.clearAllInstances(),this.updateHighlights()},this.app.workspace.on("active-leaf-change",this.activeLeafChangeHandler),this.updateFloatingButtonVisibility()}unregisterActiveLeafChangeHandler(){this.activeLeafChangeHandler&&(this.app.workspace.off("active-leaf-change",this.activeLeafChangeHandler),this.activeLeafChangeHandler=void 0)}updateFloatingButtonVisibility(){if(!this.floatingButton)return;let A=this.app.workspace.activeLeaf;A&&A.view&&A.view.getViewType()===ie?this.floatingButton.style.display="flex":this.floatingButton.style.display="none"}onunload(){this.removeFloatingButton(),this.unregisterActiveLeafChangeHandler()}updateAIDropdowns(){this.aiButtons.forEach(A=>{}),this.app.workspace.trigger("comment-view:update-ai-dropdowns")}registerAIButton(A){this.aiButtons.push(A)}unregisterAIButton(A){let t=this.aiButtons.indexOf(A);t!==-1&&this.aiButtons.splice(t,1)}isInAllHighlightsView(){return this.currentFile===null}filterHighlightsByTerm(A,t=""){if(t==="path")return this.highlights.forEach(r=>{if(r.filePath&&!r.fileName){let o=r.filePath.split("/");r.fileName=o[o.length-1]}}),!A||A.trim()===""?this.highlights.filter(r=>!!r.filePath):this.highlights.filter(r=>r.filePath?r.filePath.toLowerCase().includes(A.toLowerCase()):!1);if(t==="hicard"){let r=this.plugin.fsrsManager;return r?this.highlights.filter(o=>{var c,d;return(o.id?r.findCardsBySourceId(o.id,"highlight").length>0:!1)?A?!!(o.text.toLowerCase().includes(A)||(c=o.comments)!=null&&c.some(g=>g.content.toLowerCase().includes(A))||this.currentFile===null&&((d=o.fileName)!=null&&d.toLowerCase().includes(A))):!0:!1}):[]}return t==="comment"?this.highlights.filter(r=>{var l;return r.comments&&r.comments.length>0?A?!!(r.text.toLowerCase().includes(A)||r.comments&&r.comments.some(c=>c.content.toLowerCase().includes(A))||this.currentFile===null&&((l=r.fileName)!=null&&l.toLowerCase().includes(A))):!0:!1}):this.highlights.filter(r=>{var o,l;return!!(r.text.toLowerCase().includes(A)||(o=r.comments)!=null&&o.some(c=>c.content.toLowerCase().includes(A))||this.currentFile===null&&((l=r.fileName)!=null&&l.toLowerCase().includes(A)))})}showSearchPrefixHints(){let A=document.querySelector(".search-prefix-hints");A&&A.remove();let t=document.body.createDiv({cls:"search-prefix-hints show"});[{prefix:"all:",description:f("search-prefix-all")},{prefix:"path:",description:f("search-prefix-path")},{prefix:"hicard:",description:f("search-prefix-hicard")},{prefix:"comment:",description:f("search-prefix-comment")}].forEach(({prefix:d,description:g})=>{let u=t.createDiv({cls:"search-prefix-hint-item"}),m=u.createSpan({cls:"search-prefix-tag",text:d}),v=u.createSpan({cls:"search-prefix-description",text:g});u.addEventListener("click",()=>{this.searchInput.value=d+" ",this.searchInput.focus(),t.remove();let F=new Event("input",{bubbles:!0});this.searchInput.dispatchEvent(F)})}),this.positionSearchHints(t);let o=()=>{this.searchInput.value.trim()===""?document.body.contains(t)||(document.body.appendChild(t),this.positionSearchHints(t)):t&&document.body.contains(t)&&t.remove()};this.searchInput.addEventListener("input",o);let l=d=>{t&&!t.contains(d.target)&&d.target!==this.searchInput&&(t.remove(),document.removeEventListener("click",l))},c=()=>{setTimeout(()=>{(!document.activeElement||document.activeElement!==this.searchInput&&!t.contains(document.activeElement))&&t.remove()},200)};this.searchInput.addEventListener("blur",c),setTimeout(()=>{document.addEventListener("click",l)},10),this.searchHintsEventHandlers={input:o,blur:c,click:l}}positionSearchHints(A){let t=this.searchInput.getBoundingClientRect();A.addClass("search-hints-container"),A.style.top=t.bottom+4+"px",A.style.left=t.left+"px",A.style.width=t.width+"px"}showSearchLoadingIndicator(){this.isSearching||(this.isSearching=!0,this.searchLoadingIndicator.style.display="flex")}hideSearchLoadingIndicator(){this.isSearching&&(this.isSearching=!1,this.searchLoadingIndicator.style.display="none")}async updateHighlightsList(){try{let A=this.searchInput.value.toLowerCase().trim(),t=A.startsWith("all:"),r=A.startsWith("hicard:"),o=A.startsWith("comment:"),l=A.startsWith("path:"),c="";t?c="all":r?c="hicard":o?c="comment":l&&(c="path");let d=A;if(t?d=A.substring(4).trim():r?d=A.substring(7).trim():o?d=A.substring(8).trim():l&&(d=A.substring(5).trim()),this.highlights.some(u=>u.isGlobalSearch)&&!t&&this.currentFile){this.highlightContainer.empty(),this.highlightContainer.appendChild(this.loadingIndicator),await this.updateHighlights(),this.highlights.forEach(m=>{m.isGlobalSearch=!1});let u=this.filterHighlightsByTerm(d,c);this.renderHighlights(u);return}if((t||l)&&this.currentFile!==null){this.highlightContainer.empty(),this.highlightContainer.appendChild(this.loadingIndicator);let u=this.currentFile;try{this.currentFile=null,await this.updateAllHighlights(d,c),this.highlights.forEach(m=>{m.isGlobalSearch=!0}),this.renderHighlights(this.highlights)}finally{this.currentFile=u,this.hideSearchLoadingIndicator()}}else{this.highlights.forEach(m=>{m.isGlobalSearch=!1});let u=this.filterHighlightsByTerm(d,c);this.renderHighlights(u),this.hideSearchLoadingIndicator()}}catch(A){console.error("[\u9AD8\u4EAE\u641C\u7D22] \u641C\u7D22\u8FC7\u7A0B\u4E2D\u51FA\u9519:",A),this.hideSearchLoadingIndicator()}}async refreshView(){this.isInAllHighlightsView()?await this.updateAllHighlights():await this.updateHighlights()}async updateHighlights(A=!1){if(this.isInAllHighlightsView()){await this.updateAllHighlights();return}if(!this.currentFile){this.renderHighlights([]);return}if(this.currentFile.extension==="canvas"){await this.handleCanvasFile(this.currentFile);return}if(!this.highlightService.shouldProcessFile(this.currentFile)){this.renderHighlights([]);return}let t=await this.app.vault.read(this.currentFile),r=this.highlightService.extractHighlights(t,this.currentFile),o=this.commentStore.getFileComments(this.currentFile),l=new Set;this.highlights=r.map(g=>{var m;let u=o.find(v=>{if(l.has(v.id))return!1;let F=v.text===g.text;return F&&g.position!==void 0&&v.position!==void 0?Math.abs(v.position-g.position)<1e3:F});if(!u&&g.position!==void 0&&(u=o.find(v=>!l.has(v.id)&&v.position!==void 0&&g.position!==void 0&&Math.abs(v.position-g.position)<50)),!u&&this.plugin.highlightMatchingService){let v={id:g.id||XA.generateHighlightId(((m=this.currentFile)==null?void 0:m.path)||"",g.position||0,g.text),text:g.text,position:g.position||0,comments:[],createdAt:g.createdAt||Date.now(),updatedAt:g.updatedAt||Date.now(),blockId:g.blockId,paragraphId:g.paragraphId,paragraphOffset:g.paragraphOffset||0,isVirtual:!1};if(this.currentFile){let F=this.plugin.highlightMatchingService.findMatchingHighlight(this.currentFile,v);F&&!l.has(F.id)&&(u=F)}}return u?(l.add(u.id),{...g,id:u.id,comments:u.comments,createdAt:u.createdAt,updatedAt:u.updatedAt}):g});let d=o.filter(g=>g.isVirtual&&g.comments&&g.comments.length>0&&!l.has(g.id)).filter(g=>!this.highlights.some(u=>u.text===g.text));if(d.forEach(g=>l.add(g.id)),this.highlights.unshift(...d),A&&this.currentFile&&this.highlights.forEach(g=>{var u;g.isFromCanvas=!0,g.isGlobalSearch=!0,g.fileName=(u=this.currentFile)==null?void 0:u.name}),this.highlightsWithFlashcards=new Set,this.plugin&&this.plugin.fsrsManager){let g=this.plugin.fsrsManager;for(let u of this.highlights)if(u.id){let m=g.findCardsBySourceId(u.id,"highlight");m&&m.length>0&&this.highlightsWithFlashcards.add(u.id)}}this.searchInput&&this.searchInput.value.trim()!==""?this.updateHighlightsList():this.renderHighlights(this.highlights)}async handleCanvasFile(A){this.highlightContainer.empty(),this.loadingIndicator&&(this.highlightContainer.appendChild(this.loadingIndicator),this.loadingIndicator.removeClass("highlight-display-none"));try{let t=await this.canvasService.parseCanvasFile(A);if(t.length===0){this.highlightContainer.empty();let r=this.highlightContainer.createDiv({cls:"no-highlights-message",text:"There are no file nodes in the current Canvas."});return}await this.updateAllHighlights("","path"),this.highlights=this.highlights.filter(r=>r.filePath?t.includes(r.filePath):!1),this.highlights.forEach(r=>{r.isFromCanvas=!0,r.canvasSource=A.path,r.isGlobalSearch=!0}),this.renderHighlights(this.highlights)}catch(t){console.error("\u5904\u7406 Canvas \u6587\u4EF6\u5931\u8D25:",t),this.highlightContainer.empty();let r=this.highlightContainer.createDiv({cls:"error-message",text:"\u5904\u7406 Canvas \u6587\u4EF6\u65F6\u51FA\u9519"})}finally{this.loadingIndicator&&this.loadingIndicator.addClass("highlight-display-none")}}addPagePreview(A,t){let r;A.addEventListener("mouseenter",o=>{r=setTimeout(async()=>{let l=o.target;this.app.workspace.trigger("hover-link",{event:o,source:"hi-note",hoverParent:l,targetEl:l,linktext:t.path})},300)}),A.addEventListener("mouseleave",()=>{r&&clearTimeout(r)})}getPreferredLeaf(){let A=this.app.workspace.getLeavesOfType("markdown");if(this.isDraggedToMainView){let t=A.find(r=>r!==this.leaf);if(t)return t}return this.app.workspace.getLeaf("split","vertical")}};var nn=require("obsidian");var Is=class{constructor(e){this.data={};this.comments=new Map;this.commentCache=new Map;this.maxCacheSize=100;this.PERFORMANCE_THRESHOLD=100;this.plugin=e,this.eventManager=new Ze(e.app),this.blockIdService=new Ht(e.app),this.highlightService=new oe(e.app)}async loadComments(){let e=await this.plugin.loadData();this.data=(e==null?void 0:e.comments)||{},this.migrateDataToBlockId(),this.comments=new Map(Object.entries(this.data).map(([A,t])=>[A,Object.values(t)]))}migrateDataToBlockId(){let e=0;for(let A in this.data){let t=this.data[A];for(let r in t){let o=t[r];if(o.paragraphId&&!o.blockId){let l=o.paragraphId.match(/#\^([a-zA-Z0-9-]+)/);l&&l[1]&&(o.blockId=l[1],e++)}}}}async saveComments(){let A={...await this.plugin.loadData()||{},comments:this.data};await this.plugin.saveData(A);let t=await this.plugin.loadData()}async checkOrphanedDataCount(){let e=0,A=new Set;for(let t in this.data){let r=this.plugin.app.vault.getAbstractFileByPath(t);if(!r||!(r instanceof nn.TFile)){A.add(t),e+=Object.keys(this.data[t]||{}).length;continue}try{let o=await this.plugin.app.vault.read(r),l=this.highlightService.extractHighlights(o,r),c=new Set(l.map(u=>u.text)),d=this.data[t]||{},g=!1;for(let u in d){let m=d[u];m.isVirtual||c.has(m.text)||(e++,g=!0)}g&&A.add(t)}catch(o){}}return{orphanedHighlights:e,affectedFiles:A.size}}async cleanOrphanedData(){let e=0,A=new Set;for(let t in this.data){let r=this.plugin.app.vault.getAbstractFileByPath(t);if(!r||!(r instanceof nn.TFile)){delete this.data[t],this.comments.delete(t),A.add(t),e+=Object.keys(this.data[t]||{}).length;continue}try{let o=await this.plugin.app.vault.read(r),l=this.highlightService.extractHighlights(o,r),c=new Set(l.map(u=>u.text)),d=this.data[t]||{},g=!1;for(let u in d){let m=d[u];m.isVirtual||c.has(m.text)||(delete d[u],e++,g=!0)}g&&(A.add(t),this.comments.set(t,Object.values(d)),Object.keys(d).length===0&&(delete this.data[t],this.comments.delete(t)))}catch(o){}}return e>0&&await this.saveComments(),{removedHighlights:e,affectedFiles:A.size}}async updateFilePath(e,A){this.data[e]&&(this.data[A]=this.data[e],delete this.data[e]);let t=this.comments.get(e)||[];this.comments.set(A,t),this.comments.delete(e),await this.saveComments()}getHiNotes(e){let A=this.plugin.app.workspace.getActiveFile();if(!A)return[];let t=this.data[A.path]||{};return Object.values(t).filter(r=>{let o=r.text===e.text;return o&&typeof r.position=="number"&&typeof e.position=="number"?Math.abs(r.position-e.position)<1e3:o})}getFileComments(e){if(!e)return[];let A=this.data[e.path]||{};return Object.values(A)}async addComment(e,A){A.id||(A.id=XA.generateHighlightId(e.path,A.position||0,A.text));let t=Date.now();A.createdAt||(A.createdAt=t),A.updatedAt=t;let r=e.path;this.data[r]||(this.data[r]={}),this.data[r][A.id]=A,this.comments.has(r)||this.comments.set(r,[]);let o=this.comments.get(r)||[],l=o.findIndex(c=>c.id===A.id);if(l>=0?o[l]=A:o.push(A),await this.saveComments(),this.eventManager)if(A.comments&&A.comments.length>0){let c=A.comments[A.comments.length-1];this.eventManager.emitCommentUpdate(r,A.text,c.content,A.id)}else this.eventManager.emitHighlightUpdate(r,A.text,A.text,A.id);return A}async removeComment(e,A){let t=e.path;if(!this.data[t]||!this.data[t][A.id])return!1;if(delete this.data[t][A.id],Object.keys(this.data[t]).length===0&&delete this.data[t],this.comments.has(t)){let o=(this.comments.get(t)||[]).filter(l=>l.id!==A.id);o.length>0?this.comments.set(t,o):this.comments.delete(t)}if(await this.saveComments(),this.eventManager)if(A.comments&&A.comments.length>0){let r=A.comments[A.comments.length-1];this.eventManager.emitCommentDelete(t,r.content,A.id)}else this.eventManager.emitHighlightDelete(t,A.text,A.id);return!0}getCommentsByBlockId(e,A){if(!e||!A)return[];let t=e.path;return this.data[t]?Object.values(this.data[t]).filter(o=>o.blockId===A):[]}};var je=require("@codemirror/view"),an=require("obsidian");var Uo=require("@codemirror/view"),bt=require("obsidian");var Hs=class Q extends Uo.WidgetType{constructor(A,t,r,o){super();this.plugin=A;this.highlight=t;this.highlightItems=r;this.onClick=o;this.app=this.plugin.app,this.textSimilarityService=new we(this.plugin.app)}eq(A){return!(A instanceof Q)||this.highlight.id!==A.highlight.id?!1:(this.textSimilarityService.calculateSimilarity(this.highlight.text,A.highlight.text)>.7||this.highlight.text===A.highlight.text)&&this.highlight.comments.length===A.highlight.comments.length}get estimatedHeight(){return 0}get lineBreaks(){return 0}toDOM(){let A=document.createElement("span");A.addClass("hi-note-widget"),A.setAttribute("data-highlight-id",this.highlight.id);let t=(this.highlight.comments||[]).length>0;return this.createButton(A),A}createButton(A){let t=(this.highlight.comments||[]).length>0,r=A.createEl("button",{cls:`hi-note-button clickable-icon ${t?"":"hi-note-button-hidden"}`}),o=this.createIconContainer(r),l=this.createTooltip(A);this.setupEventListeners(A,r,l)}createIconContainer(A){let t=A.createEl("span",{cls:"hi-note-icon-container"});(0,bt.setIcon)(t,"message-circle");let o=(this.highlight.comments||[]).length;return o>0&&t.createEl("span",{cls:"hi-note-count",text:o.toString()}),t}createTooltip(A){let t=document.createElement("div");t.addClass("hi-note-tooltip","hi-note-tooltip-hidden"),t.setAttribute("data-highlight-id",this.highlight.id);let r=t.createEl("div",{cls:"hi-note-tooltip-list"}),o=this.highlight.comments||[];return this.renderTooltipContent(r,o,t),document.body.appendChild(t),{tooltip:t,updateTooltipPosition:()=>{let c=A.getBoundingClientRect();t.style.position="fixed",t.style.top=`${c.bottom+4}px`,t.style.left=`${c.right-t.offsetWidth}px`}}}renderTooltipContent(A,t,r){t.length!==0&&(t.slice(0,3).forEach(o=>{let l=A.createEl("div",{cls:"hi-note-tooltip-item"}),c=l.createEl("div",{cls:"hi-note-tooltip-content markdown-rendered"});this.renderMarkdownContent(c,o.content),l.createEl("div",{cls:"hi-note-tooltip-time",text:new Date(o.createdAt).toLocaleString()})}),t.length>3&&r.createEl("div",{cls:"hi-note-tooltip-more",text:`\u8FD8\u6709 ${t.length-3} \u6761\u8BC4\u8BBA...`}))}setupEventListeners(A,t,r){let{tooltip:o,updateTooltipPosition:l}=r;(this.highlight.comments||[]).length>0?(t.removeClass("hi-note-button-hidden"),t.addEventListener("mouseenter",()=>{o.removeClass("hi-note-tooltip-hidden"),l()}),t.addEventListener("mouseleave",()=>{o.addClass("hi-note-tooltip-hidden")})):(t.addClass("hi-note-button-hidden"),A.addEventListener("mouseenter",()=>{t.removeClass("hi-note-button-hidden")}),A.addEventListener("mouseleave",()=>{t.addClass("hi-note-button-hidden")})),t.addEventListener("click",g=>{g.preventDefault(),g.stopPropagation(),this.onClick(),o.addClass("hi-note-tooltip-hidden");let u=new CustomEvent("open-comment-input",{detail:{highlightId:this.highlight.id,text:this.highlight.text}});window.dispatchEvent(u)}),window.addEventListener("resize",l)}async renderMarkdownContent(A,t){try{await bt.MarkdownRenderer.render(this.app,t,A,"",new bt.Component),A.querySelectorAll("ul, ol").forEach(o=>{o.addClass("tooltip-markdown-list")})}catch(r){console.error("Error rendering markdown in tooltip:",r),A.textContent=t}}destroy(A){let t=document.querySelector(`.hi-note-tooltip[data-highlight-id="${this.highlight.id}"]`);t&&t.remove(),A.remove()}updateDOM(A){return!1}ignoreEvent(){return!1}};var bs=class{constructor(e,A){this.plugin=e,this.commentStore=A,this.highlightService=new oe(this.plugin.app),this.textSimilarityService=new we(this.plugin.app)}findMatchingHighlight(e,A,t){if(!t||t.length===0)return null;let r=t.find(o=>o.text===A.text&&(typeof o.position!="number"||typeof A.position!="number"||Math.abs(o.position-A.position)<10))||null;if(!r&&typeof A.position=="number"&&(r=t.find(o=>typeof o.position=="number"&&Math.abs(o.position-A.position)<30)||null),!r){let o=null,l=0;for(let c of t){if(!c.comments||c.comments.length===0)continue;let d=this.textSimilarityService.calculateSimilarity(c.text,A.text);d>l&&d>.6&&(l=d,o=c)}o&&(r=o)}return r}getActiveMarkdownView(){return this.plugin.app.workspace.getActiveViewOfType(an.MarkdownView)}enable(){let e=this.plugin,A=this.commentStore,t=this.highlightService,r=this.textSimilarityService,o=this.findMatchingHighlight.bind(this);this.plugin.registerDomEvent(window,"comment-updated",c=>{let d=document.querySelectorAll(".hi-note-widget"),g=c.detail.text,u=this.getActiveMarkdownView();if(!u||!u.file)return;let m=this.commentStore.getFileComments(u.file);m&&d.forEach(v=>{let F=v.getAttribute("data-highlight-text");if(F===g){let y=m.find(M=>M.text===F),E=(y==null?void 0:y.comments)||[],H=v.querySelector(".hi-note-count");if(H){let M=E.length;H.textContent=M.toString();let T=v.querySelector(".hi-note-button");M===0?T==null||T.addClass("hi-note-button-hidden"):T==null||T.removeClass("hi-note-button-hidden")}let x=v.querySelector(".hi-note-tooltip");x&&this.updateTooltipContent(x,E)}})});let l=je.ViewPlugin.fromClass(class{constructor(c){this.plugin=e,this.commentStore=A,this.highlightService=new oe(this.plugin.app),this.textSimilarityService=new we(this.plugin.app),this.decorations=this.buildDecorations(c)}createHiNoteFromHighlight(c){return{...c,id:c.id||`highlight-${Date.now()}-${c.position}`,comments:c.comments||[],position:c.position,paragraphOffset:c.paragraphOffset||0,blockId:c.blockId,paragraphId:c.paragraphId||`p-${c.paragraphOffset||0}`,createdAt:c.createdAt||Date.now(),updatedAt:c.updatedAt||Date.now(),text:c.text}}findExactMatchingHighlight(c,d){return d.find(g=>g.text===c.text&&(typeof g.position!="number"||typeof c.position!="number"||Math.abs(g.position-c.position)<10))||null}handleTextChanges(c,d,g){d.text!==g.text&&e.highlightMatchingService.recoverHighlight(c,d,g.text).then(u=>{u&&e.eventManager.emitHighlightUpdate(c.path,d.text,g.text)})}getCommentsForHighlight(c,d,g=!0){let u=[];if(d.blockId){let m=A.getCommentsByBlockId(c,d.blockId);if(m&&m.length>0){let v=m.find(F=>F.text===d.text);if(v)u=v.comments||[];else{let F=this.findExactMatchingHighlight(d,m);if(F)u=F.comments||[];else if(g){let y=o(c,d,m);y&&(this.handleTextChanges(c,y,d),u=y.comments||[])}}}}else{let m=A.getHiNotes(d);if(m&&m.length>0){let v=m.find(F=>F.text===d.text);if(v)u=v.comments||[];else{let F=this.findExactMatchingHighlight(d,m);if(F)u=F.comments||[];else if(g){let y=o(c,d,m);y&&(this.handleTextChanges(c,y,d),u=y.comments||[])}}}}return u}calculateHighlightPosition(c,d){var F;let g=(F=d.originalLength)!=null?F:d.text.length+4,u=c.slice(d.position,d.position+g),m=u.startsWith("<"),v;if(m){let y=/<[^>]+>/.exec(u),E=/<\/[^>]+>/.exec(u);v=d.position+g}else v=d.position+d.text.length+4;return{highlightEndPos:v,isHtmlTag:m,originalText:u,originalLength:g}}findMatchingHighlight(c,d,g){if(!g||g.length===0)return null;let u=g.find(m=>m.text===d.text&&(typeof m.position!="number"||typeof d.position!="number"||Math.abs(m.position-d.position)<10))||null;if(!u&&typeof d.position=="number"&&(u=g.find(m=>typeof m.position=="number"&&Math.abs(m.position-d.position)<30)||null),!u){let m=null,v=0;for(let F of g){if(!F.comments||F.comments.length===0)continue;let y=this.textSimilarityService.calculateSimilarity(F.text,d.text);y>v&&y>.6&&(v=y,m=F)}m&&(u=m)}return u}update(c){(c.docChanged||c.viewportChanged)&&(this.decorations=this.buildDecorations(c.view))}buildDecorations(c){var F,y;let d=[],u=c.state.doc.toString(),m=this.plugin.app.workspace.getActiveViewOfType(an.MarkdownView);if(!m||!m.file)return je.Decoration.none;if(!this.highlightService.shouldProcessFile(m.file))return je.Decoration.none;let v=this.highlightService.extractHighlights(u,m.file);for(let E of v){if(E.position===void 0)continue;let H=this.createHiNoteFromHighlight(E);if(m.file){let AA=this.getCommentsForHighlight(m.file,H,!0);H.comments=AA}let{highlightEndPos:x,isHtmlTag:M,originalText:T,originalLength:R}=this.calculateHighlightPosition(u,E),N=this.isAtParagraphEnd(u,x),J=this.createCommentWidget(H,[H]);if(d.push(J.range(x)),M){let AA=/<[^>]+>/.exec(T),FA=/<\/[^>]+>/.exec(T);if(AA&&FA){let wA=E.position+AA[0].length,PA=E.position+R-FA[0].length,aA=m.file?this.getCommentsForHighlight(m.file,H,!1):[],iA=aA.length>0?(F=aA[0])==null?void 0:F.content:"",MA=je.Decoration.mark({class:"cm-highlight",attributes:{title:iA||"","data-highlight-type":"html",style:E.backgroundColor?`background-color: ${E.backgroundColor}`:""}});d.push(MA.range(wA,PA))}}else{let FA=E.position+E.text.length+4,wA=m.file?this.getCommentsForHighlight(m.file,H,!1):[],PA=wA.length>0?(y=wA[0])==null?void 0:y.content:""}}return je.Decoration.set(d.sort((E,H)=>E.from-H.from))}createCommentWidget(c,d){return je.Decoration.widget({widget:new Hs(this.plugin,c,d,()=>this.openCommentPanel(c)),side:2,stopEvent:g=>!0})}openCommentPanel(c){let d=this.plugin.app.workspace,g=d.getLeavesOfType("comment-view");if(g.length)d.revealLeaf(g[0]);else{let u=d.getRightLeaf(!1);u&&u.setViewState({type:"comment-view",active:!0})}}isAtParagraphEnd(c,d){if(d>=c.length)return!0;let g=c.charAt(d),u=c.substr(d,2),m=g===`
`||g==="\r"||u===`\r
`,v=m;if(m){let F=d+(u===`\r
`?2:1);if(F>=c.length)v=!0;else{let y=c.charAt(F),E=c.substr(F,2);v=y===`
`||y==="\r"||E===`\r
`}}return v}},{decorations:c=>c.decorations});this.highlightPlugin=l,this.plugin.registerEditorExtension([l])}disable(){if(this.highlightPlugin){let e=this.getActiveMarkdownView();e!=null&&e.editor&&e.editor.refresh()}document.querySelectorAll(".hi-note-widget").forEach(e=>e.remove())}updateTooltipContent(e,A){let t=e.querySelector(".hi-note-tooltip-list");t&&(t.empty(),A.slice(0,3).forEach(r=>{let o=t.createEl("div",{cls:"hi-note-tooltip-item"});o.createEl("div",{cls:"hi-note-tooltip-content",text:r.content}),o.createEl("div",{cls:"hi-note-tooltip-time",text:new Date(r.createdAt).toLocaleString()})}))}};var Ho=require("obsidian");var le=require("obsidian");var At=require("obsidian");var xs=class{constructor(e,A){this.containerEl=e,this.plugin=A,this.rules=A.settings.regexRules||[],this.rulesContainer=e.createDiv({cls:"regex-rules-container"}),this.display()}display(){this.rulesContainer.empty();let e=this.rulesContainer.createDiv({cls:"regex-rule-warning"});e.innerHTML=f("Use regex with caution. If there are capture groups (), the first capture group will be used as the highlight text; if there are no capture groups, the entire match will be used."),this.rules.length===0?this.rulesContainer.createDiv().setText(f('No custom regex rules. Click "+" to add a new rule.')):this.rules.forEach((r,o)=>{this.createRuleItem(r,o)});let A=this.rulesContainer.createDiv({cls:"regex-rule-add"});A.createSpan({cls:"regex-rule-add-text"}).setText(f("Add new rule")),A.addEventListener("click",()=>{let r={id:`rule-${Date.now()}`,name:"",pattern:"",color:"#ffeb3b",enabled:!0};this.rules.push(r),this.saveRules(),this.display()})}createRuleItem(e,A){let t=this.rulesContainer.createDiv({cls:"regex-rule-item"}),r=new At.TextComponent(t);r.setPlaceholder(f("Rule name")),r.setValue(e.name),r.onChange(u=>{e.name=u,this.saveRules()});let o=new At.TextComponent(t);o.setPlaceholder(f("Regular expression with capture groups")),o.setValue(e.pattern),o.onChange(u=>{e.pattern=u,this.saveRules()});let l=t.createDiv(),c=new At.TextComponent(l);c.setPlaceholder("#ffeb3b"),c.setValue(e.color),c.inputEl.addClass("color-input"),c.onChange(u=>{let m=u.trim();m&&(m.startsWith("#")||m.startsWith("rgb")||m.startsWith("rgba"))&&(e.color=m,this.saveRules())});let d=t.createDiv({cls:"regex-rule-delete"});(0,At.setIcon)(d,"trash-2"),d.setAttr("aria-label",f("Delete rule")),d.addEventListener("click",()=>{this.rules.splice(A,1),this.saveRules(),this.display()});let g=new At.ToggleComponent(t);g.setValue(e.enabled),g.onChange(u=>{e.enabled=u,this.saveRules()}),g.toggleEl.addClass("regex-rule-toggle")}async saveRules(){this.plugin.settings.regexRules=this.rules,await this.plugin.saveSettings()}};var Ms=class{constructor(e,A){this.plugin=e,this.containerEl=A}async updateOrphanedDataCount(e){try{let A=e.querySelector(".orphaned-data-count, .no-orphaned-data");A&&A.remove();let t=await this.plugin.commentStore.checkOrphanedDataCount(),r=document.createElement("div");t.orphanedHighlights>0?(r.className="orphaned-data-count",r.textContent=`Found ${t.orphanedHighlights} orphaned highlights in ${t.affectedFiles} files.`):(r.className="no-orphaned-data",r.textContent="No orphaned data found."),e.appendChild(r)}catch(A){console.error("[HiNote] Error updating orphaned data count:",A)}}display(){let e=this.containerEl.createEl("div",{cls:"general-settings-container"});new le.Setting(e).setName(f("Export Path")).setDesc(f("Set the path for exported highlight notes. Leave empty to use vault root. The path should be relative to your vault root.")).addText(d=>d.setPlaceholder("Example: folder 1/folder 2").setValue(this.plugin.settings.export.exportPath||"").onChange(async g=>{g=g.replace(/^\/+/,""),g=g.replace(/\/+$/,""),this.plugin.settings.export.exportPath=g,await this.plugin.saveSettings()})),new le.Setting(e).setName(f("Export template")).setDesc(f("Customize the format of exported highlights and comments using variables. Available variables: {{highlightText}}, {{highlightBlockRef}}, {{commentContent}}, {{commentDate}}. Leave empty to use default template.")).addTextArea(d=>{d.setPlaceholder(`> [!quote] HiNote
> {{highlightText}}
> 
>> [!note] Comment
>> {{commentContent}}
>> *{{commentDate}}*`).setValue(this.plugin.settings.export.exportTemplate||"").onChange(async u=>{this.plugin.settings.export.exportTemplate=u,await this.plugin.saveSettings()}),d.inputEl.rows=6,d.inputEl.cols=40}),new le.Setting(e).setName(f("Exclusions")).setDesc(f("Comma separated list of paths, tags, note titles or file extensions that will be excluded from highlighting. e.g. folder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md")).addTextArea(d=>{d.setPlaceholder("folder1, folder1/folder2, [[note1]], [[note2]], *.excalidraw.md").setValue(this.plugin.settings.excludePatterns||"").onChange(async g=>{let u=g.split(",").map(m=>m.trim()).filter(m=>m.length>0);this.plugin.settings.excludePatterns=g,await this.plugin.saveSettings()}),d.inputEl.rows=4,d.inputEl.cols=40}),new le.Setting(e).setName(f("Custom text extraction")).setHeading(),new le.Setting(e).setName(f("Use custom rules")).setDesc(f("Enable to use custom regex rules to extract highlight text.")).addToggle(d=>d.setValue(this.plugin.settings.useCustomPattern).onChange(async g=>{this.plugin.settings.useCustomPattern=g,await this.plugin.saveSettings()}));let A=e.createDiv({cls:"regex-editor-container"});new xs(A,this.plugin),new le.Setting(e).setName(f("Data management")).setHeading();let t=new le.Setting(e).setName(f("Clean orphaned data")).setDesc(f("Remove highlights and comments that no longer exist in your documents. This is useful if you have deleted highlights but their comments are still stored in the data file.")),r=0,o=0,l=!1,c=t.addButton(d=>{d.setButtonText(f("Check")),d.onClick(async()=>{d.setButtonText(f("Checking...")),d.setDisabled(!0);try{let g=await this.plugin.commentStore.checkOrphanedDataCount();r=g.orphanedHighlights,o=g.affectedFiles,l=!0;let u=t.descEl,m=u.querySelector(".orphaned-data-count, .no-orphaned-data");m&&m.remove();let v=document.createElement("div");r>0?(v.className="orphaned-data-count",v.textContent=`Found ${r} orphaned highlights in ${o} files.`,d.setButtonText(f("Clean data")),d.setDisabled(!1),d.onClick(async()=>{d.setButtonText(f("Cleaning...")),d.setDisabled(!0);try{let F=await this.plugin.commentStore.cleanOrphanedData();F.removedHighlights>0?new le.Notice(`Cleaned ${F.removedHighlights} orphaned highlights from ${F.affectedFiles} files.`):new le.Notice("No orphaned data found."),d.setButtonText(f("Check")),l=!1,v&&v.parentElement&&v.parentElement.removeChild(v)}catch(F){console.error("[HiNote] Error cleaning orphaned data:",F),new le.Notice("Error cleaning orphaned data. Check console for details."),d.setButtonText(f("Check"))}finally{d.setDisabled(!1)}})):(v.className="no-orphaned-data",v.textContent="No orphaned data found.",d.setButtonText(f("Check")),d.setDisabled(!1)),u.appendChild(v)}catch(g){console.error("[HiNote] Error checking orphaned data:",g),new le.Notice("Error checking orphaned data. Check console for details."),d.setButtonText(f("Check")),d.setDisabled(!1)}})})}};var Io=require("obsidian");var NA=require("obsidian");var So=require("obsidian");var se=class{constructor(e,A){this.plugin=e,this.containerEl=A}createModelDropdown(e,A,t){new So.Setting(e).setName(f("Model")).setDesc(f("Select the AI model to use")).addDropdown(r=>{let o=Object.fromEntries(A.map(l=>[l.id,l.name]));return r.addOptions(o).setValue(this.plugin.settings.ai.model||t.id).onChange(async l=>{this.plugin.settings.ai.model=l,await this.plugin.saveSettings()})})}};var gi=[{id:"gpt-4",name:"GPT-4"},{id:"gpt-4-turbo",name:"GPT-4 Turbo"},{id:"gpt-3.5-turbo",name:"GPT-3.5 Turbo"}],Ls=class extends se{constructor(A,t){super(A,t);this.modelSelectEl=null;this.customModelContainer=null;this.modelState=this.initializeModelState()}initializeModelState(){this.plugin.settings.ai.openai||(this.plugin.settings.ai.openai={apiKey:"",model:gi[0].id,apiAddress:"",isCustomModel:!1,lastCustomModel:""});let A=this.plugin.settings.ai.openai,t;if(A.isCustomModel)t={id:A.model,name:A.model,isCustom:!0};else{let r=gi.find(o=>o.id===A.model);t=r||gi[0],r||(A.model=t.id)}return{selectedModel:t,apiKey:A.apiKey||""}}async saveModelState(){this.plugin.settings.ai.openai||(this.plugin.settings.ai.openai={});let A=this.plugin.settings.ai.openai,t=this.modelState.selectedModel;A.model=t.id,A.isCustomModel=!!t.isCustom,A.apiKey=this.modelState.apiKey||"",t.isCustom&&t.id&&(A.lastCustomModel=t.id),await this.plugin.saveSettings()}display(A){let t=A.createEl("div",{cls:"ai-service-settings"});new NA.Setting(t).setName(f("OpenAI service")).setHeading(),new NA.Setting(t).setName(f("API Key")).setDesc(f("Please enter your API Key.")).addText(g=>g.setPlaceholder("sk-...").setValue(this.modelState.apiKey).onChange(async u=>{this.modelState.apiKey=u,await this.saveModelState()})).addButton(g=>g.setButtonText(f("Check")).onClick(async()=>{if(!this.modelState.apiKey){new NA.Notice(f("Please enter an API Key first"));return}g.setDisabled(!0),g.setButtonText(f("Checking..."));try{(await this.fetchAvailableModels(this.modelState.apiKey)).length>0?new NA.Notice(f("API Key is valid!")):new NA.Notice(f("No models available. Please check your API Key."))}catch(u){new NA.Notice(f("Failed to validate API Key. Please check your key and try again."))}finally{g.setDisabled(!1),g.setButtonText(f("Check"))}}));let r=new NA.Setting(t).setName(f("Model")).setDesc(f("Select a model or enter a custom one.")).addDropdown(g=>{gi.forEach(m=>{g.addOption(m.id,m.name)}),g.addOption("custom",f("Custom Model"));let u=this.modelState.selectedModel.isCustom?"custom":this.modelState.selectedModel.id;return g.setValue(u),this.modelSelectEl=g.selectEl,g.onChange(async m=>{if(m==="custom")await this.showCustomModelInput();else{let v=gi.find(F=>F.id===m);if(v){if(this.modelState.selectedModel.isCustom){let F=this.plugin.settings.ai.openai;F.lastCustomModel=this.modelState.selectedModel.id,await this.plugin.saveSettings()}this.modelState.selectedModel=v,await this.saveModelState(),await this.hideCustomModelInput()}}}),g});this.customModelContainer=r.settingEl.createDiv("custom-model-container"),this.customModelContainer.addClass("custom-model-container");let o=r.settingEl.querySelector(".setting-item-control");o&&(o.addClass("openai-dropdown-container"),o.insertBefore(this.customModelContainer,o.firstChild));let c=new NA.Setting(this.customModelContainer).addText(g=>g.setPlaceholder("model-id").setValue(this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:"").onChange(async u=>{let m=u.trim();if(m){if(!/^[a-zA-Z0-9-_.]+$/.test(m)){new NA.Notice(f("Model ID can only contain letters, numbers, underscores, dots and hyphens.")),g.setValue(this.modelState.selectedModel.id);return}this.modelState.selectedModel={id:m,name:m,isCustom:!0},await this.saveModelState()}})).settingEl;c.addClass("openai-setting-no-border");let d=c.querySelector(".setting-item-control");d&&d.addClass("openai-setting-no-margin"),this.modelState.selectedModel.isCustom&&this.showCustomModelInput(),new NA.Setting(t).setName(f("Provider URL")).setDesc(f("Leave it blank, unless you are using a proxy.")).addText(g=>{var u;return g.setPlaceholder("https://api.openai.com/v1").setValue(((u=this.plugin.settings.ai.openai)==null?void 0:u.apiAddress)||"").onChange(async m=>{this.plugin.settings.ai.openai||(this.plugin.settings.ai.openai={}),this.plugin.settings.ai.openai.apiAddress=m,await this.plugin.saveSettings()})})}async validateModel(A,t,r){try{let o=await(0,NA.requestUrl)({url:`${r}/models/${t}`,method:"GET",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}});if(o.status!==200){let c=await o.json.catch(()=>null);return new NA.Notice(f("Custom model unavailable. Please check the model ID and your access permissions.")),!1}let l=await(0,NA.requestUrl)({url:`${r}/chat/completions`,method:"POST",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"},body:JSON.stringify({model:t,messages:[{role:"user",content:"Hello"}],max_tokens:1})});if(l.status!==200){let c=await l.json.catch(()=>null);return!1}return!0}catch(o){return!1}}async fetchAvailableModels(A){var t;try{let r=((t=this.plugin.settings.ai.openai)==null?void 0:t.apiAddress)||"https://api.openai.com/v1";if(this.modelState.selectedModel.isCustom){let l=this.modelState.selectedModel.id;if(!await this.validateModel(A,l,r))throw new Error(`Custom model not available: ${l}`);return[this.modelState.selectedModel]}let o=await(0,NA.requestUrl)({url:`${r}/models`,method:"GET",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}});return o.status===200?o.json.data.map(d=>({id:d.id,name:d.id})):[]}catch(r){throw r}}async showCustomModelInput(){if(this.customModelContainer&&this.modelSelectEl){this.customModelContainer.addClass("visible"),this.modelSelectEl.value="custom";let A=this.plugin.settings.ai.openai;if(!this.modelState.selectedModel.isCustom){let r=A.lastCustomModel||"";this.modelState.selectedModel={id:r,name:r,isCustom:!0},A.model=r,A.isCustomModel=!0,await this.plugin.saveSettings();let o=this.customModelContainer.querySelector("input");o&&(o.value=r)}}}async hideCustomModelInput(){this.customModelContainer&&this.customModelContainer.removeClass("visible")}};var pe=require("obsidian");var ui=[{id:"claude-3-opus-20240229",name:"Claude 3 Opus"},{id:"claude-3-sonnet-20240229",name:"Claude 3 Sonnet"},{id:"claude-3-haiku-20240307",name:"Claude 3 Haiku"},{id:"claude-2",name:"Claude 2"},{id:"claude-instant-1",name:"Claude Instant"}],Ts=class extends se{constructor(A,t){super(A,t);this.modelSelectEl=null;this.customModelContainer=null;this.modelState=this.initializeModelState()}initializeModelState(){this.plugin.settings.ai.anthropic||(this.plugin.settings.ai.anthropic={apiKey:"",model:ui[0].id,apiAddress:"",isCustomModel:!1,lastCustomModel:""});let A=this.plugin.settings.ai.anthropic,t;if(A.isCustomModel)t={id:A.model,name:A.model,isCustom:!0};else{let r=ui.find(o=>o.id===A.model);t=r||ui[0],r||(A.model=t.id)}return{selectedModel:t,apiKey:A.apiKey||""}}async saveModelState(){this.plugin.settings.ai.anthropic||(this.plugin.settings.ai.anthropic={});let A=this.plugin.settings.ai.anthropic,t=this.modelState.selectedModel;A.model=t.id,A.isCustomModel=!!t.isCustom,A.apiKey=this.modelState.apiKey||"",t.isCustom&&t.id&&(A.lastCustomModel=t.id),await this.plugin.saveSettings()}display(A){let t=A.createEl("div",{cls:"ai-service-settings"});new pe.Setting(t).setName(f("Anthropic service")).setHeading(),new pe.Setting(t).setName(f("API Key")).setDesc(f("Please enter your API Key.")).addText(g=>g.setPlaceholder("sk-ant-...").setValue(this.modelState.apiKey).onChange(async u=>{this.modelState.apiKey=u,await this.saveModelState()})).addButton(g=>g.setButtonText(f("Check")).onClick(async()=>{var u;try{let m=this.modelState.apiKey;if(!m){new pe.Notice(f("Please enter an API Key first"));return}g.setDisabled(!0),g.setButtonText(f("Checking..."));let v=((u=this.plugin.settings.ai.anthropic)==null?void 0:u.apiAddress)||"https://api.anthropic.com",F=this.modelState.selectedModel.id;await new St(m,v,F).testConnection()?new pe.Notice(f("API Key is valid!")):new pe.Notice(f("Failed to validate API Key. Please check your key and try again."))}catch(m){console.error("Anthropic API validation error:",m),new pe.Notice(f("Failed to validate API Key. Please check your key and try again."))}finally{g.setDisabled(!1),g.setButtonText(f("Check"))}}));let r=new pe.Setting(t).setName(f("Model")).setDesc(f("Select a model or enter a custom one.")).addDropdown(g=>{ui.forEach(m=>{g.addOption(m.id,m.name)}),g.addOption("custom",f("Custom Model"));let u=this.modelState.selectedModel.isCustom?"custom":this.modelState.selectedModel.id;return g.setValue(u),this.modelSelectEl=g.selectEl,g.onChange(async m=>{if(m==="custom")await this.showCustomModelInput();else{let v=ui.find(F=>F.id===m);if(v){if(this.modelState.selectedModel.isCustom){let F=this.plugin.settings.ai.anthropic;F.lastCustomModel=this.modelState.selectedModel.id,await this.plugin.saveSettings()}this.modelState.selectedModel=v,await this.saveModelState(),await this.hideCustomModelInput()}}}),g});this.customModelContainer=r.settingEl.createDiv("custom-model-container"),this.customModelContainer.addClass("custom-model-container");let o=r.settingEl.querySelector(".setting-item-control");o&&(o.addClass("openai-dropdown-container"),o.insertBefore(this.customModelContainer,o.firstChild));let c=new pe.Setting(this.customModelContainer).addText(g=>g.setPlaceholder("model-id").setValue(this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:"").onChange(async u=>{let m=u.trim();if(m){if(!/^[a-zA-Z0-9-_.]+$/.test(m)){new pe.Notice(f("Model ID can only contain letters, numbers, underscores, dots and hyphens.")),g.setValue(this.modelState.selectedModel.id);return}this.modelState.selectedModel={id:m,name:m,isCustom:!0},await this.saveModelState()}})).settingEl;c.addClass("openai-setting-no-border");let d=c.querySelector(".setting-item-control");d&&d.addClass("openai-setting-no-margin"),this.modelState.selectedModel.isCustom&&this.showCustomModelInput(),new pe.Setting(t).setName(f("Provider URL")).setDesc(f("Leave it blank, unless you are using a proxy.")).addText(g=>{var u;return g.setPlaceholder("https://api.anthropic.com").setValue(((u=this.plugin.settings.ai.anthropic)==null?void 0:u.apiAddress)||"").onChange(async m=>{this.plugin.settings.ai.anthropic||(this.plugin.settings.ai.anthropic={}),this.plugin.settings.ai.anthropic.apiAddress=m,await this.plugin.saveSettings()})})}async showCustomModelInput(){if(this.customModelContainer&&this.modelSelectEl){this.customModelContainer.addClass("visible"),this.modelSelectEl.value="custom";let A=this.plugin.settings.ai.anthropic;if(!this.modelState.selectedModel.isCustom){let r=A.lastCustomModel||"";this.modelState.selectedModel={id:r,name:r,isCustom:!0},A.model=r,A.isCustomModel=!0,await this.plugin.saveSettings();let o=this.customModelContainer.querySelector("input");o&&(o.value=r)}}}async hideCustomModelInput(){this.customModelContainer&&this.customModelContainer.removeClass("visible")}};var JA=require("obsidian");var Ds=class extends se{constructor(A,t){super(A,t);this.modelSelectEl=null;this.customModelContainer=null;this.modelState=this.initializeModelState()}initializeModelState(){this.plugin.settings.ai.deepseek||(this.plugin.settings.ai.deepseek={apiKey:"",model:yt[0].id,apiAddress:"",isCustomModel:!1,lastCustomModel:""});let A=this.plugin.settings.ai.deepseek,t;if(A.isCustomModel)t={id:A.model,name:A.model,isCustom:!0};else{let r=yt.find(o=>o.id===A.model);t=r||yt[0],r||(A.model=t.id)}return{selectedModel:t,apiKey:A.apiKey||""}}async saveModelState(){this.plugin.settings.ai.deepseek||(this.plugin.settings.ai.deepseek={});let A=this.plugin.settings.ai.deepseek,t=this.modelState.selectedModel;A.model=t.id,A.isCustomModel=!!t.isCustom,A.apiKey=this.modelState.apiKey||"",A.apiAddress=A.apiAddress||"",t.isCustom&&t.id&&(A.lastCustomModel=t.id),await this.plugin.saveSettings()}async validateApiKey(A){var t;try{let r="https://api.deepseek.com",o=(t=this.plugin.settings.ai.deepseek)==null?void 0:t.apiAddress,l=o&&o.trim()?o:r,c=this.modelState.selectedModel.id,d=`${l}/models/${c}`,g=await(0,JA.requestUrl)({url:d,headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}});if(!g.status||g.status<200||g.status>=300){if(this.modelState.selectedModel.isCustom)return new JA.Notice(f("\u81EA\u5B9A\u4E49\u6A21\u578B\u4E0D\u53EF\u7528\uFF0C\u8BF7\u68C0\u67E5\u6A21\u578B ID \u548C API \u5730\u5740")),!1;if(c!=="deepseek-chat"){let v=`${l}/models/deepseek-chat`,F=await(0,JA.requestUrl)({url:v,headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"}});if(F.status&&F.status>=200&&F.status<300)return new JA.Notice(f("\u5F53\u524D\u9009\u62E9\u7684\u6A21\u578B\u4E0D\u53EF\u7528\uFF0C\u4F46 API Key \u662F\u6709\u6548\u7684")),!1}return new JA.Notice(f("Failed to validate API Key. Please check your key and try again.")),!1}let u=g.json,m=!!(u&&u.id);return m&&new JA.Notice(f("API Key and model available.")),m}catch(r){return new JA.Notice(f("Failed to validate API Key. Please check your key and try again.")),!1}}display(A){let t=A.createEl("div",{cls:"ai-service-settings"});new JA.Setting(t).setName(f("Deepseek service")).setHeading(),new JA.Setting(t).setName(f("API Key")).setDesc(f("Please enter your API Key.")).addText(l=>l.setPlaceholder("dsk-...").setValue(this.modelState.apiKey).onChange(async c=>{this.modelState.apiKey=c,await this.saveModelState()})).addButton(l=>l.setButtonText(f("Check")).onClick(async()=>{if(!this.modelState.apiKey){new JA.Notice(f("Please enter an API Key first"));return}l.setDisabled(!0),l.setButtonText(f("Checking..."));try{await this.validateApiKey(this.modelState.apiKey)}finally{l.setDisabled(!1),l.setButtonText(f("Check"))}}));let r=new JA.Setting(t).setName(f("Model")).setDesc(f("Select a model or enter a custom one.")).addDropdown(l=>{yt.forEach(d=>{l.addOption(d.id,d.name)}),l.addOption("custom",f("Custom Model"));let c=this.modelState.selectedModel.isCustom?"custom":this.modelState.selectedModel.id;return l.setValue(c),this.modelSelectEl=l.selectEl,l.onChange(async d=>{if(d==="custom")await this.showCustomModelInput();else{let g=yt.find(u=>u.id===d);if(g){if(this.modelState.selectedModel.isCustom){let u=this.plugin.settings.ai.deepseek;u.lastCustomModel=this.modelState.selectedModel.id,await this.plugin.saveSettings()}this.modelState.selectedModel=g,await this.saveModelState(),await this.hideCustomModelInput()}}}),l});this.customModelContainer=r.settingEl.createDiv("custom-model-container"),this.customModelContainer.addClass("custom-model-container");let o=r.settingEl.querySelector(".setting-item-control");o&&(o.addClass("openai-dropdown-container"),o.insertBefore(this.customModelContainer,o.firstChild)),this.modelState.selectedModel.isCustom&&this.showCustomModelInput(),new JA.Setting(t).setName(f("Provider URL")).setDesc(f("Leave it blank, unless you are using a proxy.")).addText(l=>{var c;return l.setPlaceholder("https://api.deepseek.com/v1").setValue(((c=this.plugin.settings.ai.deepseek)==null?void 0:c.apiAddress)||"").onChange(async d=>{this.plugin.settings.ai.deepseek||(this.plugin.settings.ai.deepseek={}),this.plugin.settings.ai.deepseek.apiAddress=d,await this.plugin.saveSettings()})})}async showCustomModelInput(){if(!this.customModelContainer)return;this.customModelContainer.addClass("visible"),this.customModelContainer.empty();let A=document.createElement("input");A.type="text",A.className="custom-model-input",A.placeholder="model-id",A.value=this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:"",A.addEventListener("input",async()=>{let t=A.value.trim();if(t){if(!/^[a-zA-Z0-9-_.]+$/.test(t)){new JA.Notice(f("Model ID can only contain letters, numbers, underscores, dots and hyphens.")),A.value=this.modelState.selectedModel.id;return}this.modelState.selectedModel={id:t,name:t,isCustom:!0},await this.saveModelState()}}),this.customModelContainer.appendChild(A)}hideCustomModelInput(){this.customModelContainer&&(this.customModelContainer.removeClass("visible"),this.customModelContainer.empty())}};var xA=require("obsidian");var Ps=class extends se{constructor(A,t){super(A,t);this.modelSelectEl=null;this.customModelContainer=null;this.modelState=this.initializeModelState()}initializeModelState(){this.plugin.settings.ai.gemini||(this.plugin.settings.ai.gemini={apiKey:"",model:$e[0].id,baseUrl:"",isCustomModel:!1,lastCustomModel:""});let A=this.plugin.settings.ai.gemini,t;if(A.isCustomModel)t={id:A.model,name:A.model,isCustom:!0};else{let r=$e.find(o=>o.id===A.model);t=r||$e[0],r||(A.model=t.id)}return{selectedModel:t,apiKey:A.apiKey||""}}async saveModelState(){this.plugin.settings.ai.gemini||(this.plugin.settings.ai.gemini={});let A=this.plugin.settings.ai.gemini,t=this.modelState.selectedModel;A.model=t.id,A.isCustomModel=!!t.isCustom,A.apiKey=this.modelState.apiKey||"",A.baseUrl=A.baseUrl||"",t.isCustom&&t.id&&(A.lastCustomModel=t.id),await this.plugin.saveSettings()}async validateApiKey(A){var t;try{let r="https://generativelanguage.googleapis.com",o=(t=this.plugin.settings.ai.gemini)==null?void 0:t.baseUrl,l=o&&o.trim()?o:r,c=this.modelState.selectedModel.id,d=`${l}/v1/models/${c}?key=${A}`,g=await(0,xA.requestUrl)({url:d});if(!g.status||g.status<200||g.status>=300){let v=g.json||null;if(c.includes("-exp-")){let y=`${l}/v1/models/gemini-pro?key=${A}`,E=await(0,xA.requestUrl)({url:y});throw E.status&&E.status>=200&&E.status<300?(new xA.Notice(f("API Key \u6709\u6548\uFF0C\u4F46\u65E0\u6CD5\u8BBF\u95EE\u5B9E\u9A8C\u6027\u6A21\u578B\u3002\u8BF7\u786E\u4FDD\u4F60\u6709\u6743\u9650\u8BBF\u95EE\u6B64\u6A21\u578B\uFF0C\u6216\u7B49\u5F85\u6A21\u578B\u6B63\u5F0F\u53D1\u5E03\u3002")),new Error(`Experimental model not accessible: ${c}`)):(new xA.Notice(f("Invalid API Key or server error. Please verify your API Key.")),new Error("Invalid API Key"))}if(this.modelState.selectedModel.isCustom)throw new xA.Notice(f("Custom model unavailable. Please check the model ID and your access permissions.")),new Error(`Custom model not available: ${c}`);if(c!=="gemini-pro"){let y=`${l}/v1/models/gemini-pro?key=${A}`,E=await(0,xA.requestUrl)({url:y});if(E.status&&E.status>=200&&E.status<300)throw new xA.Notice(f("API Key \u6709\u6548\uFF0C\u4F46\u5F53\u524D\u9009\u62E9\u7684\u6A21\u578B\u4E0D\u53EF\u7528\u3002\u53EF\u80FD\u662F\u6A21\u578B\u672A\u53D1\u5E03\u6216\u4F60\u6CA1\u6709\u8BBF\u95EE\u6743\u9650\u3002")),new Error(`Selected model not available: ${c}`)}throw new xA.Notice(f("Invalid API Key or server error. Please verify your API Key.")),new Error(`HTTP error! status: ${g.status}`)}let u=await g.json(),m=!!(u&&u.name);return m&&new xA.Notice(f("API Key and the current model are both available\uFF01")),m}catch(r){return!1}}display(A){let t=A.createEl("div",{cls:"ai-service-settings"});new xA.Setting(t).setName(f("Gemini service")).setHeading(),new xA.Setting(t).setName(f("API Key")).setDesc(f("Please enter your API Key.")).addText(g=>g.setPlaceholder("Enter your API key").setValue(this.modelState.apiKey).onChange(async u=>{this.modelState.apiKey=u,await this.saveModelState()})).addButton(g=>g.setButtonText(f("Check")).onClick(async()=>{if(!this.modelState.apiKey){new xA.Notice(f("Please enter an API Key first"));return}g.setDisabled(!0),g.setButtonText(f("Checking..."));try{await this.validateApiKey(this.modelState.apiKey)}finally{g.setDisabled(!1),g.setButtonText(f("Check"))}}));let r=new xA.Setting(t).setName(f("Model")).setDesc(f("Select a model or enter a custom one.")).addDropdown(g=>{$e.forEach(m=>{g.addOption(m.id,m.name)}),g.addOption("custom",f("Custom Model"));let u=this.modelState.selectedModel.isCustom?"custom":this.modelState.selectedModel.id;return g.setValue(u),this.modelSelectEl=g.selectEl,g.onChange(async m=>{if(m==="custom")await this.showCustomModelInput();else{let v=$e.find(F=>F.id===m);if(v){if(this.modelState.selectedModel.isCustom){let F=this.plugin.settings.ai.gemini;F.lastCustomModel=this.modelState.selectedModel.id,await this.plugin.saveSettings()}this.modelState.selectedModel=v,await this.saveModelState(),await this.hideCustomModelInput()}}}),g});this.customModelContainer=r.settingEl.createDiv("custom-model-container"),this.customModelContainer.addClass("custom-model-container");let o=r.settingEl.querySelector(".setting-item-control");o&&(o.addClass("openai-dropdown-container"),o.insertBefore(this.customModelContainer,o.firstChild));let c=new xA.Setting(this.customModelContainer).addText(g=>g.setPlaceholder("model-id").setValue(this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:"").onChange(async u=>{let m=u.trim();if(m){if(!/^[a-zA-Z0-9-_.]+$/.test(m)){new xA.Notice(f("Model ID can only contain letters, numbers, underscores, dots and hyphens.")),g.setValue(this.modelState.selectedModel.id);return}this.modelState.selectedModel={id:m,name:m,isCustom:!0},await this.saveModelState()}})).settingEl;c.addClass("openai-setting-no-border");let d=c.querySelector(".setting-item-control");d&&d.addClass("openai-setting-no-margin"),this.modelState.selectedModel.isCustom&&this.showCustomModelInput(),new xA.Setting(t).setName(f("Provider URL")).setDesc(f("Leave it blank, unless you are using a proxy.")).addText(g=>{var v;let u="https://generativelanguage.googleapis.com",m=(v=this.plugin.settings.ai.gemini)==null?void 0:v.baseUrl;return g.setPlaceholder(u).setValue(m||"").onChange(async F=>{this.plugin.settings.ai.gemini||(this.plugin.settings.ai.gemini={}),this.plugin.settings.ai.gemini.baseUrl=F||"",await this.plugin.saveSettings()}),g})}async showCustomModelInput(){if(this.customModelContainer&&this.modelSelectEl){this.customModelContainer.addClass("visible"),this.modelSelectEl.value="custom";let A=this.plugin.settings.ai.gemini;if(!this.modelState.selectedModel.isCustom){let r=A.lastCustomModel||"";this.modelState.selectedModel={id:r,name:r,isCustom:!0},A.model=r,A.isCustomModel=!0,await this.plugin.saveSettings();let o=this.customModelContainer.querySelector("input");o&&(o.value=r)}}}async hideCustomModelInput(){if(this.customModelContainer){this.customModelContainer.removeClass("visible");let A=this.plugin.settings.ai.gemini,t=this.modelState.selectedModel;if(t.isCustom&&t.id){A.lastCustomModel=t.id;let r=this.customModelContainer.querySelector("input");r&&(r.value=t.id)}A.isCustomModel=!1,await this.plugin.saveSettings()}}};var et=require("obsidian");var Ks=class extends se{async display(e){var l,c,d;let A=e.createEl("div",{cls:"ai-service-settings"});new et.Setting(A).setName(f("Ollama service")).setHeading();let t="http://localhost:11434";(l=this.plugin.settings.ai.ollama)!=null&&l.host||(this.plugin.settings.ai.ollama||(this.plugin.settings.ai.ollama={}),this.plugin.settings.ai.ollama.host=t,await this.plugin.saveSettings());let r=new et.Setting(A).setName(f("Server URL")).setDesc(f("Ollama server URL (default: http://localhost:11434)")).addText(g=>{var u;return g.setPlaceholder(t).setValue(((u=this.plugin.settings.ai.ollama)==null?void 0:u.host)||t).onChange(async m=>{this.plugin.settings.ai.ollama||(this.plugin.settings.ai.ollama={}),this.plugin.settings.ai.ollama.host=m||t,await this.plugin.saveSettings()}),g}),o;r.addButton(g=>(o=g.buttonEl,g.setButtonText(f("Check")).onClick(async()=>{var F;let u=((F=this.plugin.settings.ai.ollama)==null?void 0:F.host)||t;o.disabled=!0;let m=o.textContent;o.textContent=f("Checking...");let v=new Ut(u);try{let y=await v.listModels();o.disabled=!1,o.textContent=m,y&&y.length>0?(this.plugin.settings.ai.ollama.availableModels=y,await this.plugin.saveSettings(),this.displayOllamaModelDropdown(A,y),new et.Notice(f("Successfully connected to Ollama service"))):new et.Notice(f("No models found. Please download models using ollama"))}catch(y){o.disabled=!1,o.textContent=m,new et.Notice(f("Failed to connect to Ollama service. Please check the server address."))}}))),(d=(c=this.plugin.settings.ai.ollama)==null?void 0:c.availableModels)!=null&&d.length&&this.displayOllamaModelDropdown(A,this.plugin.settings.ai.ollama.availableModels)}displayOllamaModelDropdown(e,A){let t=e.querySelector(".model-setting");t&&t.remove(),new et.Setting(e).setName(f("Model")).setDesc(f("Select a Ollama model.")).addDropdown(o=>{var g;let l=Object.fromEntries(A.map(u=>[u,u])),c=(g=this.plugin.settings.ai.ollama)==null?void 0:g.model,d=A.includes(c)?c:A[0];return o.addOptions(l).setValue(d).onChange(async u=>{this.plugin.settings.ai.ollama||(this.plugin.settings.ai.ollama={}),this.plugin.settings.ai.ollama.model=u,await this.plugin.saveSettings()})}).settingEl.addClass("model-setting")}};var fe=require("obsidian");var Rs=class extends se{constructor(A,t){super(A,t);this.modelSelectEl=null;this.customModelContainer=null;this.modelState=this.initializeModelState()}initializeModelState(){this.plugin.settings.ai.siliconflow||(this.plugin.settings.ai.siliconflow={apiKey:"",model:Ue[0].id,baseUrl:"",isCustomModel:!1,lastCustomModel:""});let A=this.plugin.settings.ai.siliconflow,t;if(A.isCustomModel)t={id:A.model,name:A.model,isCustom:!0};else{let r=Ue.find(o=>o.id===A.model);t=r||Ue[0],r||(A.model=t.id)}return{selectedModel:t,apiKey:A.apiKey||""}}async saveModelState(){if(!this.plugin.settings.ai.siliconflow)this.plugin.settings.ai.siliconflow={apiKey:this.modelState.apiKey||"",model:this.modelState.selectedModel.id,baseUrl:"",isCustomModel:!!this.modelState.selectedModel.isCustom,lastCustomModel:this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:void 0};else{let A=this.plugin.settings.ai.siliconflow,t=this.modelState.selectedModel;A.model=t.id,A.isCustomModel=!!t.isCustom,A.apiKey=this.modelState.apiKey||"",t.isCustom&&t.id&&(A.lastCustomModel=t.id)}await this.plugin.saveSettings()}async validateApiKey(A){var t;try{let r="https://api.siliconflow.cn/v1",o=(t=this.plugin.settings.ai.siliconflow)==null?void 0:t.baseUrl,l=o&&o.trim()?o:r,c=this.modelState.selectedModel.id,d=`${l}/chat/completions`,g=await(0,fe.requestUrl)({url:d,method:"POST",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json"},body:JSON.stringify({model:c,messages:[{role:"user",content:"Hello"}],max_tokens:1})});if(!g.status||g.status<200||g.status>=300){let u=g.json||null;return{isValid:!1,message:f("API Key \u65E0\u6548\u6216\u6A21\u578B\u4E0D\u53EF\u7528\u3002\u8BF7\u68C0\u67E5\u4F60\u7684 API Key \u548C\u6A21\u578B ID \u662F\u5426\u6B63\u786E\u3002")}}return{isValid:!0,message:f("API Key and model available.")}}catch(r){return{isValid:!1,message:f("API Key \u65E0\u6548\u6216\u670D\u52A1\u5668\u9519\u8BEF\u3002")}}}async showCustomModelInput(){this.customModelContainer&&this.modelSelectEl&&this.customModelContainer.addClass("visible")}async hideCustomModelInput(){this.customModelContainer&&this.modelSelectEl&&this.customModelContainer.removeClass("visible")}display(A){let t=A.createEl("div",{cls:"ai-service-settings"});new fe.Setting(t).setName(f("SiliconFlow service")).setHeading();let r=new fe.Setting(t).setName(f("API key")).setDesc(f("Please enter your API Key.")).addText(u=>u.setPlaceholder("sk-...").setValue(this.modelState.apiKey).onChange(async m=>{this.modelState.apiKey=m,await this.saveModelState()})).addButton(u=>u.setButtonText(f("Check")).onClick(async()=>{let m=this.modelState.apiKey;if(!m){new fe.Notice(f("Please input API Key"));return}u.setButtonText(f("Checking...")),u.setDisabled(!0);let v=await this.validateApiKey(m);u.setButtonText(f("Check")),u.setDisabled(!1),v.message&&new fe.Notice(v.message)})),o=new fe.Setting(t).setName(f("Model")).setDesc(f("Select a model or enter a custom one.")).addDropdown(u=>{Ue.forEach(v=>{u.addOption(v.id,v.name)}),u.addOption("custom","Custom Model");let m=this.modelState.selectedModel;return u.setValue(m.isCustom?"custom":m.id),this.modelSelectEl=u.selectEl,u.onChange(async v=>{var F;if(v==="custom"){let y=(F=this.plugin.settings.ai.siliconflow)==null?void 0:F.lastCustomModel;this.modelState.selectedModel={id:y||"",name:y||"",isCustom:!0},await this.saveModelState(),await this.showCustomModelInput()}else{let y=Ue.find(E=>E.id===v);y&&(this.modelState.selectedModel.isCustom&&this.plugin.settings.ai.siliconflow&&(this.plugin.settings.ai.siliconflow.lastCustomModel=this.modelState.selectedModel.id,await this.plugin.saveSettings()),this.modelState.selectedModel=y,await this.saveModelState(),await this.hideCustomModelInput())}}),u});this.customModelContainer=o.settingEl.createDiv("custom-model-container"),this.customModelContainer.addClass("custom-model-container");let l=o.settingEl.querySelector(".setting-item-control");l&&(l.addClass("openai-dropdown-container"),l.insertBefore(this.customModelContainer,l.firstChild));let d=new fe.Setting(this.customModelContainer).addText(u=>u.setPlaceholder("model-id").setValue(this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:"").onChange(async m=>{let v=m.trim();if(v){if(!/^[a-zA-Z0-9-_./]+$/.test(v)){new fe.Notice("Model ID can only contain letters, numbers, underscores, dots and hyphens."),u.setValue(this.modelState.selectedModel.id);return}this.modelState.selectedModel={id:v,name:v,isCustom:!0},await this.saveModelState()}})).settingEl;d.addClass("openai-setting-no-border");let g=d.querySelector(".setting-item-control");g&&g.addClass("openai-setting-no-margin"),this.modelState.selectedModel.isCustom&&this.showCustomModelInput(),new fe.Setting(t).setName(f("Provider URL")).setDesc(f("Leave it blank, unless you are using a proxy.")).addText(u=>{var F;let m="https://api.siliconflow.cn/v1",v=(F=this.plugin.settings.ai.siliconflow)==null?void 0:F.baseUrl;return u.setPlaceholder(m).setValue(v||"").onChange(async y=>{this.plugin.settings.ai.siliconflow?this.plugin.settings.ai.siliconflow.baseUrl=y||"":this.plugin.settings.ai.siliconflow={apiKey:this.modelState.apiKey||"",model:this.modelState.selectedModel.id,baseUrl:y||"",isCustomModel:!!this.modelState.selectedModel.isCustom,lastCustomModel:this.modelState.selectedModel.isCustom?this.modelState.selectedModel.id:void 0},await this.plugin.saveSettings()}),u})}};var xt=require("obsidian"),ks=require("obsidian");var Gs=class{constructor(e,A){this.plugin=e,this.containerEl=A}display(){let e=this.containerEl.createEl("div",{cls:"prompt-settings-container"}),A=e.createEl("div",{cls:"prompt-settings-header setting-item-heading"});A.createEl("h4",{text:f("Prompt settings"),cls:"prompt-settings-title"});let t=A.createEl("button",{cls:"prompt-add-btn",attr:{"aria-label":f("Add prompt")}});(0,ks.setIcon)(t,"plus"),t.onclick=()=>{if(e.querySelector(".new-prompt-section"))return;let r=e.querySelector(".prompt-list");r&&this.createNewPromptForm(e,r)},this.displayPromptList(e)}createNewPromptForm(e,A){var g;let t=e.createEl("div",{cls:"new-prompt-section"});(g=A.parentElement)==null||g.insertBefore(t,A);let r=t.createEl("input",{cls:"prompt-name-input",attr:{placeholder:f("Input Prompt Name"),type:"text"}}),o=new xt.TextAreaComponent(t);o.setPlaceholder(f(`Input Prompt Content
Available parameters:
{{highlight}} - Current highlighted text
{{comment}} - Existing comment`)).setValue(""),o.inputEl.addClass("prompt-textarea");let l=t.createEl("div",{cls:"prompt-buttons"}),c=l.createEl("button",{cls:"prompt-save-btn",text:f("Save")});c.onclick=async()=>{var v;let u=r.value,m=o.getValue();if(u&&m){this.plugin.settings.ai.prompts||(this.plugin.settings.ai.prompts={}),this.plugin.settings.ai.prompts[u]=m,await this.plugin.saveSettings(),t.remove(),this.displayPromptList(e),new xt.Notice(f("Prompt added"));let F=(v=this.plugin.app.workspace.getLeavesOfType("comment-view")[0])==null?void 0:v.view;F&&F.updateAIDropdowns()}};let d=l.createEl("button",{cls:"prompt-cancel-btn",text:f("Cancel")});d.onclick=()=>{t.remove()}}displayPromptList(e){let A=e.querySelector(".prompt-list");A&&A.remove();let t=e.createEl("div",{cls:"prompt-list"}),r=this.plugin.settings.ai.prompts||{};for(let[o,l]of Object.entries(r)){let c=t.createEl("div",{cls:"prompt-item"}),d=c.createEl("div",{cls:"prompt-display-mode"}),g=d.createEl("div",{cls:"prompt-info"});g.createEl("div",{cls:"prompt-name",text:o});let u=l.replace(/\n/g," ");g.createEl("div",{cls:"prompt-content-preview",text:u});let v=d.createEl("div",{cls:"prompt-buttons"}).createEl("button",{cls:"prompt-edit-btn",attr:{"aria-label":f("Edit")}});(0,ks.setIcon)(v,"square-pen");let F=c.createEl("div",{cls:"prompt-edit-mode hi-note-hidden"}),y=F.createEl("input",{cls:"prompt-name-input",attr:{value:o,type:"text"}}),E=new xt.TextAreaComponent(F);E.setValue(l),E.inputEl.classList.add("prompt-content-input"),E.inputEl.addClass("prompt-textarea");let H=F.createEl("div",{cls:"prompt-edit-buttons"}),x=H.createEl("button",{cls:"prompt-save-btn",text:f("Save")}),M=H.createEl("button",{cls:"prompt-cancel-btn",text:f("Cancel")}),T=H.createEl("button",{cls:"prompt-delete-btn",attr:{"aria-label":f("Delete")}});(0,ks.setIcon)(T,"trash-2"),v.onclick=()=>{d.addClass("hi-note-hidden"),F.removeClass("hi-note-hidden")},T.onclick=async()=>{var N;delete this.plugin.settings.ai.prompts[o],await this.plugin.saveSettings(),c.remove();let R=(N=this.plugin.app.workspace.getLeavesOfType("comment-view")[0])==null?void 0:N.view;R&&R.updateAIDropdowns()},x.onclick=async()=>{var J;let R=y.value,N=E.getValue();if(R&&N){R!==o&&delete this.plugin.settings.ai.prompts[o],this.plugin.settings.ai.prompts[R]=N,await this.plugin.saveSettings(),this.displayPromptList(e),new xt.Notice(f("Prompt updated"));let AA=(J=this.plugin.app.workspace.getLeavesOfType("comment-view")[0])==null?void 0:J.view;AA&&AA.updateAIDropdowns()}},M.onclick=()=>{d.removeClass("hi-note-hidden"),F.addClass("hi-note-hidden")}}}};var Os=class{constructor(e,A){this.plugin=e,this.containerEl=A}display(){switch(new Io.Setting(this.containerEl).setName("AI service").setDesc(f("Select the AI service provider")).addDropdown(e=>{let A={openai:"OpenAI",gemini:"Gemini",anthropic:"Anthropic",deepseek:"Deepseek",siliconflow:"SiliconFlow",ollama:"Ollama (Local)"};return e.addOptions(A).setValue(this.plugin.settings.ai.provider).onChange(async t=>{this.plugin.settings.ai.provider=t,await this.plugin.saveSettings(),this.containerEl.empty(),this.display()})}),this.plugin.settings.ai.provider){case"openai":new Ls(this.plugin,this.containerEl).display(this.containerEl);break;case"gemini":new Ps(this.plugin,this.containerEl).display(this.containerEl);break;case"anthropic":new Ts(this.plugin,this.containerEl).display(this.containerEl);break;case"ollama":new Ks(this.plugin,this.containerEl).display(this.containerEl);break;case"deepseek":new Ds(this.plugin,this.containerEl).display(this.containerEl);break;case"siliconflow":new Rs(this.plugin,this.containerEl).display(this.containerEl);break}new Gs(this.plugin,this.containerEl).display()}};var VA=require("obsidian");var pi=class{constructor(e,A){this.plugin=e,this.containerEl=A,this.fsrsService=e.fsrsManager.fsrsService}display(){let e=this.containerEl.createEl("div",{cls:"flashcard-settings-container"});new VA.Setting(e).setName(f("Flashcard learning")).setHeading(),new VA.Setting(e).setName(f("New cards per day")).setDesc(f("Maximum number of new cards to learn each day")).addSlider(o=>{var d;let l=this.fsrsService.getParameters();o.setLimits(1,200,1).setValue(l.newCardsPerDay).setDynamicTooltip().onChange(async g=>{let u=this.fsrsService.getParameters();u.newCardsPerDay=g,this.fsrsService.setParameters(u),await this.plugin.saveSettings()});let c=createEl("span",{cls:"slider-value",text:String(l.newCardsPerDay)});(d=o.sliderEl.parentElement)==null||d.appendChild(c),o.sliderEl.addEventListener("input",()=>{c.textContent=String(o.getValue())})}),new VA.Setting(e).setName(f("Reviews per day")).setDesc(f("Maximum number of cards to review each day")).addSlider(o=>{var d;let l=this.fsrsService.getParameters();o.setLimits(10,500,10).setValue(l.reviewsPerDay).setDynamicTooltip().onChange(async g=>{let u=this.fsrsService.getParameters();u.reviewsPerDay=g,this.fsrsService.setParameters(u),await this.plugin.saveSettings()});let c=createEl("span",{cls:"slider-value",text:String(l.reviewsPerDay)});(d=o.sliderEl.parentElement)==null||d.appendChild(c),o.sliderEl.addEventListener("input",()=>{c.textContent=String(o.getValue())})}),new VA.Setting(e).setName(f("Target retention")).setDesc(f("Target memory retention rate (0.8 = 80%)")).addSlider(o=>{var d;let l=this.fsrsService.getParameters();o.setLimits(.7,.95,.01).setValue(l.request_retention).setDynamicTooltip().onChange(async g=>{let u=this.fsrsService.getParameters();u.request_retention=g,this.fsrsService.setParameters(u),await this.plugin.saveSettings()});let c=createEl("span",{cls:"slider-value",text:`${Math.round(l.request_retention*100)}%`});(d=o.sliderEl.parentElement)==null||d.appendChild(c),o.sliderEl.addEventListener("input",()=>{c.textContent=`${Math.round(o.getValue()*100)}%`})}),new VA.Setting(e).setName(f("Maximum interval")).setDesc(f("Maximum interval in days between reviews")).addText(o=>{let l=this.fsrsService.getParameters();o.setValue(l.maximum_interval.toString()).setPlaceholder("365").onChange(async g=>{let u=parseInt(g);if(!isNaN(u)&&u>0){let m=this.fsrsService.getParameters();m.maximum_interval=u,this.fsrsService.setParameters(m),await this.plugin.saveSettings()}});let c=o.inputEl;c.type="number",c.min="1",c.style.width="80px";let d=createEl("span",{text:` ${f("days")}`,cls:"setting-item-suffix"});c.after(d)}),new VA.Setting(e).setName(f("Reset daily stats")).setDesc(f("Reset today's learning statistics")).addButton(o=>o.setButtonText(f("Reset")).onClick(async()=>{let l=new Date;l.setHours(0,0,0,0);let c=this.plugin.fsrsManager.storage.dailyStats,d=c.findIndex(g=>g.date===l.getTime());d>=0?(c.splice(d,1),await this.plugin.fsrsManager.saveStorage(),new VA.Notice(f("Daily statistics have been reset"))):new VA.Notice(f("No statistics to reset for today"))})),new VA.Setting(e).setName(f("Advanced")).setHeading(),e.createEl("p",{text:f("These settings control the FSRS algorithm parameters. Only change them if you understand the algorithm."),cls:"setting-item-description"}),new VA.Setting(e).setName(f("Reset algorithm parameters")).setDesc(f("Reset the FSRS algorithm parameters to default values")).addButton(o=>o.setButtonText(f("Reset to default")).onClick(async()=>{this.fsrsService.resetParameters(),await this.plugin.saveSettings();let l=this.fsrsService.getParameters(),c=this.containerEl.querySelector(".setting-item:nth-child(4) .slider"),d=this.containerEl.querySelector(".setting-item:nth-child(4) .slider-value");c&&d&&(c.value=String(l.request_retention),d.textContent=`${Math.round(l.request_retention*100)}%`);let g=this.containerEl.querySelector('.setting-item:nth-child(5) input[type="number"]');g&&(g.value=String(l.maximum_interval));let u=this.containerEl.querySelector(".setting-item:nth-child(2) .slider"),m=this.containerEl.querySelector(".setting-item:nth-child(2) .slider-value");u&&m&&(u.value=String(l.newCardsPerDay),m.textContent=String(l.newCardsPerDay));let v=this.containerEl.querySelector(".setting-item:nth-child(3) .slider"),F=this.containerEl.querySelector(".setting-item:nth-child(3) .slider-value");v&&F&&(v.value=String(l.reviewsPerDay),F.textContent=String(l.reviewsPerDay));let y=this.containerEl.querySelector(".fsrs-weights-textarea");y&&(y.value=JSON.stringify(l.w)),new VA.Notice(f("FSRS parameters have been reset to default values"))}));let A=e.createEl("div",{cls:"fsrs-params-container"});A.createEl("p",{text:f("FSRS weight parameter. The default value is obtained from a smaller sample; if adjustment is needed, please use the FSRS optimizer for calculation."),cls:"setting-item-description"});let t=this.fsrsService.getParameters(),r=JSON.stringify(t.w);new VA.Setting(A).setName(f("FSRS parameters")).setDesc(f("Edit the 17 FSRS algorithm weights. Format: JSON array of numbers.")).addTextArea(o=>{o.setValue(r).setPlaceholder("[0.4872, 1.4003, ...]").onChange(async l=>{try{let c=JSON.parse(l);if(Array.isArray(c)&&c.length===17&&c.every(d=>typeof d=="number")){let d=this.fsrsService.getParameters();d.w=c,this.fsrsService.setParameters(d),await this.plugin.saveSettings(),new VA.Notice(f("FSRS weights updated successfully"))}else new VA.Notice(f("Invalid format. Must be an array of 17 numbers."),5e3)}catch(c){new VA.Notice(f("Invalid JSON format. Please check your input."),5e3)}}),o.inputEl.rows=2,o.inputEl.cols=32,o.inputEl.addClass("fsrs-weights-textarea")})}};var Ns=class extends Ho.PluginSettingTab{constructor(e,A){super(e,A),this.plugin=A,this.DEFAULT_SETTINGS=A.DEFAULT_SETTINGS,this.licenseManager=new qe(this.plugin)}async display(){let{containerEl:e}=this;e.empty();let A=e.createEl("div",{cls:"setting-tabs"}),t=e.createEl("div",{cls:"setting-tab-content"}),r=A.createEl("div",{text:f("General"),cls:"setting-tab-btn active",attr:{role:"button",tabindex:"0"}}),o=A.createEl("div",{text:f("AI service"),cls:"setting-tab-btn",attr:{role:"button",tabindex:"0"}}),l=null,c=t.createEl("div",{cls:"setting-tab-pane active"}),d=t.createEl("div",{cls:"setting-tab-pane"}),g=null,u=(m,v)=>{A.findAll(".setting-tab-btn").forEach(F=>F.removeClass("active")),t.findAll(".setting-tab-pane").forEach(F=>F.removeClass("active")),m.addClass("active"),v.addClass("active")};r.onclick=()=>u(r,c),o.onclick=()=>u(o,d),new Ms(this.plugin,c).display(),new Os(this.plugin,d).display(),l=A.createEl("div",{text:"HiCard",cls:"setting-tab-btn",attr:{role:"button",tabindex:"0"}}),g=t.createEl("div",{cls:"setting-tab-pane"}),l.onclick=async()=>{if(u(l,g),g.empty(),await this.licenseManager.isActivated())new pi(this.plugin,g).display();else{let v=g.createEl("div",{cls:"flashcard-activation-container"});v.createEl("div",{cls:"flashcard-activation-header",text:f("Activate HiCard")}),v.createEl("div",{cls:"flashcard-activation-description",text:f("Enter your license key to activate HiCard feature.")});let F=v.createEl("div",{cls:"flashcard-activation-input-container"}),y=F.createEl("input",{cls:"flashcard-activation-input",type:"text",placeholder:f("Enter license key")}),E=F.createEl("button",{cls:"flashcard-activation-button",text:f("Activate")}),H=v.createEl("div",{cls:"activation-msg"});E.onclick=async()=>{E.setAttr("disabled","true"),H.textContent=f("Verifying..."),await this.licenseManager.activateLicense(y.value)?(H.textContent=f("Activation successful!"),g.empty(),new pi(this.plugin,g).display()):(H.textContent=f("Activation failed. Please check your license key."),E.removeAttribute("disabled"))}}}}};var Do=ho(rn());var eA=(Q=>(Q[Q.New=0]="New",Q[Q.Learning=1]="Learning",Q[Q.Review=2]="Review",Q[Q.Relearning=3]="Relearning",Q))(eA||{}),D=(Q=>(Q[Q.Manual=0]="Manual",Q[Q.Again=1]="Again",Q[Q.Hard=2]="Hard",Q[Q.Good=3]="Good",Q[Q.Easy=4]="Easy",Q))(D||{}),j=class Q{static card(e){return{...e,state:Q.state(e.state),due:Q.time(e.due),last_review:e.last_review?Q.time(e.last_review):void 0}}static rating(e){if(typeof e=="string"){let A=e.charAt(0).toUpperCase(),t=e.slice(1).toLowerCase(),r=D[`${A}${t}`];if(r===void 0)throw new Error(`Invalid rating:[${e}]`);return r}else if(typeof e=="number")return e;throw new Error(`Invalid rating:[${e}]`)}static state(e){if(typeof e=="string"){let A=e.charAt(0).toUpperCase(),t=e.slice(1).toLowerCase(),r=eA[`${A}${t}`];if(r===void 0)throw new Error(`Invalid state:[${e}]`);return r}else if(typeof e=="number")return e;throw new Error(`Invalid state:[${e}]`)}static time(e){if(typeof e=="object"&&e instanceof Date)return e;if(typeof e=="string"){let A=Date.parse(e);if(isNaN(A))throw new Error(`Invalid date:[${e}]`);return new Date(A)}else if(typeof e=="number")return new Date(e);throw new Error(`Invalid date:[${e}]`)}static review_log(e){return{...e,due:Q.time(e.due),rating:Q.rating(e.rating),state:Q.state(e.state),review:Q.time(e.review)}}};Date.prototype.scheduler=function(Q,e){return Ce(this,Q,e)},Date.prototype.diff=function(Q,e){return Mt(this,Q,e)},Date.prototype.format=function(){return Zg(this)},Date.prototype.dueFormat=function(Q,e,A){return zg(this,Q,e,A)};function Ce(Q,e,A){return new Date(A?j.time(Q).getTime()+e*24*60*60*1e3:j.time(Q).getTime()+e*60*1e3)}function Mt(Q,e,A){if(!Q||!e)throw new Error("Invalid date");let t=j.time(Q).getTime()-j.time(e).getTime(),r=0;switch(A){case"days":r=Math.floor(t/(24*60*60*1e3));break;case"minutes":r=Math.floor(t/(60*1e3));break}return r}function Zg(Q){let e=j.time(Q),A=e.getFullYear(),t=e.getMonth()+1,r=e.getDate(),o=e.getHours(),l=e.getMinutes(),c=e.getSeconds();return`${A}-${fi(t)}-${fi(r)} ${fi(o)}:${fi(l)}:${fi(c)}`}function fi(Q){return Q<10?`0${Q}`:`${Q}`}var on=[60,60,24,31,12],ln=["second","min","hour","day","month","year"];function zg(Q,e,A,t=ln){Q=j.time(Q),e=j.time(e),t.length!==ln.length&&(t=ln);let r=Q.getTime()-e.getTime(),o;for(r/=1e3,o=0;o<on.length&&!(r<on[o]);o++)r/=on[o];return`${Math.floor(r)}${A?t[o]:""}`}var jg=Object.freeze([D.Again,D.Hard,D.Good,D.Easy]),Au=[{start:2.5,end:7,factor:.15},{start:7,end:20,factor:.1},{start:20,end:1/0,factor:.05}];function eu(Q,e,A){let t=1;for(let l of Au)t+=l.factor*Math.max(Math.min(Q,l.end)-l.start,0);Q=Math.min(Q,A);let r=Math.max(2,Math.round(Q-t)),o=Math.min(Math.round(Q+t),A);return Q>e&&(r=Math.max(r,e+1)),r=Math.min(r,o),{min_ivl:r,max_ivl:o}}function qA(Q,e,A){return Math.min(Math.max(Q,e),A)}function tu(Q,e){let A=Date.UTC(Q.getUTCFullYear(),Q.getUTCMonth(),Q.getUTCDate()),t=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate());return Math.floor((t-A)/864e5)}var iu="5.2.0",su=.9,ru=36500,nu=!1,au=!0,ou=Object.freeze(["1m","10m"]),lu=Object.freeze(["10m"]),NB=`v${iu} using FSRS-6.0`,ve=.001;var Vs=100,bo=.5,cu=.1542,xo=Object.freeze([.212,1.2931,2.3065,8.2956,6.4133,.8334,3.0194,.001,1.8722,.1666,.796,1.4835,.0614,.2629,1.6483,.6014,1.8729,.5425,.0912,.0658,cu]),hu=2,du=Q=>[[ve,Vs],[ve,Vs],[ve,Vs],[ve,Vs],[1,10],[.001,4],[.001,4],[.001,.75],[0,4.5],[0,.8],[.001,3.5],[.001,5],[.001,.25],[.001,.9],[0,4],[0,1],[1,6],[0,Q],[0,Q],[0,.8],[.1,.8]],pn=(Q,e)=>{let A=hu;if(Math.max(0,e)>1){let t=-(Math.log(Q[11])+Math.log(Math.pow(2,Q[13])-1)+Q[14]*.3)/e;A=qA(+t.toFixed(8),.01,2)}return du(A).map(([t,r],o)=>qA(Q[o],t,r))};var fn=Q=>{if(Q===void 0)return[...xo];switch(Q.length){case 21:return[...Q];case 19:return console.debug("[FSRS-6]auto fill w from 19 to 21 length"),[...Q,0,bo];case 17:{let e=[...Q];return e[4]=+(e[5]*2+e[4]).toFixed(8),e[5]=+(Math.log(e[5]*3+1)/3).toFixed(8),e[6]=+(e[6]+.5).toFixed(8),console.debug("[FSRS-6]auto fill w from 17 to 21 length"),e.concat([0,0,0,bo])}default:return console.warn("[FSRS]Invalid parameters length, using default parameters"),[...xo]}},_s=Q=>{var r,o;let e=Array.isArray(Q==null?void 0:Q.learning_steps)?Q.learning_steps:ou,A=Array.isArray(Q==null?void 0:Q.relearning_steps)?Q.relearning_steps:lu,t=pn(fn(Q==null?void 0:Q.w),A.length);return{request_retention:(Q==null?void 0:Q.request_retention)||su,maximum_interval:(Q==null?void 0:Q.maximum_interval)||ru,w:t,enable_fuzz:(r=Q==null?void 0:Q.enable_fuzz)!=null?r:nu,enable_short_term:(o=Q==null?void 0:Q.enable_short_term)!=null?o:au,learning_steps:e,relearning_steps:A}};function Lt(Q,e){let A={due:Q?j.time(Q):new Date,stability:0,difficulty:0,elapsed_days:0,scheduled_days:0,reps:0,lapses:0,learning_steps:0,state:eA.New,last_review:void 0};return e&&typeof e=="function"?e(A):A}var cn=class{constructor(e){EA(this,"c");EA(this,"s0");EA(this,"s1");EA(this,"s2");let A=gu();this.c=1,this.s0=A(" "),this.s1=A(" "),this.s2=A(" "),e==null&&(e=+new Date),this.s0-=A(e),this.s0<0&&(this.s0+=1),this.s1-=A(e),this.s1<0&&(this.s1+=1),this.s2-=A(e),this.s2<0&&(this.s2+=1)}next(){let e=2091639*this.s0+this.c*23283064365386963e-26;return this.s0=this.s1,this.s1=this.s2,this.s2=e-(this.c=e|0),this.s2}set state(e){this.c=e.c,this.s0=e.s0,this.s1=e.s1,this.s2=e.s2}get state(){return{c:this.c,s0:this.s0,s1:this.s1,s2:this.s2}}};function gu(){let Q=4022871197;return function(e){e=String(e);for(let A=0;A<e.length;A++){Q+=e.charCodeAt(A);let t=.02519603282416938*Q;Q=t>>>0,t-=Q,t*=Q,Q=t>>>0,t-=Q,Q+=t*4294967296}return(Q>>>0)*23283064365386963e-26}}function uu(Q){let e=new cn(Q),A=()=>e.next();return A.int32=()=>e.next()*4294967296|0,A.double=()=>A()+(A()*2097152|0)*11102230246251565e-32,A.state=()=>e.state,A.importState=t=>(e.state=t,A),A}var Mo=Q=>{let e=typeof Q=="number"?-Q:-Q[20],A=Math.exp(Math.pow(e,-1)*Math.log(.9))-1;return{decay:e,factor:+A.toFixed(8)}};function hn(Q,e,A){let{decay:t,factor:r}=Mo(Q);return+Math.pow(1+r*e/A,t).toFixed(8)}var dn=class{constructor(e){EA(this,"param");EA(this,"intervalModifier");EA(this,"_seed");EA(this,"forgetting_curve");this.param=new Proxy(_s(e),this.params_handler_proxy()),this.intervalModifier=this.calculate_interval_modifier(this.param.request_retention),this.forgetting_curve=hn.bind(this,this.param.w)}get interval_modifier(){return this.intervalModifier}set seed(e){this._seed=e}calculate_interval_modifier(e){if(e<=0||e>1)throw new Error("Requested retention rate should be in the range (0,1]");let{decay:A,factor:t}=Mo(this.param.w);return+((Math.pow(e,1/A)-1)/t).toFixed(8)}get parameters(){return this.param}set parameters(e){this.update_parameters(e)}params_handler_proxy(){let e=this;return{set:function(A,t,r){return t==="request_retention"&&Number.isFinite(r)?e.intervalModifier=e.calculate_interval_modifier(Number(r)):t==="w"&&(r=pn(fn(r),A.relearning_steps.length),e.forgetting_curve=hn.bind(this,r),e.intervalModifier=e.calculate_interval_modifier(Number(A.request_retention))),Reflect.set(A,t,r),!0}}}update_parameters(e){let A=_s(e);for(let t in A)if(t in this.param){let r=t;this.param[r]=A[r]}}init_stability(e){return Math.max(this.param.w[e-1],.1)}init_difficulty(e){return+(this.param.w[4]-Math.exp((e-1)*this.param.w[5])+1).toFixed(8)}apply_fuzz(e,A){if(!this.param.enable_fuzz||e<2.5)return Math.round(e);let t=uu(this._seed)(),{min_ivl:r,max_ivl:o}=eu(e,A,this.param.maximum_interval);return Math.floor(t*(o-r+1)+r)}next_interval(e,A){let t=Math.min(Math.max(1,Math.round(e*this.intervalModifier)),this.param.maximum_interval);return this.apply_fuzz(t,A)}linear_damping(e,A){return+(e*(10-A)/9).toFixed(8)}next_difficulty(e,A){let t=-this.param.w[6]*(A-3),r=e+this.linear_damping(t,e);return qA(this.mean_reversion(this.init_difficulty(D.Easy),r),1,10)}mean_reversion(e,A){return+(this.param.w[7]*e+(1-this.param.w[7])*A).toFixed(8)}next_recall_stability(e,A,t,r){let o=D.Hard===r?this.param.w[15]:1,l=D.Easy===r?this.param.w[16]:1;return+qA(A*(1+Math.exp(this.param.w[8])*(11-e)*Math.pow(A,-this.param.w[9])*(Math.exp((1-t)*this.param.w[10])-1)*o*l),ve,36500).toFixed(8)}next_forget_stability(e,A,t){return+qA(this.param.w[11]*Math.pow(e,-this.param.w[12])*(Math.pow(A+1,this.param.w[13])-1)*Math.exp((1-t)*this.param.w[14]),ve,36500).toFixed(8)}next_short_term_stability(e,A){let t=Math.pow(e,-this.param.w[19])*Math.exp(this.param.w[17]*(A-3+this.param.w[18])),r=A>=3?Math.max(t,1):t;return+qA(e*r,ve,36500).toFixed(8)}next_state(e,A,t){let{difficulty:r,stability:o}=e!=null?e:{difficulty:0,stability:0};if(A<0)throw new Error(`Invalid delta_t "${A}"`);if(t<0||t>4)throw new Error(`Invalid grade "${t}"`);if(r===0&&o===0)return{difficulty:qA(this.init_difficulty(t),1,10),stability:this.init_stability(t)};if(t===0)return{difficulty:r,stability:o};if(r<1||o<ve)throw new Error(`Invalid memory state { difficulty: ${r}, stability: ${o} }`);let l=this.forgetting_curve(A,o),c=this.next_recall_stability(r,o,l,t),d=this.next_forget_stability(r,o,l),g=this.next_short_term_stability(o,t),u=c;if(t===1){let[m,v]=[0,0];this.param.enable_short_term&&(m=this.param.w[17],v=this.param.w[18]);let F=o/Math.exp(m*v);u=qA(+F.toFixed(8),ve,d)}return A===0&&this.param.enable_short_term&&(u=g),{difficulty:this.next_difficulty(r,t),stability:u}}};function pu(){let Q=this.review_time.getTime(),e=this.current.reps,A=this.current.difficulty*this.current.stability;return`${Q}_${e}_${A}`}var fu=Q=>{let e=Q.slice(-1),A=parseInt(Q.slice(0,-1),10);if(isNaN(A)||!Number.isFinite(A)||A<0)throw new Error(`Invalid step value: ${Q}`);switch(e){case"m":return A;case"h":return A*60;case"d":return A*1440;default:throw new Error(`Invalid step unit: ${Q}, expected m/h/d`)}},mu=(Q,e,A)=>{let t=e===eA.Relearning||e===eA.Review?Q.relearning_steps:Q.learning_steps,r=t.length;if(r===0||A>=r)return{};let o=t[0],l=fu,c=()=>l(o),d=()=>{if(r===1)return Math.round(l(o)*1.5);let F=t[1];return Math.round((l(o)+l(F))/2)},g=F=>F<0||F>=r?null:t[F],u=F=>l(F),m={},v=g(Math.max(0,A));if(e===eA.Review)return m[D.Again]={scheduled_minutes:l(v),next_step:0},m;{m[D.Again]={scheduled_minutes:c(),next_step:0},m[D.Hard]={scheduled_minutes:d(),next_step:A};let F=g(A+1);if(F){let y=u(F);y&&(m[D.Good]={scheduled_minutes:Math.round(y),next_step:A+1})}}return m},Ys=(Q=>(Q.SCHEDULER="Scheduler",Q.LEARNING_STEPS="LearningSteps",Q.SEED="Seed",Q))(Ys||{}),Xs=class{constructor(e,A,t,r){EA(this,"last");EA(this,"current");EA(this,"review_time");EA(this,"next",new Map);EA(this,"algorithm");EA(this,"strategies");EA(this,"elapsed_days",0);this.algorithm=t,this.last=j.card(e),this.current=j.card(e),this.review_time=j.time(A),this.strategies=r,this.init()}checkGrade(e){if(!Number.isFinite(e)||e<0||e>4)throw new Error(`Invalid grade "${e}",expected 1-4`)}init(){let{state:e,last_review:A}=this.current,t=0;e!==eA.New&&A&&(t=tu(A,this.review_time)),this.current.last_review=this.review_time,this.elapsed_days=t,this.current.elapsed_days=t,this.current.reps+=1;let r=pu;if(this.strategies){let o=this.strategies.get(Ys.SEED);o&&(r=o)}this.algorithm.seed=r.call(this)}preview(){return{[D.Again]:this.review(D.Again),[D.Hard]:this.review(D.Hard),[D.Good]:this.review(D.Good),[D.Easy]:this.review(D.Easy),[Symbol.iterator]:this.previewIterator.bind(this)}}*previewIterator(){for(let e of jg)yield this.review(e)}review(e){let{state:A}=this.last,t;switch(this.checkGrade(e),A){case eA.New:t=this.newState(e);break;case eA.Learning:case eA.Relearning:t=this.learningState(e);break;case eA.Review:t=this.reviewState(e);break}return t}buildLog(e){let{last_review:A,due:t,elapsed_days:r}=this.last;return{rating:e,state:this.current.state,due:A||t,stability:this.current.stability,difficulty:this.current.difficulty,elapsed_days:this.elapsed_days,last_elapsed_days:r,scheduled_days:this.current.scheduled_days,learning_steps:this.current.learning_steps,review:this.review_time}}},Js=class extends Xs{constructor(A,t,r,o){super(A,t,r,o);EA(this,"learningStepsStrategy");let l=mu;if(this.strategies){let c=this.strategies.get(Ys.LEARNING_STEPS);c&&(l=c)}this.learningStepsStrategy=l}getLearningInfo(A,t){var d,g,u,m;let r=this.algorithm.parameters;A.learning_steps=A.learning_steps||0;let o=this.learningStepsStrategy(r,A.state,this.current.state===eA.Learning?A.learning_steps+1:A.learning_steps),l=Math.max(0,(g=(d=o[t])==null?void 0:d.scheduled_minutes)!=null?g:0),c=Math.max(0,(m=(u=o[t])==null?void 0:u.next_step)!=null?m:0);return{scheduled_minutes:l,next_steps:c}}applyLearningSteps(A,t,r){let{scheduled_minutes:o,next_steps:l}=this.getLearningInfo(this.current,t);if(o>0&&o<1440)A.learning_steps=l,A.scheduled_days=0,A.state=r,A.due=Ce(this.review_time,Math.round(o),!1);else if(A.state=eA.Review,o>=1440)A.learning_steps=l,A.due=Ce(this.review_time,Math.round(o),!1),A.scheduled_days=Math.floor(o/1440);else{A.learning_steps=0;let c=this.algorithm.next_interval(A.stability,this.elapsed_days);A.scheduled_days=c,A.due=Ce(this.review_time,c,!0)}}newState(A){let t=this.next.get(A);if(t)return t;let r=j.card(this.current);r.difficulty=qA(this.algorithm.init_difficulty(A),1,10),r.stability=this.algorithm.init_stability(A),this.applyLearningSteps(r,A,eA.Learning);let o={card:r,log:this.buildLog(A)};return this.next.set(A,o),o}learningState(A){let t=this.next.get(A);if(t)return t;let{state:r,difficulty:o,stability:l}=this.last,c=j.card(this.current);c.difficulty=this.algorithm.next_difficulty(o,A),c.stability=this.algorithm.next_short_term_stability(l,A),this.applyLearningSteps(c,A,r);let d={card:c,log:this.buildLog(A)};return this.next.set(A,d),d}reviewState(A){let t=this.next.get(A);if(t)return t;let r=this.elapsed_days,{difficulty:o,stability:l}=this.last,c=this.algorithm.forgetting_curve(r,l),d=j.card(this.current),g=j.card(this.current),u=j.card(this.current),m=j.card(this.current);this.next_ds(d,g,u,m,o,l,c),this.next_interval(g,u,m,r),this.next_state(g,u,m),this.applyLearningSteps(d,D.Again,eA.Relearning),d.lapses+=1;let v={card:d,log:this.buildLog(D.Again)},F={card:g,log:super.buildLog(D.Hard)},y={card:u,log:super.buildLog(D.Good)},E={card:m,log:super.buildLog(D.Easy)};return this.next.set(D.Again,v),this.next.set(D.Hard,F),this.next.set(D.Good,y),this.next.set(D.Easy,E),this.next.get(A)}next_ds(A,t,r,o,l,c,d){A.difficulty=this.algorithm.next_difficulty(l,D.Again);let g=c/Math.exp(this.algorithm.parameters.w[17]*this.algorithm.parameters.w[18]),u=this.algorithm.next_forget_stability(l,c,d);A.stability=qA(+g.toFixed(8),ve,u),t.difficulty=this.algorithm.next_difficulty(l,D.Hard),t.stability=this.algorithm.next_recall_stability(l,c,d,D.Hard),r.difficulty=this.algorithm.next_difficulty(l,D.Good),r.stability=this.algorithm.next_recall_stability(l,c,d,D.Good),o.difficulty=this.algorithm.next_difficulty(l,D.Easy),o.stability=this.algorithm.next_recall_stability(l,c,d,D.Easy)}next_interval(A,t,r,o){let l,c;l=this.algorithm.next_interval(A.stability,o),c=this.algorithm.next_interval(t.stability,o),l=Math.min(l,c),c=Math.max(c,l+1);let d=Math.max(this.algorithm.next_interval(r.stability,o),c+1);A.scheduled_days=l,A.due=Ce(this.review_time,l,!0),t.scheduled_days=c,t.due=Ce(this.review_time,c,!0),r.scheduled_days=d,r.due=Ce(this.review_time,d,!0)}next_state(A,t,r){A.state=eA.Review,A.learning_steps=0,t.state=eA.Review,t.learning_steps=0,r.state=eA.Review,r.learning_steps=0}},Ws=class extends Xs{newState(e){let A=this.next.get(e);if(A)return A;this.current.scheduled_days=0,this.current.elapsed_days=0;let t=j.card(this.current),r=j.card(this.current),o=j.card(this.current),l=j.card(this.current);return this.init_ds(t,r,o,l),this.next_interval(t,r,o,l,0),this.next_state(t,r,o,l),this.update_next(t,r,o,l),this.next.get(e)}init_ds(e,A,t,r){e.difficulty=qA(this.algorithm.init_difficulty(D.Again),1,10),e.stability=this.algorithm.init_stability(D.Again),A.difficulty=qA(this.algorithm.init_difficulty(D.Hard),1,10),A.stability=this.algorithm.init_stability(D.Hard),t.difficulty=qA(this.algorithm.init_difficulty(D.Good),1,10),t.stability=this.algorithm.init_stability(D.Good),r.difficulty=qA(this.algorithm.init_difficulty(D.Easy),1,10),r.stability=this.algorithm.init_stability(D.Easy)}learningState(e){return this.reviewState(e)}reviewState(e){let A=this.next.get(e);if(A)return A;let t=this.elapsed_days,{difficulty:r,stability:o}=this.last,l=this.algorithm.forgetting_curve(t,o),c=j.card(this.current),d=j.card(this.current),g=j.card(this.current),u=j.card(this.current);return this.next_ds(c,d,g,u,r,o,l),this.next_interval(c,d,g,u,t),this.next_state(c,d,g,u),c.lapses+=1,this.update_next(c,d,g,u),this.next.get(e)}next_ds(e,A,t,r,o,l,c){e.difficulty=this.algorithm.next_difficulty(o,D.Again);let d=this.algorithm.next_forget_stability(o,l,c);e.stability=qA(l,ve,d),A.difficulty=this.algorithm.next_difficulty(o,D.Hard),A.stability=this.algorithm.next_recall_stability(o,l,c,D.Hard),t.difficulty=this.algorithm.next_difficulty(o,D.Good),t.stability=this.algorithm.next_recall_stability(o,l,c,D.Good),r.difficulty=this.algorithm.next_difficulty(o,D.Easy),r.stability=this.algorithm.next_recall_stability(o,l,c,D.Easy)}next_interval(e,A,t,r,o){let l,c,d,g;l=this.algorithm.next_interval(e.stability,o),c=this.algorithm.next_interval(A.stability,o),d=this.algorithm.next_interval(t.stability,o),g=this.algorithm.next_interval(r.stability,o),l=Math.min(l,c),c=Math.max(c,l+1),d=Math.max(d,c+1),g=Math.max(g,d+1),e.scheduled_days=l,e.due=Ce(this.review_time,l,!0),A.scheduled_days=c,A.due=Ce(this.review_time,c,!0),t.scheduled_days=d,t.due=Ce(this.review_time,d,!0),r.scheduled_days=g,r.due=Ce(this.review_time,g,!0)}next_state(e,A,t,r){e.state=eA.Review,e.learning_steps=0,A.state=eA.Review,A.learning_steps=0,t.state=eA.Review,t.learning_steps=0,r.state=eA.Review,r.learning_steps=0}update_next(e,A,t,r){let o={card:e,log:this.buildLog(D.Again)},l={card:A,log:super.buildLog(D.Hard)},c={card:t,log:super.buildLog(D.Good)},d={card:r,log:super.buildLog(D.Easy)};this.next.set(D.Again,o),this.next.set(D.Hard,l),this.next.set(D.Good,c),this.next.set(D.Easy,d)}},gn=class{constructor(e){EA(this,"fsrs");this.fsrs=e}replay(e,A,t){return this.fsrs.next(e,A,t)}handleManualRating(e,A,t,r,o,l,c){if(typeof A>"u")throw new Error("reschedule: state is required for manual rating");let d,g;if(A===eA.New)d={rating:D.Manual,state:A,due:c!=null?c:t,stability:e.stability,difficulty:e.difficulty,elapsed_days:r,last_elapsed_days:e.elapsed_days,scheduled_days:e.scheduled_days,learning_steps:e.learning_steps,review:t},g=Lt(t),g.last_review=t;else{if(typeof c>"u")throw new Error("reschedule: due is required for manual rating");let u=Mt(c,t,"days");d={rating:D.Manual,state:e.state,due:e.last_review||e.due,stability:e.stability,difficulty:e.difficulty,elapsed_days:r,last_elapsed_days:e.elapsed_days,scheduled_days:e.scheduled_days,learning_steps:e.learning_steps,review:t},g={...e,state:A,due:c,last_review:t,stability:o||e.stability,difficulty:l||e.difficulty,elapsed_days:r,scheduled_days:u,reps:e.reps+1}}return{card:g,log:d}}reschedule(e,A){let t=[],r=Lt(e.due);for(let o of A){let l;if(o.review=j.time(o.review),o.rating===D.Manual){let c=0;r.state!==eA.New&&r.last_review&&(c=Mt(o.review,r.last_review,"days")),l=this.handleManualRating(r,o.state,o.review,c,o.stability,o.difficulty,o.due?j.time(o.due):void 0)}else l=this.replay(r,o.review,o.rating);t.push(l),r=l.card}return t}calculateManualRecord(e,A,t,r){if(!t)return null;let{card:o,log:l}=t,c=j.card(e);return c.due.getTime()===o.due.getTime()?null:(c.scheduled_days=Mt(o.due,c.due,"days"),this.handleManualRating(c,o.state,j.time(A),l.elapsed_days,r?o.stability:void 0,r?o.difficulty:void 0,o.due))}},un=class extends dn{constructor(A){super(A);EA(this,"strategyHandler",new Map);EA(this,"Scheduler");let{enable_short_term:t}=this.parameters;this.Scheduler=t?Js:Ws}params_handler_proxy(){let A=this;return{set:function(t,r,o){return r==="request_retention"&&Number.isFinite(o)?A.intervalModifier=A.calculate_interval_modifier(Number(o)):r==="enable_short_term"?A.Scheduler=o===!0?Js:Ws:r==="w"&&(o=pn(fn(o),t.relearning_steps.length),A.forgetting_curve=hn.bind(this,o),A.intervalModifier=A.calculate_interval_modifier(Number(t.request_retention))),Reflect.set(t,r,o),!0}}}useStrategy(A,t){return this.strategyHandler.set(A,t),this}clearStrategy(A){return A?this.strategyHandler.delete(A):this.strategyHandler.clear(),this}getScheduler(A,t){let r=this.strategyHandler.get(Ys.SCHEDULER)||this.Scheduler;return new r(A,t,this,this.strategyHandler)}repeat(A,t,r){let o=this.getScheduler(A,t).preview();return r&&typeof r=="function"?r(o):o}next(A,t,r,o){let l=this.getScheduler(A,t),c=j.rating(r);if(c===D.Manual)throw new Error("Cannot review a manual rating");let d=l.review(c);return o&&typeof o=="function"?o(d):d}get_retrievability(A,t,r=!0){let o=j.card(A);t=t?j.time(t):new Date;let l=o.state!==eA.New?Math.max(Mt(t,o.last_review,"days"),0):0,c=o.state!==eA.New?this.forgetting_curve(l,+o.stability.toFixed(8)):0;return r?`${(c*100).toFixed(2)}%`:c}rollback(A,t,r){let o=j.card(A),l=j.review_log(t);if(l.rating===D.Manual)throw new Error("Cannot rollback a manual rating");let c,d,g;switch(l.state){case eA.New:c=l.due,d=void 0,g=0;break;case eA.Learning:case eA.Relearning:case eA.Review:c=l.review,d=l.due,g=o.lapses-(l.rating===D.Again&&l.state===eA.Review?1:0);break}let u={...o,due:c,stability:l.stability,difficulty:l.difficulty,elapsed_days:l.last_elapsed_days,scheduled_days:l.scheduled_days,reps:Math.max(0,o.reps-1),lapses:Math.max(0,g),learning_steps:l.learning_steps,state:l.state,last_review:d};return r&&typeof r=="function"?r(u):u}forget(A,t,r=!1,o){let l=j.card(A);t=j.time(t);let c=l.state===eA.New?0:Mt(t,l.due,"days"),d={rating:D.Manual,state:l.state,due:l.due,stability:l.stability,difficulty:l.difficulty,elapsed_days:0,last_elapsed_days:l.elapsed_days,scheduled_days:c,learning_steps:l.learning_steps,review:t},g={card:{...l,due:t,stability:0,difficulty:0,elapsed_days:0,scheduled_days:0,reps:r?0:l.reps,lapses:r?0:l.lapses,learning_steps:0,state:eA.New,last_review:l.last_review},log:d};return o&&typeof o=="function"?o(g):g}reschedule(A,t=[],r={}){let{recordLogHandler:o,reviewsOrderBy:l,skipManual:c=!0,now:d=new Date,update_memory_state:g=!1}=r;l&&typeof l=="function"&&t.sort(l),c&&(t=t.filter(E=>E.rating!==D.Manual));let u=new gn(this),m=u.reschedule(r.first_card||Lt(),t),v=m.length,F=j.card(A),y=u.calculateManualRecord(F,d,v?m[v-1]:void 0,g);return o&&typeof o=="function"?{collections:m.map(o),reschedule_item:y?o(y):null}:{collections:m,reschedule_item:y}}},mn=Q=>new un(Q||{});var $s=class{constructor(e={}){this.params=this.convertToTsFSRSParams(e),this.fsrsInstance=mn(this.params)}convertToTsFSRSParams(e){let{request_retention:A=.9,maximum_interval:t=36500,w:r=[]}=e;return _s({request_retention:A,maximum_interval:t,enable_fuzz:!0,enable_short_term:!0,w:e.w||[]})}toTsFSRSCard(e){if(e.lastReview===0)return Lt(new Date(e.createdAt));let A=eA.New;return e.reviews>0&&(e.lapses>0?A=eA.Relearning:A=eA.Review),{due:new Date(e.nextReview),stability:e.stability,difficulty:e.difficulty,elapsed_days:e.lastReview?(Date.now()-e.lastReview)/(24*60*60*1e3):0,scheduled_days:e.lastReview?(e.nextReview-e.lastReview)/(24*60*60*1e3):0,reps:e.reviews,lapses:e.lapses,state:A,last_review:e.lastReview?new Date(e.lastReview):void 0,learning_steps:0}}convertRating(e){switch(e){case cA.AGAIN:return D.Again;case cA.HARD:return D.Hard;case cA.GOOD:return D.Good;case cA.EASY:return D.Easy;default:return D.Good}}fromTsFSRSCard(e,A){let{card:t,log:r}=A;return{...e,difficulty:t.difficulty,stability:t.stability,retrievability:Math.exp(Math.log(.9)*t.elapsed_days/t.stability),lastReview:r.review.getTime(),nextReview:t.due.getTime(),reviews:t.reps,lapses:t.lapses,reviewHistory:[...e.reviewHistory,{timestamp:r.review.getTime(),rating:this.convertTsFSRSRatingToFSRSRating(r.rating),elapsed:r.elapsed_days}]}}convertTsFSRSRatingToFSRSRating(e){switch(e){case D.Again:return cA.AGAIN;case D.Hard:return cA.HARD;case D.Good:return cA.GOOD;case D.Easy:return cA.EASY;default:return cA.GOOD}}initializeCard(e,A,t){let r=Date.now(),o=Lt(new Date(r));return{id:XA.generateCardId(),difficulty:o.difficulty,stability:o.stability,retrievability:1,lastReview:0,nextReview:r,reviews:0,lapses:0,reviewHistory:[],text:e,answer:A,filePath:t,createdAt:r}}reviewCard(e,A){let t=this.toTsFSRSCard(e),r=this.convertRating(A),o=new Date;if(r!==D.Manual){let l=this.fsrsInstance.next(t,o,r);return this.fromTsFSRSCard(e,l)}else return e}getSchedulingCards(e){let A=this.toTsFSRSCard(e),t=new Date,r=this.fsrsInstance.repeat(A,t);return{[cA.AGAIN]:this.fromTsFSRSCard(e,r[D.Again]),[cA.HARD]:this.fromTsFSRSCard(e,r[D.Hard]),[cA.GOOD]:this.fromTsFSRSCard(e,r[D.Good]),[cA.EASY]:this.fromTsFSRSCard(e,r[D.Easy])}}isDue(e){return Date.now()>=e.nextReview}getParameters(){return{...this.params}}setParameters(e){this.params=this.convertToTsFSRSParams(e),this.fsrsInstance=mn(this.params)}};var qs=class{constructor(e={}){this.params={...Wr,...e},this.adapter=new $s(this.params)}initializeCard(e,A,t){return this.adapter.initializeCard(e,A,t)}reviewCard(e,A){return this.adapter.reviewCard(e,A)}isDue(e){return this.adapter.isDue(e)}getReviewableCards(e){return e.filter(A=>this.isDue(A)).sort((A,t)=>A.nextReview-t.nextReview)}getParameters(){return{...this.params}}setParameters(e){this.params={...this.params,...e},this.adapter.setParameters(this.params)}resetParameters(){this.params={...Wr},this.adapter.setParameters(this.params)}getSchedulingCards(e){return this.adapter.getSchedulingCards(e)}};var Zs=class{constructor(e,A){this.plugin=e,this.fsrsService=A}get storage(){return this.plugin.fsrsManager.storage}createCard(e,A,t){try{return this.fsrsService.initializeCard(e,A,t)}catch(r){console.error("\u521B\u5EFA\u5361\u7247\u65F6\u51FA\u9519:",r);try{return this.fsrsService.initializeCard(e,A,t)}catch(o){console.error("\u7B2C\u4E8C\u6B21\u5C1D\u8BD5\u521B\u5EFA\u5361\u7247\u5931\u8D25:",o);let l=new Date;return this.fsrsService.initializeCard(e,A,t)}}}addCard(e,A,t){let r=this.createCard(e,A,t);this.storage.cards||(this.storage.cards={}),this.storage.cards[r.id]=r;try{this.plugin.eventManager.emitFlashcardChanged()}catch(o){console.error("\u4FDD\u5B58\u5361\u7247\u65F6\u51FA\u9519:",o)}return r}getCardsByFile(e){return this.storage.cards?Object.values(this.storage.cards).filter(A=>A.filePath===e):[]}deleteCard(e){try{return!this.storage.cards||!this.storage.cards[e]?!1:(delete this.storage.cards[e],this.plugin.eventManager.emitFlashcardChanged(),!0)}catch(A){return console.error("\u5220\u9664\u5361\u7247\u65F6\u51FA\u9519:",A),!1}}};var mi=class{constructor(e,A){this.plugin=e,this.storage=A}getCardGroups(){return this.storage.cardGroups||[]}getGroupById(e){return this.storage.cardGroups.find(A=>A.id===e)||null}async createCardGroup(e){Array.isArray(this.storage.cardGroups)||(this.storage.cardGroups=[]);let t={id:XA.generateGroupId(),name:e.name,filter:e.filter,createdTime:e.createdTime||Date.now(),sortOrder:e.sortOrder||this.storage.cardGroups.length,isReversed:e.isReversed||!1,settings:e.settings||{useGlobalSettings:!0},cardIds:[]};this.storage.cardGroups.push(t),e.filter&&e.filter.trim().length>0&&this.updateGroupCardIds(t.id);try{await this.plugin.fsrsManager.saveStoragePublic()}catch(r){console.error("\u4FDD\u5B58\u5206\u7EC4\u6570\u636E\u65F6\u51FA\u9519:",r)}return this.plugin.eventManager.emitFlashcardChanged(),t}async updateCardGroup(e,A){let t=this.storage.cardGroups.findIndex(r=>r.id===e);return t===-1?!1:(this.storage.cardGroups[t]={...this.storage.cardGroups[t],...A},A.filter&&this.updateGroupCardIds(e),this.plugin.eventManager.emitFlashcardChanged(),!0)}async deleteCardGroup(e,A=!1){let t=this.storage.cardGroups.findIndex(c=>c.id===e);if(t===-1)return!1;let r=this.storage.cardGroups[t],o=this.storage.uiState;o.currentGroupId===e&&(o.currentGroupId="",o.currentGroupName="",o.currentIndex=0,o.isFlipped=!1,o.completionMessage=null),o.groupCompletionMessages&&e in o.groupCompletionMessages&&delete o.groupCompletionMessages[e],o.groupProgress&&e in o.groupProgress&&delete o.groupProgress[e];let l=[...r.cardIds||[]];for(let c of l)this.removeCardFromGroup(c,e);return this.storage.cardGroups.splice(t,1),this.plugin.eventManager.emitFlashcardChanged(),!0}addCardToGroup(e,A){let t=this.storage.cardGroups.find(o=>o.id===A);if(!t)return!1;let r=this.storage.cards[e];return r?(t.cardIds||(t.cardIds=[]),r.groupIds||(r.groupIds=[]),t.cardIds.includes(e)||(t.cardIds.push(e),r.groupIds.includes(A)||r.groupIds.push(A)),!0):!1}removeCardFromGroup(e,A){let t=this.storage.cardGroups.find(o=>o.id===A);if(!t||!t.cardIds)return!1;let r=this.storage.cards[e];return r?(t.cardIds=t.cardIds.filter(o=>o!==e),r.groupIds&&(r.groupIds=r.groupIds.filter(o=>o!==A)),!0):!1}getCardsByGroupId(e){let A=this.getGroupById(e);if(!A)return console.error(`[getCardsByGroupId] \u9519\u8BEF: \u672A\u627E\u5230\u5206\u7EC4: ${e}`),[];let t=Object.keys(this.storage.cards||{});if(A.cardIds&&A.cardIds.length>0)return A.cardIds.filter(o=>{let l=!!this.storage.cards[o];return l||console.warn(`[getCardsByGroupId] \u5361\u7247\u4E0D\u5B58\u5728: ${o}`),l}).map(o=>this.storage.cards[o]);if(A.filter&&A.filter.trim().length>0){let r=Object.values(this.storage.cards),o=A.filter.split(",").map(d=>d.trim()).filter(d=>d.length>0),l=/\[\[([^\]]+)\]\]/;return r.filter(d=>{if(!d.filePath)return!1;let g=d.filePath.toLowerCase(),u=g.split("/").pop()||"",m=u.replace(/\.md$/i,"");for(let v of o){let F=v.toLowerCase(),y=F.match(l);if(y){let E=y[1].toLowerCase();if(m===E||u===E)return!0}else if(g.includes(F)||d.text&&d.text.toLowerCase().includes(F)||d.answer&&d.answer.toLowerCase().includes(F))return!0}return!1})}return[]}getGroupProgress(e){if(!this.getGroupById(e))return null;let t=this.getCardsByGroupId(e),r=Date.now();return{due:t.filter(o=>o.nextReview<=r).length,newCards:t.filter(o=>o.lastReview===0).length,learned:t.filter(o=>o.lastReview>0).length,retention:this.calculateGroupRetention(t)}}calculateGroupRetention(e){let A=e.filter(r=>r.lastReview>0);return A.length===0?1:A.reduce((r,o)=>r+o.retrievability,0)/A.length}deleteCardReference(e){for(let A of this.storage.cardGroups)A.cardIds&&(A.cardIds=A.cardIds.filter(t=>t!==e))}getGroupsByCardId(e){let A=this.storage.cards[e];return!A||!A.groupIds?[]:A.groupIds.map(t=>this.storage.cardGroups.find(r=>r.id===t)).filter(t=>t!==void 0)}updateGroupCardIds(e){let A=this.getGroupById(e);if(!A||!A.filter||A.filter.trim().length===0)return!1;let t=Object.values(this.storage.cards||{}),r=A.filter.split(",").map(g=>g.trim()).filter(g=>g.length>0),o=/\[\[([^\]]+)\]\]/,c=t.filter(g=>{if(!g.filePath)return!1;let u=g.filePath.toLowerCase(),m=u.split("/").pop()||"",v=m.replace(/\.md$/i,"");for(let F of r){let y=F.toLowerCase(),E=y.match(o);if(E){let H=E[1].toLowerCase();if(v===H||m===H)return!0}else if(u.includes(y)||g.text&&g.text.toLowerCase().includes(y)||g.answer&&g.answer.toLowerCase().includes(y))return!0}return!1}).map(g=>g.id);A.cardIds||(A.cardIds=[]);let d=!1;for(let g of c)A.cardIds.includes(g)||(A.cardIds.push(g),d=!0);return d&&this.plugin.fsrsManager.saveStorageDebounced(),d}};var Lo=require("obsidian"),zs=class{constructor(e){this.plugin=e,this.fsrsService=new qs,this.cardFactory=new Zs(e,this.fsrsService),this.storage={version:"1.0",cards:{},globalStats:{totalReviews:0,averageRetention:1,streakDays:0,lastReviewDate:0},cardGroups:[],uiState:{currentGroupName:"",completionMessage:null,groupProgress:{}},dailyStats:[]},this.saveStorageDebounced=(0,Lo.debounce)(this.saveStorage.bind(this),1e3,!0),this.loadStorage().then(A=>{this.storage=A,this.groupRepository=new mi(e,this.storage),this.registerEventListeners()}).catch(A=>{console.error("Loading storage data failed:",A),this.groupRepository=new mi(e,this.storage),this.registerEventListeners()})}async loadStorage(){let e={version:"1.0",cards:{},globalStats:{totalReviews:0,averageRetention:1,streakDays:0,lastReviewDate:0},cardGroups:[],uiState:{currentGroupName:"",completionMessage:null,groupProgress:{}},dailyStats:[]};try{let A=await this.plugin.loadData();if(!(A!=null&&A.fsrs))return e;A.fsrs.cardGroups&&Array.isArray(A.fsrs.cardGroups)&&A.fsrs.cardGroups.length>0;let t=Array.isArray(A.fsrs.cardGroups)?A.fsrs.cardGroups:[];return{version:A.fsrs.version||e.version,cards:A.fsrs.cards||{},globalStats:A.fsrs.globalStats||e.globalStats,cardGroups:t,uiState:A.fsrs.uiState||e.uiState,dailyStats:A.fsrs.dailyStats||[]}}catch(A){return console.error("Loading storage data failed:",A),e}}async saveStorage(){try{let e=await this.plugin.loadData()||{};Array.isArray(this.storage.cardGroups)||(this.storage.cardGroups=[]),this.storage.cards||(this.storage.cards={});let A={...e,fsrs:this.storage};await this.plugin.saveData(A)}catch(e){throw console.error("Saving data failed:",e),e}}updateGlobalStats(e,A){let t=this.storage.globalStats,r=Date.now(),o=new Date(r).setHours(0,0,0,0);if(t.totalReviews++,t.averageRetention=(t.averageRetention*(t.totalReviews-1)+A)/t.totalReviews,t.lastReviewDate===0)t.streakDays=1;else{let l=new Date(t.lastReviewDate).setHours(0,0,0,0),c=(o-l)/(24*60*60*1e3);c===1?t.streakDays++:c>1&&(t.streakDays=1)}t.lastReviewDate=r}addCard(e,A,t,r,o){let l=this.cardFactory.createCard(e,A,t);return r&&o&&(l.sourceId=r,l.sourceType=o),this.storage.cards[l.id]=l,this.checkAndAddCardToGroups(l),this.saveStorageDebounced(),l}getCardsForStudy(e){if(!e)return console.warn("No group ID specified, returning empty card list"),[];let A=this.groupRepository.getCardsByGroupId(e);if(A.length===0)return[];let t=Date.now(),r=A.filter(F=>F.reviews===0&&F.lastReview===0),o=A.filter(F=>!(F.reviews===0&&F.lastReview===0)&&F.nextReview<=t),l=this.getRemainingNewCardsToday(e),c=this.getRemainingReviewsToday(e),d=this.storage.cardGroups.find(F=>F.id===e),g=20,u=100;if(d&&d.settings)if(!d.settings.useGlobalSettings)g=d.settings.newCardsPerDay!==void 0?d.settings.newCardsPerDay:g,u=d.settings.reviewsPerDay!==void 0?d.settings.reviewsPerDay:u;else{let F=this.fsrsService.getParameters();g=F.newCardsPerDay,u=F.reviewsPerDay}let m=r.slice(0,l),v=o.slice(0,c);return[...m,...v]}trackStudyProgress(e,A){let t=this.storage.cards[e];if(!t)return console.error(`Tracking study progress failed: Card ${e} does not exist`),null;let r=t.lastReview===0,o=this.fsrsService.reviewCard(t,A);return this.storage.cards[e]=o,this.updateGlobalStats(A,o.retrievability),this.updateDailyStats(r,A),t.groupIds&&t.groupIds.length>0&&t.groupIds.forEach(l=>{let c=this.groupRepository.getGroupById(l)}),this.saveStorage(),this.plugin.eventManager.emitFlashcardChanged(),this.storage.cards[e]}getCardPredictions(e){let A=this.storage.cards[e];return A?this.fsrsService.getSchedulingCards(A):null}async generateCardsForGroup(e){return 0}checkAndAddCardToGroups(e){if(!e||!e.id)return 0;let A=this.groupRepository.getCardGroups();if(!A||A.length===0)return 0;let t=0;for(let r of A){if(!r.filter||r.filter.trim().length===0)continue;let o=[e];this.checkCardMatchesGroupFilter(e,r.filter)&&this.addCardToGroup(e.id,r.id)&&t++}return t>0,t}checkCardMatchesGroupFilter(e,A){if(!e||!e.filePath||!A||A.trim().length===0)return!1;let t=A.split(",").map(d=>d.trim()).filter(d=>d.length>0);if(t.length===0)return!1;let r=/\[\[([^\]]+)\]\]/,o=e.filePath.toLowerCase(),l=o.split("/").pop()||"",c=l.replace(/\.md$/i,"");for(let d of t){let g=d.toLowerCase(),u=g.match(r);if(u){let m=u[1].toLowerCase();if(c===m||l===m)return!0}else if(o.includes(g)||e.text&&e.text.toLowerCase().includes(g)||e.answer&&e.answer.toLowerCase().includes(g))return!0}return!1}findCardsBySourceId(e,A){return!this.storage.cards||!e?[]:Object.values(this.storage.cards).filter(t=>t.sourceId===e&&(!A||t.sourceType===A))}deleteCardsBySourceId(e,A){let t=this.findCardsBySourceId(e,A),r=0;for(let o of t){if(o.groupIds)for(let l of o.groupIds)this.removeCardFromGroup(o.id,l);delete this.storage.cards[o.id],r++}return r>0&&this.saveStorageDebounced(),r}updateCardsBySourceId(e,A,t,r){let o=this.findCardsBySourceId(e,A),l=0;for(let c of o)t!==void 0&&(c.text=t),r!==void 0&&(c.answer=r),c.updatedAt=Date.now(),l++;return l>0&&this.saveStorageDebounced(),l}getTotalCardsCount(){let e=this.getCardGroups()||[];if(e.length===0)return 0;if(e.length===1&&e[0].cardIds)return e[0].cardIds.length;let A=new Set;return e.forEach(t=>{t.cardIds&&t.cardIds.forEach(r=>{this.storage.cards[r]&&A.add(r)})}),A.size}getProgress(){let e=this.getAllGroupCards(),A=Date.now();return e.length===0?{due:0,newCards:0,learned:0,retention:this.storage.globalStats.averageRetention}:{due:e.filter(t=>t.nextReview<=A).length,newCards:e.filter(t=>t.lastReview===0).length,learned:e.filter(t=>t.lastReview>0).length,retention:this.storage.globalStats.averageRetention}}getAllGroupCards(){let e=this.groupRepository.getCardGroups();if(!e||e.length===0)return[];let A=new Set,t=[];for(let r of e){let o=this.groupRepository.getCardsByGroupId(r.id);for(let l of o)A.has(l.id)||(A.add(l.id),t.push(l))}return t}getStats(){return{...this.storage.globalStats}}getUIState(){return{...this.storage.uiState}}updateUIState(e){this.storage.uiState={...this.storage.uiState,...e},this.saveStorageDebounced()}deleteCard(e){let A=this.storage.cards[e];if(!A)return!1;if(A.groupIds)for(let t of A.groupIds)this.removeCardFromGroup(e,t);return delete this.storage.cards[e],this.saveStorageDebounced(),this.plugin.eventManager.emitFlashcardChanged(),!0}getCardsByFile(e){return this.cardFactory.getCardsByFile(e)}getPlugin(){return this.plugin}async saveStoragePublic(){return this.saveStorage()}getTodayTimestamp(){let e=new Date;return e.setHours(0,0,0,0),e.getTime()}getTodayStats(){let e=new Date;e.setHours(0,0,0,0);let A=e.getTime(),t=e.toDateString(),r=this.storage.dailyStats.find(o=>new Date(o.date).toDateString()===t);return r||(r={date:A,newCardsLearned:0,cardsReviewed:0,reviewCount:0,newCount:0,againCount:0,hardCount:0,goodCount:0,easyCount:0},this.storage.dailyStats.push(r),this.saveStorageDebounced()),r}updateTodayStats(e){let A=this.getTodayStats();e?A.newCardsLearned++:A.cardsReviewed++,this.saveStorageDebounced()}canLearnNewCardsToday(e){let A=this.getTodayStats(),t=this.fsrsService.getParameters();if(e){let r=this.storage.cardGroups.find(o=>o.id===e);if(r&&r.settings&&!r.settings.useGlobalSettings&&r.settings.newCardsPerDay!==void 0)return A.newCardsLearned<r.settings.newCardsPerDay}return A.newCardsLearned<t.newCardsPerDay}canReviewCardsToday(e){let A=this.getTodayStats(),t=this.fsrsService.getParameters();if(e){let r=this.storage.cardGroups.find(o=>o.id===e);if(r&&r.settings&&!r.settings.useGlobalSettings&&r.settings.reviewsPerDay!==void 0)return A.cardsReviewed<r.settings.reviewsPerDay}return A.cardsReviewed<t.reviewsPerDay}getRemainingNewCardsToday(e){let A=this.getTodayStats(),t=this.fsrsService.getParameters();if(e){let r=this.storage.cardGroups.find(o=>o.id===e);if(r&&r.settings&&!r.settings.useGlobalSettings&&r.settings.newCardsPerDay!==void 0)return Math.max(0,r.settings.newCardsPerDay-A.newCardsLearned)}return Math.max(0,t.newCardsPerDay-A.newCardsLearned)}getRemainingReviewsToday(e){let A=this.getTodayStats(),t=this.fsrsService.getParameters();if(e){let r=this.storage.cardGroups.find(o=>o.id===e);if(r&&r.settings&&!r.settings.useGlobalSettings&&r.settings.reviewsPerDay!==void 0)return Math.max(0,r.settings.reviewsPerDay-A.cardsReviewed)}return Math.max(0,t.reviewsPerDay-A.cardsReviewed)}async createCardGroup(e){Array.isArray(this.storage.cardGroups)||(this.storage.cardGroups=[]);let A=await this.groupRepository.createCardGroup(e),t=await this.generateCardsForGroup(A.id);return this.storage.cardGroups.some(r=>r.id===A.id)||this.storage.cardGroups.push(A),await this.saveStorage(),A}async updateCardGroup(e,A){let t=this.groupRepository.getGroupById(e),r=t==null?void 0:t.filter;if(!await this.groupRepository.updateCardGroup(e,A))return!1;if(A.filter!==void 0&&A.filter!==r){let l=this.groupRepository.getGroupById(e);if(l&&l.cardIds)for(let d of[...l.cardIds])this.removeCardFromGroup(d,e);let c=await this.generateCardsForGroup(e)}return await this.saveStorage(),!0}async deleteCardGroup(e,A=!1){if(!await this.groupRepository.deleteCardGroup(e,!1))return!1;try{return await this.saveStorage(),!0}catch(r){return!1}}getCardsInGroup(e){return e.cardIds&&e.cardIds.length>0?this.getCardsByGroupId(e.id):Object.values(this.storage.cards).filter(t=>{let r=e.filter.split(",").map(g=>g.trim().toLowerCase()),o=t.text.toLowerCase(),l=t.answer.toLowerCase(),c=(t.filePath||"").toLowerCase();return r.some(g=>{if(g.startsWith("#"))return o.includes(g)||l.includes(g);if(g.startsWith("path:")){let u=g.substring(5);return c.includes(u)}return o.includes(g)||l.includes(g)})})}addCardToGroup(e,A){let t=this.groupRepository.addCardToGroup(e,A);return t&&this.saveStorageDebounced(),t}removeCardFromGroup(e,A){let t=this.groupRepository.removeCardFromGroup(e,A);return t&&this.saveStorageDebounced(),t}getGroupProgress(e){return this.groupRepository.getGroupProgress(e)}getCardsByGroupId(e){return this.groupRepository.getCardsByGroupId(e)}getAllCards(){return Object.values(this.storage.cards)}getCardGroups(){return this.groupRepository.getCardGroups()}registerEventListeners(){if(!this.plugin.eventManager){console.error("\u4E8B\u4EF6\u7BA1\u7406\u5668\u4E0D\u5B58\u5728\uFF0C\u65E0\u6CD5\u6CE8\u518C\u4E8B\u4EF6\u76D1\u542C\u5668");return}this.plugin.eventManager.on("highlight:update",(e,A,t,r)=>{this.handleHighlightUpdate(e,A,t,r)}),this.plugin.eventManager.on("highlight:delete",(e,A,t)=>{this.handleHighlightDelete(e,A,t)}),this.plugin.eventManager.on("comment:update",(e,A,t,r)=>{this.handleCommentUpdate(e,A,t,r)}),this.plugin.eventManager.on("comment:delete",(e,A,t)=>{this.handleCommentDelete(e,A,t)})}handleHighlightUpdate(e,A,t,r){let o=this.updateCardsBySourceId(r,"highlight",t)}handleHighlightDelete(e,A,t){let r=this.deleteCardsBySourceId(t,"highlight")}handleCommentUpdate(e,A,t,r){let o=this.findCardsBySourceId(r,"highlight");if(!o||o.length===0)return;let l=0;for(let c of o){let d=c.answer||"",g=/\{\{([^{}]+)\}\}/g,u=[],m;for(;(m=g.exec(c.text))!==null;)u.push(m[1]);let F=d.split(`
`).filter(H=>H.trim()!==""&&H.trim()!==A.trim()&&!u.includes(H.trim())),y=[];u.length>0&&y.push(u.join(`
`)),F.length>0&&y.push(F.join(`
`)),t&&t.trim()!==""&&y.push(t);let E=y.length>0?y.join(`

`):"";E!==d&&(c.answer=E,c.updatedAt=Date.now(),l++)}l>0&&(this.saveStorageDebounced(),this.plugin.eventManager&&this.plugin.eventManager.emitFlashcardChanged())}handleCommentDelete(e,A,t){let r=this.deleteCardsBySourceId(t,"highlight")}checkAndMaintainDailyStats(){this.storage.dailyStats||(this.storage.dailyStats=[]),this.storage.dailyStats.sort((A,t)=>t.date-A.date);let e=new Map;return this.storage.dailyStats.forEach(A=>{let t=new Date(A.date),r=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`;e.has(r)||e.set(r,A)}),this.storage.dailyStats=Array.from(e.values()),this.storage.dailyStats.sort((A,t)=>t.date-A.date),this.storage.dailyStats.length>84&&(this.storage.dailyStats=this.storage.dailyStats.slice(0,84)),this.storage.dailyStats.length}updateDailyStats(e,A){let t=new Date;t.setHours(0,0,0,0);let r=t.getTime();this.storage.globalStats.lastReviewDate?this.storage.globalStats.lastReviewDate===r||(this.storage.globalStats.lastReviewDate===r-864e5?(this.storage.globalStats.lastReviewDate=r,this.storage.globalStats.streakDays++):this.storage.globalStats.lastReviewDate<r&&(this.storage.globalStats.lastReviewDate=r,this.storage.globalStats.streakDays=1)):(this.storage.globalStats.lastReviewDate=r,this.storage.globalStats.streakDays=1);let o=t.toDateString(),l=this.storage.dailyStats.find(c=>new Date(c.date).toDateString()===o);switch(l||(l={date:r,newCardsLearned:0,cardsReviewed:0,reviewCount:0,newCount:0,againCount:0,hardCount:0,goodCount:0,easyCount:0},this.storage.dailyStats.push(l),this.checkAndMaintainDailyStats()),l.reviewCount++,e?(l.newCount++,l.newCardsLearned++):l.cardsReviewed++,A){case cA.AGAIN:l.againCount++;break;case cA.HARD:l.hardCount++;break;case cA.GOOD:l.goodCount++;break;case cA.EASY:l.easyCount++;break}this.saveStorageDebounced()}cleanupInvalidCardReferences(){let e=0;if(!this.storage.cardGroups)return e;for(let A of this.storage.cardGroups)if(A.cardIds&&A.cardIds.length>0){let t=A.cardIds.length;A.cardIds=A.cardIds.filter(o=>this.storage.cards&&this.storage.cards[o]);let r=t-A.cardIds.length;r>0&&(e+=r,A.lastUpdated=Date.now())}return e>0&&this.saveStorageDebounced(),e}resetGroupCompletionMessage(e){if(!e)return;let A=this.groupRepository.getGroupById(e);A&&(this.storage.uiState||(this.storage.uiState={currentGroupName:"",completionMessage:null,groupProgress:{}}),this.storage.uiState.groupProgress||(this.storage.uiState.groupProgress={}),this.storage.uiState.groupProgress[A.name]&&(this.storage.uiState.groupProgress[A.name].completionMessage=null,this.saveStorageDebounced()))}};var js=class{constructor(e,A){this.app=e;this.commentStore=A;this.textSimilarityService=new we(e)}findMatchingHighlight(e,A){let t=this.commentStore.getFileComments(e);if(!t||t.length===0)return null;let r=t.find(c=>c.text!==A.text?!1:typeof c.position=="number"&&typeof A.position=="number"?Math.abs(c.position-A.position)<10:c.blockId&&A.blockId?c.blockId===A.blockId:!1);if(r||A.position!==void 0&&(r=t.find(c=>typeof c.position=="number"&&Math.abs(c.position-A.position)<30),r))return r;let o=null,l=0;for(let c of t){if(!c.comments||c.comments.length===0)continue;let d=this.textSimilarityService.calculateSimilarity(c.text,A.text);d>l&&d>.6&&(l=d,o=c)}if(o)return o;if(A.blockId){let c=t.filter(d=>d.blockId===A.blockId);if(c.length>0)return c[0]}return null}async recoverHighlight(e,A,t){let r={...A,text:t,updatedAt:Date.now()};return await this.commentStore.addComment(e,r),r}};var Ar=class extends To.Plugin{constructor(){super(...arguments);this.DEFAULT_SETTINGS={...nA,anthropic:{apiKey:"",model:"claude-2",apiAddress:"",isCustomModel:!1,lastCustomModel:""}}}async onload(){let A=await this.loadData();this.settings=Object.assign({},nA,A),window.html2canvas=Do.default,this.commentStore=new Is(this),await this.commentStore.loadComments(),this.eventManager=new Ze(this.app),this.fsrsManager=new zs(this),this.highlightMatchingService=new js(this.app,this.commentStore),this.highlightService=new oe(this.app),this.highlightDecorator=new bs(this,this.commentStore),this.highlightDecorator.enable(),this.registerView(ie,r=>new ue(r,this.commentStore)),this.addRibbonIcon("highlighter","HiNote",async()=>{let{workspace:r}=this.app,o=r.getLeavesOfType(ie);if(o.length){r.revealLeaf(o[0]);return}let l=r.getRightLeaf(!1);l&&await l.setViewState({type:ie,active:!0})}),this.addCommand({id:"open-comment-window",name:f("Open in right sidebar"),callback:async()=>{let{workspace:r}=this.app,o=r.getLeavesOfType(ie);if(o.length){let c=o[0],d=c.view;if(d&&d instanceof ue&&d.isDraggedToMainView){r.detachLeavesOfType(ie);let g=r.getRightLeaf(!1);if(g){await g.setViewState({type:ie,active:!0});let u=g.view;u&&u instanceof ue&&(u.isDraggedToMainView=!1,u.updateViewLayout(),u.updateHighlights())}}else r.revealLeaf(c);return}let l=r.getRightLeaf(!1);if(l){await l.setViewState({type:ie,active:!0});let c=l.view;c&&c instanceof ue&&(c.isDraggedToMainView=!1,c.updateViewLayout())}}}),this.addSettingTab(new Ns(this.app,this));let t=()=>{let r=performance.now(),o=performance.now()};this.registerEvent(this.app.vault.on("rename",(r,o)=>{this.commentStore.updateFilePath(o,r.path)})),this.addCommand({id:"open-chat-window",name:f("Open AI chat window"),callback:()=>{ze.getInstance(this.app,this).show()}}),this.addCommand({id:"open-comment-main-window",name:f("Open in main window"),callback:async()=>{let{workspace:r}=this.app,o=r.getLeavesOfType(ie);if(o.length){let c=o[0];r.setActiveLeaf(c,{focus:!0}),r.detachLeavesOfType(ie);let d=r.getLeaf("tab");await d.setViewState({type:ie,active:!0});let g=d.view;g&&g instanceof ue&&(g.isDraggedToMainView=!0,g.updateViewLayout(),g.updateHighlights());return}let l=r.getLeaf("tab");l&&(await l.setViewState({type:ie,active:!0}),setTimeout(()=>{let c=l.view;c&&c instanceof ue&&(c.isDraggedToMainView=!0,c.updateViewLayout(),c.updateHighlights())},100))}})}async onunload(){try{await this.commentStore.saveComments();let A=await this.loadData()}catch(A){}this.highlightDecorator&&this.highlightDecorator.disable(),ze.instance&&ze.instance.close()}async loadSettings(){let A=await this.loadData();this.settings||(this.settings={excludePatterns:nA.excludePatterns,useCustomPattern:nA.useCustomPattern,regexRules:[...nA.regexRules],ai:{provider:nA.ai.provider,openai:nA.ai.openai?{...nA.ai.openai}:void 0,anthropic:nA.ai.anthropic?{...nA.ai.anthropic}:void 0,gemini:nA.ai.gemini?{...nA.ai.gemini}:void 0,ollama:nA.ai.ollama?{...nA.ai.ollama}:void 0,deepseek:nA.ai.deepseek?{...nA.ai.deepseek}:void 0,prompts:{...nA.ai.prompts}},export:{exportPath:nA.export.exportPath}}),(A==null?void 0:A.excludePatterns)!==void 0&&(this.settings.excludePatterns=A.excludePatterns),A!=null&&A.ai&&(A.ai.provider&&(this.settings.ai.provider=A.ai.provider),A.ai.openai&&this.settings.ai.openai&&(this.settings.ai.openai={apiKey:A.ai.openai.apiKey||this.settings.ai.openai.apiKey,model:A.ai.openai.model||this.settings.ai.openai.model,baseUrl:A.ai.openai.baseUrl}),A.ai.anthropic&&this.settings.ai.anthropic&&(this.settings.ai.anthropic={apiKey:A.ai.anthropic.apiKey||this.settings.ai.anthropic.apiKey,model:A.ai.anthropic.model||this.settings.ai.anthropic.model,availableModels:A.ai.anthropic.availableModels,apiAddress:A.ai.anthropic.apiAddress||A.ai.anthropic.baseUrl,isCustomModel:A.ai.anthropic.isCustomModel||!1,lastCustomModel:A.ai.anthropic.lastCustomModel||""}),A.ai.gemini&&this.settings.ai.gemini&&(this.settings.ai.gemini={apiKey:A.ai.gemini.apiKey||this.settings.ai.gemini.apiKey,model:A.ai.gemini.model||this.settings.ai.gemini.model,baseUrl:A.ai.gemini.baseUrl,isCustomModel:A.ai.gemini.isCustomModel||!1}),A.ai.ollama&&this.settings.ai.ollama&&(this.settings.ai.ollama={host:A.ai.ollama.host||this.settings.ai.ollama.host,model:A.ai.ollama.model||this.settings.ai.ollama.model,availableModels:A.ai.ollama.availableModels}),A.ai.deepseek&&this.settings.ai.deepseek&&(this.settings.ai.deepseek={apiKey:A.ai.deepseek.apiKey||this.settings.ai.deepseek.apiKey,model:A.ai.deepseek.model||this.settings.ai.deepseek.model,baseUrl:A.ai.deepseek.baseUrl}),A.ai.prompts&&(this.settings.ai.prompts={...this.settings.ai.prompts,...A.ai.prompts})),A!=null&&A.export&&A.export.exportPath&&(this.settings.export.exportPath=A.export.exportPath),A!=null&&A.comments&&(this.settings.comments=A.comments),A!=null&&A.comments&&(this.settings.comments=A.comments),await this.saveSettings()}async saveSettings(){var t,r,o,l,c,d,g,u,m;this.settings||(this.settings={...nA});let A=await this.loadData();A!=null&&A["flashcard-license"]&&(this.settings["flashcard-license"]=A["flashcard-license"]),this.settings.excludePatterns=(t=this.settings.excludePatterns)!=null?t:nA.excludePatterns,this.settings.useCustomPattern=(r=this.settings.useCustomPattern)!=null?r:nA.useCustomPattern,(!this.settings.regexRules||!Array.isArray(this.settings.regexRules))&&(this.settings.regexRules=[...nA.regexRules]),this.settings.ai||(this.settings.ai={...nA.ai}),this.settings.export||(this.settings.export={...nA.export}),this.settings.ai.openai||(this.settings.ai.openai={apiKey:"",model:((o=nA.ai.openai)==null?void 0:o.model)||"gpt-4o",baseUrl:(l=nA.ai.openai)==null?void 0:l.baseUrl}),this.settings.ai.anthropic||(this.settings.ai.anthropic={apiKey:"",model:"claude-2",availableModels:(c=nA.ai.anthropic)==null?void 0:c.availableModels,apiAddress:(d=nA.ai.anthropic)==null?void 0:d.apiAddress,isCustomModel:!1,lastCustomModel:""}),this.settings.ai.gemini||(this.settings.ai.gemini={apiKey:"",model:"gemini-1.5-flash",isCustomModel:!1,baseUrl:(g=nA.ai.gemini)==null?void 0:g.baseUrl}),this.settings.ai.ollama||(this.settings.ai.ollama={host:"http://localhost:11434",model:"",availableModels:(u=nA.ai.ollama)==null?void 0:u.availableModels}),this.settings.ai.deepseek||(this.settings.ai.deepseek={apiKey:"",model:"deepseek-chat",baseUrl:(m=nA.ai.deepseek)==null?void 0:m.baseUrl}),this.settings.ai.prompts||(this.settings.ai.prompts={...nA.ai.prompts}),this.settings.export||(this.settings.export={exportPath:nA.export.exportPath}),await this.saveData(this.settings)}};
/*! Bundled license information:

html2canvas/dist/html2canvas.js:
  (*!
   * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
   * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
   * Released under MIT License
   *)
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)
*/

/* nosourcemap */